"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[566],{80325:function(e,t,n){n.d(t,{G:function(){return I}});n(92222),n(21249),n(91038),n(78783),n(66992),n(41539),n(33948),n(51532),n(47042),n(68309),n(82526),n(41817),n(32165);var r=n(28380),i=n(17231),s=n(94741),a=n(4843),u=n(89321),o=n(64595),l=n(12911),d=n(56501),h=n(54999),c=n(61182),p=n(53374),m=n(268),g=n(28156);function v(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||y(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){if(e){if("string"===typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var I=function(){function e(t,n,r,i,s,a,u,o,l,h,c,p,m,g){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._config=t,this._stats=n,this._dependencyGraph=r,this._columnSearch=i,this._parser=s,this._unparser=a,this._cellContentParser=u,this._evaluator=o,this._lazilyTransformingAstService=l,this._crudOperations=h,this._exporter=c,this._namedExpressions=p,this._serialization=m,this._functionRegistry=g,this._emitter=new d.Q,this._evaluationSuspended=!1}var t,n,f;return t=e,f=[{key:"buildFromEngineState",value:function(t){return new e(t.config,t.stats,t.dependencyGraph,t.columnSearch,t.parser,t.unparser,t.cellContentParser,t.evaluator,t.lazilyTransformingAstService,t.crudOperations,t.exporter,t.namedExpressions,t.serialization,t.functionRegistry)}},{key:"buildFromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return this.buildFromEngineState(s.s.buildFromSheet(e,t,n))}},{key:"buildFromSheets",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return this.buildFromEngineState(s.s.buildFromSheets(e,t,n))}},{key:"buildEmpty",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return this.buildFromEngineState(s.s.buildEmpty(e,t))}},{key:"getLanguage",value:function(e){(0,i.mi)(e,"string","languageCode");var t=this.registeredLanguages.get(e);if(void 0===t)throw new h.kN;return t}},{key:"registerLanguage",value:function(e,t){if((0,i.mi)(e,"string","languageCode"),this.registeredLanguages.has(e))throw new h.EY;this.registeredLanguages.set(e,(0,c.F4)(t))}},{key:"unregisterLanguage",value:function(e){if((0,i.mi)(e,"string","languageCode"),!this.registeredLanguages.has(e))throw new h.kN;this.registeredLanguages.delete(e)}},{key:"getRegisteredLanguagesCodes",value:function(){return Array.from(this.registeredLanguages.keys())}},{key:"registerFunctionPlugin",value:function(e,t){p.g.registerFunctionPlugin(e,t)}},{key:"unregisterFunctionPlugin",value:function(e){p.g.unregisterFunctionPlugin(e)}},{key:"registerFunction",value:function(e,t,n){(0,i.mi)(e,"string","functionId"),p.g.registerFunction(e,t,n)}},{key:"unregisterFunction",value:function(e){(0,i.mi)(e,"string","functionId"),p.g.unregisterFunction(e)}},{key:"unregisterAllFunctions",value:function(){p.g.unregisterAll()}},{key:"getRegisteredFunctionNames",value:function(e){(0,i.mi)(e,"string","code");var t=p.g.getRegisteredFunctionIds();return this.getLanguage(e).getFunctionTranslations(t)}},{key:"getFunctionPlugin",value:function(e){return(0,i.mi)(e,"string","functionId"),p.g.getFunctionPlugin(e)}},{key:"getAllFunctionPlugins",value:function(){return p.g.getPlugins()}}],(n=[{key:"graph",get:function(){return this.dependencyGraph.graph}},{key:"rangeMapping",get:function(){return this.dependencyGraph.rangeMapping}},{key:"arrayMapping",get:function(){return this.dependencyGraph.arrayMapping}},{key:"sheetMapping",get:function(){return this.dependencyGraph.sheetMapping}},{key:"addressMapping",get:function(){return this.dependencyGraph.addressMapping}},{key:"dependencyGraph",get:function(){return this._dependencyGraph}},{key:"evaluator",get:function(){return this._evaluator}},{key:"columnSearch",get:function(){return this._columnSearch}},{key:"lazilyTransformingAstService",get:function(){return this._lazilyTransformingAstService}},{key:"licenseKeyValidityState",get:function(){return this._config.licenseKeyValidityState}},{key:"getCellValue",value:function(e){if(!(0,a.y8)(e))throw new h.Qv("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellValue(e)}},{key:"ensureEvaluationIsNotSuspended",value:function(){if(this._evaluationSuspended)throw new h.uQ}},{key:"getCellFormula",value:function(e){if(!(0,a.y8)(e))throw new h.Qv("SimpleCellAddress","cellAddress");return this._serialization.getCellFormula(e)}},{key:"getCellSerialized",value:function(e){if(!(0,a.y8)(e))throw new h.Qv("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellSerialized(e)}},{key:"getSheetValues",value:function(e){return(0,i.mi)(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetValues(e)}},{key:"getSheetFormulas",value:function(e){return(0,i.mi)(e,"number","sheetId"),this._serialization.getSheetFormulas(e)}},{key:"getSheetSerialized",value:function(e){return(0,i.mi)(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetSerialized(e)}},{key:"getAllSheetsDimensions",value:function(){var e=this;return this._serialization.genericAllSheetsGetter((function(t){return e.getSheetDimensions(t)}))}},{key:"getSheetDimensions",value:function(e){return(0,i.mi)(e,"number","sheetId"),{width:this.dependencyGraph.getSheetWidth(e),height:this.dependencyGraph.getSheetHeight(e)}}},{key:"getAllSheetsValues",value:function(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsValues()}},{key:"getAllSheetsFormulas",value:function(){return this._serialization.getAllSheetsFormulas()}},{key:"getAllSheetsSerialized",value:function(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsSerialized()}},{key:"updateConfig",value:function(e){var t=this._config.mergeConfig(e),n=this._config.mergeConfig({language:e.language}),r=this._serialization.withNewConfig(n,this._namedExpressions).getAllSheetsSerialized(),i=this._serialization.getAllNamedExpressionsSerialized(),a=s.s.rebuildWithConfig(t,r,i,this._stats);this._config=a.config,this._stats=a.stats,this._dependencyGraph=a.dependencyGraph,this._columnSearch=a.columnSearch,this._parser=a.parser,this._unparser=a.unparser,this._cellContentParser=a.cellContentParser,this._evaluator=a.evaluator,this._lazilyTransformingAstService=a.lazilyTransformingAstService,this._crudOperations=a.crudOperations,this._exporter=a.exporter,this._namedExpressions=a.namedExpressions,this._serialization=a.serialization,this._functionRegistry=a.functionRegistry}},{key:"getConfig",value:function(){return this._config.getConfig()}},{key:"rebuildAndRecalculate",value:function(){this.updateConfig({})}},{key:"getStats",value:function(){return this._stats.snapshot()}},{key:"undo",value:function(){return this._crudOperations.undo(),this.recomputeIfDependencyGraphNeedsIt()}},{key:"redo",value:function(){return this._crudOperations.redo(),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isThereSomethingToUndo",value:function(){return this._crudOperations.isThereSomethingToUndo()}},{key:"isThereSomethingToRedo",value:function(){return this._crudOperations.isThereSomethingToRedo()}},{key:"isItPossibleToSetCellContents",value:function(e){var t;if((0,a.y8)(e))t=new r.gG(e,e);else{if(!(0,r.V$)(e))throw new h.Qv("SimpleCellAddress | SimpleCellRange","address");t=new r.gG(e.start,e.end)}try{this._crudOperations.ensureRangeInSizeLimits(t);var n,i=function(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=y(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,s=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw s}}}}(t.addresses(this._dependencyGraph));try{for(i.s();!(n=i.n()).done;){var s=n.value;this._crudOperations.ensureItIsPossibleToChangeContent(s)}}catch(u){i.e(u)}finally{i.f()}}catch(o){return!1}return!0}},{key:"setCellContents",value:function(e,t){return this._crudOperations.setCellContents(e,t),this.recomputeIfDependencyGraphNeedsIt()}},{key:"swapRowIndexes",value:function(e,t){return(0,i.mi)(e,"number","sheetId"),this._crudOperations.setRowOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToSwapRowIndexes",value:function(e,t){(0,i.mi)(e,"number","sheetId");try{return this._crudOperations.validateSwapRowIndexes(e,t),this._crudOperations.testRowOrderForArrays(e,t),!0}catch(n){return!1}}},{key:"setRowOrder",value:function(e,t){(0,i.mi)(e,"number","sheetId");var n=this._crudOperations.mappingFromOrder(e,t,"row");return this.swapRowIndexes(e,n)}},{key:"isItPossibleToSetRowOrder",value:function(e,t){(0,i.mi)(e,"number","sheetId");try{var n=this._crudOperations.mappingFromOrder(e,t,"row");return this._crudOperations.validateSwapRowIndexes(e,n),this._crudOperations.testRowOrderForArrays(e,n),!0}catch(r){return!1}}},{key:"swapColumnIndexes",value:function(e,t){return(0,i.mi)(e,"number","sheetId"),this._crudOperations.setColumnOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToSwapColumnIndexes",value:function(e,t){(0,i.mi)(e,"number","sheetId");try{return this._crudOperations.validateSwapColumnIndexes(e,t),this._crudOperations.testColumnOrderForArrays(e,t),!0}catch(n){return!1}}},{key:"setColumnOrder",value:function(e,t){(0,i.mi)(e,"number","sheetId");var n=this._crudOperations.mappingFromOrder(e,t,"column");return this.swapColumnIndexes(e,n)}},{key:"isItPossibleToSetColumnOrder",value:function(e,t){(0,i.mi)(e,"number","sheetId");try{var n=this._crudOperations.mappingFromOrder(e,t,"column");return this._crudOperations.validateSwapColumnIndexes(e,n),this._crudOperations.testColumnOrderForArrays(e,n),!0}catch(r){return!1}}},{key:"isItPossibleToAddRows",value:function(e){(0,i.mi)(e,"number","sheetId");for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var s=(0,m.i5)(n);try{var a;return(a=this._crudOperations).ensureItIsPossibleToAddRows.apply(a,[e].concat(v(s))),!0}catch(u){return!1}}},{key:"addRows",value:function(e){var t;(0,i.mi)(e,"number","sheetId");for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return(t=this._crudOperations).addRows.apply(t,[e].concat(r)),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToRemoveRows",value:function(e){(0,i.mi)(e,"number","sheetId");for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var s=(0,m.fb)(n);try{var a;return(a=this._crudOperations).ensureItIsPossibleToRemoveRows.apply(a,[e].concat(v(s))),!0}catch(u){return!1}}},{key:"removeRows",value:function(e){var t;(0,i.mi)(e,"number","sheetId");for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return(t=this._crudOperations).removeRows.apply(t,[e].concat(r)),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToAddColumns",value:function(e){(0,i.mi)(e,"number","sheetId");for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var s=(0,m.i5)(n);try{var a;return(a=this._crudOperations).ensureItIsPossibleToAddColumns.apply(a,[e].concat(v(s))),!0}catch(u){return!1}}},{key:"addColumns",value:function(e){var t;(0,i.mi)(e,"number","sheetId");for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return(t=this._crudOperations).addColumns.apply(t,[e].concat(r)),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToRemoveColumns",value:function(e){(0,i.mi)(e,"number","sheetId");for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var s=(0,m.fb)(n);try{var a;return(a=this._crudOperations).ensureItIsPossibleToRemoveColumns.apply(a,[e].concat(v(s))),!0}catch(u){return!1}}},{key:"removeColumns",value:function(e){var t;(0,i.mi)(e,"number","sheetId");for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return(t=this._crudOperations).removeColumns.apply(t,[e].concat(r)),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToMoveCells",value:function(e,t){if(!(0,a.y8)(t))throw new h.Qv("SimpleCellAddress","destinationLeftCorner");if(!(0,r.V$)(e))throw new h.Qv("SimpleCellRange","source");try{var n=new r.gG(e.start,e.end);return this._crudOperations.operations.ensureItIsPossibleToMoveCells(n.start,n.width(),n.height(),t),!0}catch(i){return!1}}},{key:"moveCells",value:function(e,t){if(!(0,a.y8)(t))throw new h.Qv("SimpleCellAddress","destinationLeftCorner");if(!(0,r.V$)(e))throw new h.Qv("SimpleCellRange","source");var n=new r.gG(e.start,e.end);return this._crudOperations.moveCells(n.start,n.width(),n.height(),t),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToMoveRows",value:function(e,t,n,r){(0,i.mi)(e,"number","sheetId"),(0,i.mi)(t,"number","startRow"),(0,i.mi)(n,"number","numberOfRows"),(0,i.mi)(r,"number","targetRow");try{return this._crudOperations.ensureItIsPossibleToMoveRows(e,t,n,r),!0}catch(s){return!1}}},{key:"moveRows",value:function(e,t,n,r){return(0,i.mi)(e,"number","sheetId"),(0,i.mi)(t,"number","startRow"),(0,i.mi)(n,"number","numberOfRows"),(0,i.mi)(r,"number","targetRow"),this._crudOperations.moveRows(e,t,n,r),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToMoveColumns",value:function(e,t,n,r){(0,i.mi)(e,"number","sheetId"),(0,i.mi)(t,"number","startColumn"),(0,i.mi)(n,"number","numberOfColumns"),(0,i.mi)(r,"number","targetColumn");try{return this._crudOperations.ensureItIsPossibleToMoveColumns(e,t,n,r),!0}catch(s){return!1}}},{key:"moveColumns",value:function(e,t,n,r){return(0,i.mi)(e,"number","sheetId"),(0,i.mi)(t,"number","startColumn"),(0,i.mi)(n,"number","numberOfColumns"),(0,i.mi)(r,"number","targetColumn"),this._crudOperations.moveColumns(e,t,n,r),this.recomputeIfDependencyGraphNeedsIt()}},{key:"copy",value:function(e){if(!(0,r.V$)(e))throw new h.Qv("SimpleCellRange","source");var t=new r.gG(e.start,e.end);return this._crudOperations.copy(t.start,t.width(),t.height()),this.getRangeValues(e)}},{key:"cut",value:function(e){if(!(0,r.V$)(e))throw new h.Qv("SimpleCellRange","source");var t=new r.gG(e.start,e.end);return this._crudOperations.cut(t.start,t.width(),t.height()),this.getRangeValues(e)}},{key:"paste",value:function(e){if(!(0,a.y8)(e))throw new h.Qv("SimpleCellAddress","targetLeftCorner");return this.ensureEvaluationIsNotSuspended(),this._crudOperations.paste(e),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isClipboardEmpty",value:function(){return this._crudOperations.isClipboardEmpty()}},{key:"clearClipboard",value:function(){this._crudOperations.clearClipboard()}},{key:"clearRedoStack",value:function(){this._crudOperations.undoRedo.clearRedoStack()}},{key:"clearUndoStack",value:function(){this._crudOperations.undoRedo.clearUndoStack()}},{key:"getRangeValues",value:function(e){var t=this;if(!(0,r.V$)(e))throw new h.Qv("SimpleCellRange","source");return new r.gG(e.start,e.end).arrayOfAddressesInRange().map((function(e){return e.map((function(e){return t.getCellValue(e)}))}))}},{key:"getRangeFormulas",value:function(e){var t=this;if(!(0,r.V$)(e))throw new h.Qv("SimpleCellRange","source");return new r.gG(e.start,e.end).arrayOfAddressesInRange().map((function(e){return e.map((function(e){return t.getCellFormula(e)}))}))}},{key:"getRangeSerialized",value:function(e){var t=this;if(!(0,r.V$)(e))throw new h.Qv("SimpleCellRange","source");return new r.gG(e.start,e.end).arrayOfAddressesInRange().map((function(e){return e.map((function(e){return t.getCellSerialized(e)}))}))}},{key:"getFillRangeData",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!(0,r.V$)(e))throw new h.Qv("SimpleCellRange","source");if(!(0,r.V$)(t))throw new h.Qv("SimpleCellRange","target");var s=new r.gG(e.start,e.end),a=new r.gG(t.start,t.end);if(s.sheet!==a.sheet)throw new h.Uk(s.sheet,a.sheet);return this.ensureEvaluationIsNotSuspended(),a.arrayOfAddressesInRange().map((function(r){return r.map((function(r){var u=((r.row-(i?t:e).start.row)%s.height()+s.height())%s.height()+e.start.row,o=((r.col-(i?t:e).start.col)%s.width()+s.width())%s.width()+e.start.col;return n._serialization.getCellSerialized({row:u,col:o,sheet:a.sheet},r)}))}))}},{key:"isItPossibleToAddSheet",value:function(e){(0,i.mi)(e,"string","sheetName");try{return this._crudOperations.ensureItIsPossibleToAddSheet(e),!0}catch(t){return!1}}},{key:"addSheet",value:function(e){void 0!==e&&(0,i.mi)(e,"string","sheetName");var t=this._crudOperations.addSheet(e);return this._emitter.emit(d.z.SheetAdded,t),t}},{key:"isItPossibleToRemoveSheet",value:function(e){(0,i.mi)(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch(t){return!1}}},{key:"removeSheet",value:function(e){(0,i.mi)(e,"number","sheetId");var t=this.sheetMapping.getDisplayName(e);this._crudOperations.removeSheet(e);var n=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(d.z.SheetRemoved,t,n),n}},{key:"isItPossibleToClearSheet",value:function(e){(0,i.mi)(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch(t){return!1}}},{key:"clearSheet",value:function(e){return(0,i.mi)(e,"number","sheetId"),this._crudOperations.clearSheet(e),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToReplaceSheetContent",value:function(e,t){(0,i.mi)(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),this._crudOperations.ensureItIsPossibleToChangeSheetContents(e,t),!0}catch(n){return!1}}},{key:"setSheetContent",value:function(e,t){return(0,i.mi)(e,"number","sheetId"),this._crudOperations.setSheetContent(e,t),this.recomputeIfDependencyGraphNeedsIt()}},{key:"simpleCellAddressFromString",value:function(e,t){return(0,i.mi)(e,"string","cellAddress"),(0,i.mi)(t,"number","sheetId"),(0,g.d1)(this.sheetMapping.get,e,t)}},{key:"simpleCellRangeFromString",value:function(e,t){return(0,i.mi)(e,"string","cellRange"),(0,i.mi)(t,"number","sheetId"),(0,g.uu)(this.sheetMapping.get,e,t)}},{key:"simpleCellAddressToString",value:function(e,t){if(!(0,a.y8)(e))throw new h.Qv("SimpleCellAddress","cellAddress");return(0,i.mi)(t,"number","sheetId"),(0,g.Cl)(this.sheetMapping.fetchDisplayName,e,t)}},{key:"simpleCellRangeToString",value:function(e,t){if(!(0,r.V$)(e))throw new h.Qv("SimpleCellRange","cellRange");return(0,i.mi)(t,"number","sheetId"),(0,g.Px)(this.sheetMapping.fetchDisplayName,e,t)}},{key:"getCellDependents",value:function(e){var t;if((0,a.y8)(e))t=this._dependencyGraph.addressMapping.getCell(e);else{if(!(0,r.V$)(e))throw new h.Qv("SimpleCellAddress | SimpleCellRange",e);t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end)}return void 0===t?[]:this._dependencyGraph.getAdjacentNodesAddresses(t)}},{key:"getCellPrecedents",value:function(e){var t;if((0,a.y8)(e))t=this._dependencyGraph.addressMapping.getCell(e);else{if(!(0,r.V$)(e))throw new h.Qv("SimpleCellAddress | SimpleCellRange",e);t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end)}return void 0===t?[]:this._dependencyGraph.dependencyQueryAddresses(t)}},{key:"getSheetName",value:function(e){return(0,i.mi)(e,"number","sheetId"),this.sheetMapping.getDisplayName(e)}},{key:"getSheetNames",value:function(){return this.sheetMapping.sheetNames()}},{key:"getSheetId",value:function(e){return(0,i.mi)(e,"string","sheetName"),this.sheetMapping.get(e)}},{key:"doesSheetExist",value:function(e){return(0,i.mi)(e,"string","sheetName"),this.sheetMapping.hasSheetWithName(e)}},{key:"getCellType",value:function(e){if(!(0,a.y8)(e))throw new h.Qv("SimpleCellAddress","cellAddress");var t=this.dependencyGraph.getCell(e);return(0,a.DA)(t,e)}},{key:"doesCellHaveSimpleValue",value:function(e){if(!(0,a.y8)(e))throw new h.Qv("SimpleCellAddress","cellAddress");return this.getCellType(e)===a.lT.VALUE}},{key:"doesCellHaveFormula",value:function(e){if(!(0,a.y8)(e))throw new h.Qv("SimpleCellAddress","cellAddress");var t=this.getCellType(e);return t===a.lT.FORMULA||t===a.lT.ARRAYFORMULA}},{key:"isCellEmpty",value:function(e){if(!(0,a.y8)(e))throw new h.Qv("SimpleCellAddress","cellAddress");return this.getCellType(e)===a.lT.EMPTY}},{key:"isCellPartOfArray",value:function(e){if(!(0,a.y8)(e))throw new h.Qv("SimpleCellAddress","cellAddress");var t=this.getCellType(e);return t===a.lT.ARRAY||t===a.lT.ARRAYFORMULA}},{key:"getCellValueType",value:function(e){if(!(0,a.y8)(e))throw new h.Qv("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();var t=this.dependencyGraph.getCellValue(e);return(0,a.Tv)(t)}},{key:"getCellValueDetailedType",value:function(e){if(!(0,a.y8)(e))throw new h.Qv("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();var t=this.dependencyGraph.getCellValue(e);return(0,a.Nd)(t)}},{key:"getCellValueFormat",value:function(e){if(!(0,a.y8)(e))throw new h.Qv("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();var t=this.dependencyGraph.getCellValue(e);return(0,a.rP)(t)}},{key:"countSheets",value:function(){return this.sheetMapping.numberOfSheets()}},{key:"isItPossibleToRenameSheet",value:function(e,t){(0,i.mi)(e,"number","sheetId"),(0,i.mi)(t,"string","newName");try{return this._crudOperations.ensureItIsPossibleToRenameSheet(e,t),!0}catch(n){return!1}}},{key:"renameSheet",value:function(e,t){(0,i.mi)(e,"number","sheetId"),(0,i.mi)(t,"string","newName");var n=this._crudOperations.renameSheet(e,t);void 0!==n&&this._emitter.emit(d.z.SheetRenamed,n,t)}},{key:"batch",value:function(e){this.suspendEvaluation(),this._crudOperations.beginUndoRedoBatchMode();try{e()}catch(t){throw this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation(),t}return this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation()}},{key:"suspendEvaluation",value:function(){this._evaluationSuspended=!0,this._emitter.emit(d.z.EvaluationSuspended)}},{key:"resumeEvaluation",value:function(){this._evaluationSuspended=!1;var e=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(d.z.EvaluationResumed,e),e}},{key:"isEvaluationSuspended",value:function(){return this._evaluationSuspended}},{key:"isItPossibleToAddNamedExpression",value:function(e,t,n){(0,i.mi)(e,"string","expressionName"),void 0!==n&&(0,i.mi)(n,"number","scope");try{return this._crudOperations.ensureItIsPossibleToAddNamedExpression(e,t,n),!0}catch(r){return!1}}},{key:"addNamedExpression",value:function(e,t,n,r){(0,i.mi)(e,"string","expressionName"),void 0!==n&&(0,i.mi)(n,"number","scope"),this._crudOperations.addNamedExpression(e,t,n,r);var s=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(d.z.NamedExpressionAdded,e,s),s}},{key:"getNamedExpressionValue",value:function(e,t){(0,i.mi)(e,"string","expressionName"),void 0!==t&&(0,i.mi)(t,"number","scope"),this.ensureEvaluationIsNotSuspended(),this._crudOperations.ensureScopeIdIsValid(t);var n=this._namedExpressions.namedExpressionForScope(e,t);return n?this._serialization.getCellValue(n.address):void 0}},{key:"getNamedExpressionFormula",value:function(e,t){(0,i.mi)(e,"string","expressionName"),void 0!==t&&(0,i.mi)(t,"number","scope"),this._crudOperations.ensureScopeIdIsValid(t);var n=this._namedExpressions.namedExpressionForScope(e,t);return void 0===n?void 0:this._serialization.getCellFormula(n.address)}},{key:"getNamedExpression",value:function(e,t){(0,i.mi)(e,"string","expressionName"),void 0!==t&&(0,i.mi)(t,"number","scope");var n=this._namedExpressions.namedExpressionForScope(e,t);if(void 0!==n)return{name:e,scope:t,expression:this._serialization.getCellFormula(n.address),options:n.options}}},{key:"isItPossibleToChangeNamedExpression",value:function(e,t,n){(0,i.mi)(e,"string","expressionName"),void 0!==n&&(0,i.mi)(n,"number","scope");try{return this._crudOperations.ensureItIsPossibleToChangeNamedExpression(e,t,n),!0}catch(r){return!1}}},{key:"changeNamedExpression",value:function(e,t,n,r){return(0,i.mi)(e,"string","expressionName"),void 0!==n&&(0,i.mi)(n,"number","scope"),this._crudOperations.changeNamedExpressionExpression(e,n,t,r),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToRemoveNamedExpression",value:function(e,t){(0,i.mi)(e,"string","expressionName"),void 0!==t&&(0,i.mi)(t,"number","scope");try{return this._crudOperations.isItPossibleToRemoveNamedExpression(e,t),!0}catch(n){return!1}}},{key:"removeNamedExpression",value:function(e,t){(0,i.mi)(e,"string","expressionName"),void 0!==t&&(0,i.mi)(t,"number","scope");var n=this._crudOperations.removeNamedExpression(e,t);if(n){var r=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(d.z.NamedExpressionRemoved,n.displayName,r),r}return[]}},{key:"listNamedExpressions",value:function(e){return void 0!==e&&(0,i.mi)(e,"number","scope"),this._crudOperations.ensureScopeIdIsValid(e),this._namedExpressions.getAllNamedExpressionsNamesInScope(e)}},{key:"getAllNamedExpressionsSerialized",value:function(){return this._serialization.getAllNamedExpressionsSerialized()}},{key:"normalizeFormula",value:function(e){(0,i.mi)(e,"string","formulaString");var t=this.extractTemporaryFormula(e),n=t.ast,r=t.address;if(void 0===n)throw new h.lS;return this._unparser.unparse(n,r)}},{key:"calculateFormula",value:function(e,t){(0,i.mi)(e,"string","formulaString"),(0,i.mi)(t,"number","sheetId"),this._crudOperations.ensureScopeIdIsValid(t);var n=this.extractTemporaryFormula(e,t),r=n.ast,s=n.address,a=n.dependencies;if(void 0===r)throw new h.lS;var u=this.evaluator.runAndForget(r,s,a);return this._exporter.exportScalarOrRange(u)}},{key:"validateFormula",value:function(e){(0,i.mi)(e,"string","formulaString");var t=this.extractTemporaryFormula(e).ast;return void 0!==t&&!(t.type===g.W$.ERROR&&!t.error)}},{key:"getRegisteredFunctionNames",value:function(){return e.getLanguage(this._config.language).getFunctionTranslations(this._functionRegistry.getRegisteredFunctionIds())}},{key:"getFunctionPlugin",value:function(e){return(0,i.mi)(e,"string","functionId"),this._functionRegistry.getFunctionPlugin(e)}},{key:"getAllFunctionPlugins",value:function(){return this._functionRegistry.getPlugins()}},{key:"numberToDateTime",value:function(e){return(0,i.mi)(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDateTime(e)}},{key:"numberToDate",value:function(e){return(0,i.mi)(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDate(e)}},{key:"numberToTime",value:function(e){return(0,i.mi)(e,"number","val"),(0,o.eS)(e)}},{key:"extractTemporaryFormula",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this._cellContentParser.parse(e),r={sheet:t,col:0,row:0};if(!(n instanceof u.J5.Formula))return{address:r,dependencies:[]};var i=this._parser.parse(n.formula,r),s=i.ast,a=i.errors,o=i.dependencies;return a.length>0?{address:r,dependencies:[]}:{ast:s,address:r,dependencies:o}}},{key:"on",value:function(e,t){this._emitter.on(e,t)}},{key:"once",value:function(e,t){this._emitter.once(e,t)}},{key:"off",value:function(e,t){this._emitter.off(e,t)}},{key:"destroy",value:function(){this._evaluator.interpreter.destroyGpu(),(0,l.m)(this)}},{key:"recomputeIfDependencyGraphNeedsIt",value:function(){if(this._evaluationSuspended)return[];var e=this._crudOperations.getAndClearContentChanges(),t=Array.from(this.dependencyGraph.verticesToRecompute());this.dependencyGraph.clearRecentlyChangedVertices(),t.length>0&&e.addAll(this.evaluator.partialRun(t));var n=e.exportChanges(this._exporter);return e.isEmpty()||this._emitter.emit(d.z.ValuesUpdated,n),n}}])&&S(t.prototype,n),f&&S(t,f),e}();I.version="1.2.0",I.buildDate="23/09/2021 13:29:51",I.releaseDate="23/09/2021",I.languages={},I.registeredLanguages=new Map}}]);