(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[797],{41304:function(e,t,r){"use strict";r.d(t,{C:function(){return p}});var n=r(15861),o=r(15671),i=r(43144),a=r(4942),u=r(87757),c=r.n(u);function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var f={timeoutSeconds:5};function _(e){return((new Date).getTime()-e.getTime())/1e3}var p=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f;(0,o.Z)(this,e),(0,a.Z)(this,"props",void 0),(0,a.Z)(this,"cache",new Map),this.props=l(l({},t),f)}return(0,i.Z)(e,[{key:"get",value:function(){var e=(0,n.Z)(c().mark((function e(t){var r,n,o,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null!==(r=this.cache.get(t))&&void 0!==r?r:{timestamp:new Date(0)},o=n.timestamp,i=n.item,!(_(o)<this.props.timeoutSeconds)){e.next=5;break}return e.abrupt("return",i);case 5:return this.cache.delete(t),e.abrupt("return",void 0);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getWith",value:function(){var e=(0,n.Z)(c().mark((function e(t,r){var n,o,i,a,u;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=null!==(n=this.cache.get(t))&&void 0!==n?n:{timestamp:new Date(0)},i=o.timestamp,a=o.item,!(_(i)<this.props.timeoutSeconds)){e.next=5;break}return e.abrupt("return",a);case 5:return e.next=7,r(t);case 7:return u=e.sent,this.set(t,u),e.abrupt("return",u);case 10:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"set",value:function(e,t){return this.cache.set(e,{timestamp:new Date,item:t})}},{key:"fetch",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=(0,n.Z)(c().mark((function e(t){var r,n=arguments;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.length>1&&void 0!==n[1]?n[1]:t,e.next=3,this.getWith(r,(function(){return fetch(t).then((function(e){return e.json()}))}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}())}]),e}()},81923:function(e,t,r){"use strict";r.r(t),r.d(t,{fetchAppIcon:function(){return _}});var n=r(15861),o=r(87757),i=r.n(o),a=r(41304),u=r(77503),c=r(13099),s=new a.C({timeoutSeconds:300});function l(e){return f.apply(this,arguments)}function f(){return(f=(0,n.Z)(i().mark((function e(t){var r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t).then((function(e){return e.text()}));case 3:return r=e.sent,n=u.load(r),e.abrupt("return",n('meta[property="og:image"]').attr("content"));case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",void 0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function _(e){return p.apply(this,arguments)}function p(){return(p=(0,n.Z)(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Promise((function(e){return setTimeout((function(){return e(void 0)}),3e3)})),e.next=3,Promise.race([l(t),r]);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var d=function(){var e=(0,n.Z)(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t.value){e.next=2;break}return e.abrupt("return",void 0);case 2:return e.next=4,s.getWith(t.value,_);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();t.default=c.$Q({name:"Glide App Icon",description:"Gets a Glide app's icon",author:"David Siegel <david@glideapps.com>",params:{url:{displayName:"Glide URL",type:"uri"}},result:{type:"image-uri"},example:{url:"https://employees.glideapp.io"},run:d,about:"\n      Given a URL to a Glide app or page, this column produces a link to the icon for that app or page.\n    ",icon:"glide"})},72261:function(e,t,r){"use strict";r.r(t);var n,o=r(15861),i=r(87757),a=r.n(i),u=r(13099),c=r(20509);!function(e){e.UPC_A="UPC_A"}(n||(n={}));var s=function(){var e=(0,o.Z)(a().mark((function e(t,r){var o,i,u;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.value,i=r.value,u=void 0===i?500:i,void 0!==o){e.next=4;break}return e.abrupt("return",void 0);case 4:return e.abrupt("return",(0,c.H)("https://mobiledemand-barcode.azurewebsites.net/barcode/image",{content:o,size:u,symbology:n.UPC_A,format:"png",text:!0}));case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();t.default=u.$Q({name:"Barcode",description:"Generates barcode images",about:"\n      Uses [ruggedtabletpc.com](https://ruggedtabletpc.com) to generate images of barcodes.\n\n      Only supports 11-digit barcodes for now.\n    ",author:"David Siegel <david@glideapps.com>",params:{content:{displayName:"Content",type:"primitive"},size:{displayName:"Size",type:"number"}},example:{content:12345678910,size:250},result:{type:"image-uri"},run:s,icon:'<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">\n    <path d="M3 4H1V44H3V4Z" fill="currentColor"/>\n    <path d="M47 4H45V44H47V4Z" fill="currentColor"/>\n    <path d="M8 4H6V39H8V4Z" fill="currentColor"/>\n    <path d="M42 4H40V39H42V4Z" fill="currentColor"/>\n    <path d="M37 4H35V39H37V4Z" fill="currentColor"/>\n    <path d="M18 4H11V39H18V4Z" fill="currentColor"/>\n    <path d="M33 4H27V39H33V4Z" fill="currentColor"/>\n    <path d="M24 4H21V39H24V4Z" fill="currentColor"/>\n    </svg>'})},56727:function(e,t,r){"use strict";r.r(t);var n=r(15861),o=r(87757),i=r.n(o),a=r(13099),u=function(){var e=(0,n.Z)(i().mark((function e(t,r,n){var o,a,u,c,s,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.value,a=void 0===o?600:o,u=n.value,c=void 0===u?"1":u,s=r.value,"random"===(l=void 0===s?"":s)&&(l=""),e.abrupt("return","https://doodleipsum.com/".concat(a,"/").concat(l,"?n=").concat(encodeURIComponent(c)));case 5:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}();t.default=a.$Q({name:"Doodle Ipsum",description:"Generate random illustrations from data",video:"https://www.youtube.com/watch?v=kvUU1N-B_Ok",about:"\n      [Doodle Ipsum](https://doodleipsum.com) is the *lorem ipsum* of illustrations. Learn more at [doodleipsum.com](https://doodleipsum.com).\n    ",author:"David Siegel <david@glideapps.com>",params:{size:{displayName:"Size",type:"number"},category:{displayName:"Category (random|flat|hand-drawn|outline|abstract|avatar)",type:"string"},random:{displayName:"Random Seed",type:"primitive"}},example:{size:200,category:"avatar",random:42},result:{type:"image-uri"},run:u,icon:'\n      <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <path d="M37 26C42.5228 26 47 21.5228 47 16C47 10.4772 42.5228 6 37 6C31.4772 6 27 10.4772 27 16C27 21.5228 31.4772 26 37 26Z" fill="currentColor"/>\n        <path d="M27 27H11C10.4477 27 10 27.4477 10 28V44C10 44.5523 10.4477 45 11 45H27C27.5523 45 28 44.5523 28 44V28C28 27.4477 27.5523 27 27 27Z" fill="currentColor"/>\n        <path d="M3.99981 21H21.9998C22.1768 21 22.3506 20.9529 22.5035 20.8638C22.6564 20.7746 22.7829 20.6464 22.87 20.4923C22.9572 20.3383 23.0019 20.1639 22.9995 19.9869C22.9972 19.8099 22.948 19.6367 22.8568 19.485L13.8568 4.48498C13.7612 4.34597 13.6333 4.23229 13.484 4.15375C13.3347 4.07522 13.1685 4.03418 12.9998 4.03418C12.8311 4.03418 12.6649 4.07522 12.5156 4.15375C12.3663 4.23229 12.2384 4.34597 12.1428 4.48498L3.14281 19.485C3.05166 19.6367 3.00241 19.8099 3.00009 19.9869C2.99777 20.1639 3.04246 20.3383 3.12961 20.4923C3.21675 20.6464 3.34323 20.7746 3.49611 20.8638C3.649 20.9529 3.82281 21 3.99981 21Z" fill="currentColor"/>\n      </svg>\n    '})},63258:function(e,t,r){"use strict";r.r(t);var n=r(15861),o=r(87757),i=r.n(o),a=r(13099),u=r(18284),c=r.n(u),s=new(r(41304).C)({timeoutSeconds:300}),l=function(){var e=(0,n.Z)(i().mark((function e(t,r){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t.value){e.next=2;break}return e.abrupt("return",void 0);case 2:return e.next=4,s.fetch(t.value);case 4:return n=e.sent,void 0!==r.value&&(n=c().json(n,r.value)),e.abrupt("return","object"===typeof n?JSON.stringify(n):n);case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();t.default=a.$Q({name:"Fetch JSON",description:"Fetch and optionally transform JSON",about:"\n      Given a URL, this column fetches JSON data at that URL. An optional [jq query](https://stedolan.github.io/jq/manual/#Basicfilters) transforms the JSON.\n    ",author:"David Siegel <david@glideapps.com>",video:"https://www.youtube.com/watch?v=EvpwhGeiH0U",params:{url:{displayName:"URL",type:"string"},query:{displayName:"JQ Query",type:"string"}},result:{type:"primitive"},example:{url:"https://api.icndb.com/jokes/random/3",query:".value[0].joke"},run:l})},61747:function(e,t,r){"use strict";r.r(t);var n=r(15861),o=r(87757),i=r.n(o),a=r(41304),u=r(13099);function c(e){var t="".concat(e),r=0;if(0===t.length)return r;for(var n=0;n<t.length;n++){r=(r<<5)-r+t.charCodeAt(n),r&=r}return r}var s=new a.C({timeoutSeconds:Number.MAX_SAFE_INTEGER}),l=function(){var e=(0,n.Z)(i().mark((function e(t,r){var n,o,a,u,l,f,_,p;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.value,a=void 0===o?"3d":o,void 0!==(u=r.value)){e.next=4;break}return e.abrupt("return",void 0);case 4:return e.next=6,s.fetch("/glide-brand-image/images.json");case 6:return l=e.sent,f=null!==(n=l[a])&&void 0!==n?n:l["3d"],_=Math.abs(c(u)),p=f[_%f.length],e.abrupt("return","https://column.sh".concat(p));case 11:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();t.default=u.$Q({name:"Glide Brand Image",description:"Glide 3D Data Shapes",author:"David Siegel <david@glideapps.com>",params:{category:{displayName:"Category (3d, avatar, or gradient)",type:"string"},random:{displayName:"Seed Value",type:"string"}},example:{category:"3d",random:"glideapps.com"},result:{type:"image-uri"},run:l,icon:"glide"})},52405:function(e,t,r){"use strict";r.r(t);var n=r(93433),o=r(15861),i=r(87757),a=r.n(i),u=r(13099);r(96486);var c=new Map,s=function(){var e=(0,o.Z)(a().mark((function e(t){var r,o,i,u,s,l=arguments;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(null===t||void 0===t?void 0:t.value)){e.next=2;break}return e.abrupt("return",void 0);case 2:for(r="async (p1,p2,p3)=>{ ".concat(t.value," }"),o=(0,eval)(r),c.set(t.value,o),i=l.length,u=new Array(i>1?i-1:0),s=1;s<i;s++)u[s-1]=l[s];return e.abrupt("return",o.apply(void 0,(0,n.Z)(u.map((function(e){return e.value})))));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();t.default=u.$Q({name:"Hell Yes-Code",description:"Runs JavaScript",about:"Inludes [lodash](https://lodash.com/docs).",author:"Mark Probst <mark@glideapps.com>",video:"https://www.youtube.com/watch?v=c-I5S_zTwAc",params:{code:{displayName:"JavaScript code",type:"string"},p1:{displayName:"p1",type:"primitive"},p2:{displayName:"p2",type:"primitive"},p3:{displayName:"p3",type:"primitive"}},example:{code:'return "Hell " + p1.replace("no", "yes") + "!".repeat(p2)',p1:"no-code",p2:5},result:{type:"primitive"},run:s,icon:'<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <path d="M34.4381 11.774C34.1931 11.474 33.9761 11.205 33.7931 10.968C33.6822 10.8233 33.5338 10.7117 33.3641 10.6452C33.1943 10.5787 33.0096 10.5599 32.8299 10.5908C32.6502 10.6217 32.4824 10.7011 32.3446 10.8205C32.2068 10.9398 32.1043 11.0946 32.0481 11.268C31.4977 12.9485 30.6607 14.521 29.5741 15.916C29.6381 11.944 28.8511 4.93503 23.0951 1.16003C22.944 1.06079 22.7688 1.00435 22.5882 0.996737C22.4076 0.989122 22.2283 1.03061 22.0693 1.11679C21.9104 1.20296 21.7779 1.3306 21.6857 1.48613C21.5936 1.64166 21.5453 1.81926 21.5461 2.00003C21.5461 5.27603 19.7911 8.76703 16.7401 11.575C13.7881 14.293 6.92906 21.476 7.00006 29.433C7.05006 34.973 9.87106 42.633 17.0271 45.674C17.1341 42.197 18.6511 39.728 20.1351 37.348C21.5451 35.084 22.8781 32.948 23.0001 29.959C23.0077 29.7673 23.0703 29.5819 23.1805 29.4248C23.2906 29.2677 23.4436 29.1456 23.6213 29.073C23.7989 29.0005 23.9936 28.9806 24.1823 29.0157C24.3709 29.0508 24.5454 29.1395 24.6851 29.271C28.7181 33.071 30.8791 38.701 30.9851 45.571C36.1181 43.382 40.3221 38.611 40.9421 30.85C41.7431 20.771 36.8091 14.694 34.4381 11.774Z" fill="currentColor"/>\n    </svg>\n    '})},54506:function(e,t,r){"use strict";r.r(t);var n=r(93433),o=r(84506),i=r(15861),a=r(87757),u=r.n(a),c=r(13099),s=r(63807),l={precisionRounding:4,licenseKey:"gpl-v3"},f=function(){var e=(0,i.Z)(u().mark((function e(t){var r,i,a,c,f,_,p,d,m,h,y=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=2;break}return e.abrupt("return",void 0);case 2:for(r=t.value,i=y.length,a=new Array(i>1?i-1:0),c=1;c<i;c++)a[c-1]=y[c];return f=a.map((function(e){return e.value})),_=(0,o.Z)(f),p=_[0],d=_.slice(1),m=[[p,r]].concat((0,n.Z)(d.map((function(e){return[e]})))),h=s.GP.buildFromArray(m,l),e.abrupt("return",h.getCellValue({row:0,col:1,sheet:0}));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();t.default=c.$Q({name:"Hyperformula",description:"Run Excel formulas",about:"\n      Uses [handsontable.github.io/hyperformula](https://handsontable.github.io/hyperformula) to evaluate\n      Excel formulas.\n    ",video:"https://www.youtube.com/watch?v=JJXUmACTDdk",author:"David Siegel <david@glideapps.com>",params:{formula:{displayName:"Formula",type:"string"},A1:{displayName:"A1",type:"primitive"},A2:{displayName:"A2",type:"primitive"},A3:{displayName:"A3",type:"primitive"},A4:{displayName:"A4",type:"primitive"},A5:{displayName:"A5",type:"primitive"}},example:{formula:"= A1 + A2",A1:"= MAX(3, A3, 5)",A2:'= LEN("Glide")',A3:42},result:{type:"primitive"},run:f,icon:'<svg width="41" height="44" viewBox="0 0 41 44" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M30.802 1.61791C32.2704 0.484412 34.0962 -0.0858159 35.9487 0.0104718H40.6196L38.3202 4.0615H35.9127C35.2336 4.01682 34.5631 4.23344 34.0385 4.66699C33.518 5.22337 33.1787 5.92466 33.0654 6.67808L26.4122 37.7528C26.067 39.5449 25.1304 41.1693 23.7524 42.366C22.2845 43.5066 20.4547 44.0799 18.5985 43.9807H15.5089L15.5078 43.9861H10.4044L14.849 21.527C14.9408 21.1299 14.9868 20.7236 14.9859 20.316C15.0128 19.9308 14.9594 19.5442 14.8292 19.1806C14.6989 18.817 14.4945 18.4845 14.229 18.204C13.5913 17.6788 12.7751 17.4205 11.9512 17.4832C10.7477 17.4322 9.56904 17.8362 8.64988 18.6149C7.69907 19.5239 7.07776 20.7234 6.88386 22.0244L5.13947 31.0059H0L4.87276 6.57716H10.0122L8.36155 14.9099C9.90333 13.6526 11.8438 12.9879 13.8326 13.0357C15.5452 12.9446 17.2282 13.509 18.5396 14.6143C19.135 15.1912 19.5991 15.8897 19.9001 16.6622C20.2011 17.4347 20.3321 18.263 20.284 19.0906C20.2821 19.8008 20.2048 20.5088 20.0533 21.2027L16.3186 39.9224H18.6417C18.9779 39.9484 19.316 39.9076 19.6364 39.8024C19.9567 39.6973 20.2532 39.5298 20.5087 39.3097C21.0365 38.7613 21.3772 38.0598 21.4818 37.3059L28.135 6.23117C28.4858 4.43947 29.4244 2.81601 30.802 1.61791Z" fill="currentColor"/>\n</svg>\n'})},46471:function(e,t,r){"use strict";r.r(t);var n=r(15861),o=r(87757),i=r.n(o),a=r(18284),u=r.n(a),c=r(13099),s=function(){var e=(0,n.Z)(i().mark((function e(t,r){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t.value){e.next=2;break}return e.abrupt("return",void 0);case 2:if(void 0!==r.value){e.next=4;break}return e.abrupt("return",t.value);case 4:return n=u().json(JSON.parse(t.value),r.value),e.abrupt("return","object"===typeof n||Array.isArray(n)?JSON.stringify(n):n);case 6:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();t.default=c.$Q({name:"Transform JSON",description:"Transform JSON with JQ",author:"David Siegel <david@glideapps.com>",video:"https://www.youtube.com/watch?v=EvpwhGeiH0U",about:"Learn more about jq at https://stedolan.github.io/jq/",params:{json:{displayName:"JSON",type:"string"},query:{displayName:"JQ Query",type:"string"}},result:{type:"string"},run:s,example:{json:'{ "name": "David", "favorite food": "sushi" }',query:".name"}})},71543:function(e,t,r){"use strict";r.r(t);var n=r(15861),o=r(87757),i=r.n(o),a=r(13099),u=r(36137),c=u.exec,s=u.env,l=function(){var e=(0,n.Z)(i().mark((function e(t){var r,n,o,a,u,l=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(null===t||void 0===t?void 0:t.value)){e.next=2;break}return e.abrupt("return",void 0);case 2:for(r=l.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=l[o];return a=s.inherit("name",Object.fromEntries(n.map((function(e,t){return["p".concat(t+1),e.value]})))),e.prev=4,e.next=7,c(t.value,a);case 7:return u=e.sent,e.abrupt("return",u[0]);case 11:return e.prev=11,e.t0=e.catch(4),e.abrupt("return",void 0);case 14:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(t){return e.apply(this,arguments)}}();t.default=a.$Q({name:"LISP",run:l,description:"Runs LISP code",about:'\n      Uses [github.com/jcubic/lips](https://github.com/jcubic/lips), a \n      "scheme-based powerful lisp interpreter written in JavaScript."\n    ',video:"https://www.youtube.com/watch?v=G3FDnNZF5uA",author:"David Siegel <david@glideapps.com>",params:{code:{displayName:"LISP",type:"string"},p1:{displayName:"p1",type:"primitive"},p2:{displayName:"p2",type:"primitive"},p3:{displayName:"p3",type:"primitive"},p4:{displayName:"p4",type:"primitive"},p5:{displayName:"p5",type:"primitive"}},example:{code:"(+ 1 2 p1)",p1:5},result:{type:"primitive"}})},97977:function(e,t,r){"use strict";r.r(t);var n=r(15861),o=r(87757),i=r.n(o),a=r(13099),u=r(20509),c=function(){var e=(0,n.Z)(i().mark((function e(t,r){var n,o,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.value,o=r.value,a=void 0===o?500:o,void 0!==n){e.next=4;break}return e.abrupt("return",void 0);case 4:return e.abrupt("return",(0,u.H)("https://api.qrserver.com/v1/create-qr-code/",{data:n,size:"".concat(a,"x").concat(a),margin:0}));case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();t.default=a.$Q({name:"QR Code",description:"Generate QR codes",about:"\n      Uses [goQR.me](https://goqr.me/api/)'s QR code generation API.\n    ",video:"https://www.youtube.com/watch?v=142TGhaTMtI",author:"David Siegel <david@glideapps.com>",params:{content:{displayName:"Content",type:"primitive"},size:{displayName:"Size",type:"number"}},example:{content:"https://glideapps.com",size:250},result:{type:"image-uri"},run:c,icon:'<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <path d="M16 2H2V16H16V2ZM14 14H4V4H14V14Z" fill="currentColor"/>\n      <path d="M31 42H29V46H46V44H31V42Z" fill="currentColor"/>\n      <path d="M12 6H6V12H12V6Z" fill="currentColor"/>\n      <path d="M2 46H16V32H2V46ZM4 34H14V44H4V34Z" fill="currentColor"/>\n      <path d="M12 36H6V42H12V36Z" fill="currentColor"/>\n      <path d="M32 2V16H46V2H32ZM44 14H34V4H44V14Z" fill="currentColor"/>\n      <path d="M42 6H36V12H42V6Z" fill="currentColor"/>\n      <path d="M46 18H42V22H46V18Z" fill="currentColor"/>\n      <path d="M6 26H2V30H6V26Z" fill="currentColor"/>\n      <path d="M23 18H15V20H25V16V14H27V10H25H23H21V6H23V8H30V2H28V6H25V2H24H20H19V12H23V14H19V16H23V18Z" fill="currentColor"/>\n      <path d="M5 24H9H11H12V26H8V28H12V30H20V28H14V26V22H11V19H9V22H7V18H2V20H5V24Z" fill="currentColor"/>\n      <path d="M24 42V37H20V33H18V39H22V42H18V44H22V46H27V44H24V42Z" fill="currentColor"/>\n      <path d="M34 22H30V17H28V24H38V22H36V20H39V18H36H34H32V20H34V22Z" fill="currentColor"/>\n      <path d="M32 40H35V42H39V40V38V35H35V38H32V35H30V38H28V30H26V28H24V22H17V26H19V24H22V28V32H26V38V40H28H30H32Z" fill="currentColor"/>\n      <path d="M44 27H41H39H34V31H32V27H30V33H36V29H39V32H41V29H44V35H41V41H46V39H43V37H46V29V27V24H44V27Z" fill="currentColor"/>\n      </svg>\n      '})},23269:function(e,t,r){"use strict";r.r(t);var n=r(15861),o=r(87757),i=r.n(o),a=r(13099),u=function(){var e=(0,n.Z)(i().mark((function e(t,r,n){var o,a,u,c,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(o=null===t||void 0===t?void 0:t.value)){e.next=3;break}return e.abrupt("return",void 0);case 3:if(void 0!==(a=null===r||void 0===r?void 0:r.value)){e.next=6;break}return e.abrupt("return",void 0);case 6:if(void 0!==(u=null===n||void 0===n?void 0:n.value)){e.next=9;break}return e.abrupt("return",void 0);case 9:return e.next=11,fetch("https://translation.googleapis.com/language/translate/v2?key=".concat(u),{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({q:[o],target:a})}).then((function(e){return e.json()}));case 11:if(c=e.sent,!(void 0!==(s=c.data)&&void 0!==s.translations&&s.translations.length>0)){e.next=15;break}return e.abrupt("return",s.translations[0].translatedText);case 15:return e.abrupt("return",void 0);case 16:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}();t.default=a.$Q({name:"Google Translate",description:"Translate from one language to another",author:"David Siegel <david@glideapps.com>",video:"https://www.youtube.com/watch?v=A3knNbGfXh4",about:"\n      Find supported languages at [cloud.google.com/translate/docs/languages](https://cloud.google.com/translate/docs/languages).\n    ",params:{text:{displayName:"Text",type:"string"},language:{displayName:"Target Language",type:"string"},key:{displayName:"API Key",type:"string"}},result:{type:"string"},run:u,example:{text:"Hello, world!",language:"es"},icon:'\n      <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <path d="M25.74 30.15L20.66 25.13L20.72 25.07C24.2 21.19 26.68 16.73 28.14 12.01H34V8H20V4H16V8H2V11.98H24.34C22.99 15.84 20.88 19.5 18 22.7C16.14 20.63 14.6 18.38 13.38 16H9.38C10.84 19.26 12.84 22.34 15.34 25.12L5.17 35.17L8 38L18 28L24.22 34.22L25.74 30.15ZM37 20H33L24 44H28L30.25 38H39.75L42 44H46L37 20ZM31.75 34L35 25.33L38.25 34H31.75Z" fill="currentColor"/>\n      </svg>\n    '})},709:function(e,t,r){"use strict";r.r(t);var n=r(15861),o=r(87757),i=r.n(o),a=r(13099);function u(e){var t=function(e){var t=e.match(/(?:youtu\.be\/|youtube\.com(?:\/embed\/|\/v\/|\/watch\?v=|\/user\/\S+|\/ytscreeningroom\?v=|\/sandalsResorts#\w\/\w\/.*\/))([^\/&\?]{10,12})/);return null===t||void 0===t?void 0:t[1]}(e);return void 0===t?void 0:"https://i.ytimg.com/vi/".concat(t,"/maxresdefault.jpg")}var c=function(){var e=(0,n.Z)(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t.value){e.next=2;break}return e.abrupt("return",void 0);case 2:return e.abrupt("return",u(t.value));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();t.default=a.$Q({name:"YouTube Thumbnail",description:"Display video thumbnail images",author:"David Siegel <david@glideapps.com>",params:{videoUrl:{displayName:"Video URL",type:"uri"}},result:{type:"image-uri"},example:{videoUrl:"https://www.youtube.com/watch?v=dQw4w9WgXcQ"},run:c,icon:'\n      <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M47.5 14.4C47.5 14.4 47 11.1 45.6 9.59998C43.8 7.69998 41.7 7.69998 40.8 7.59998C34.1 7.09998 24 7.09998 24 7.09998C24 7.09998 13.9 7.09998 7.2 7.59998C6.3 7.69998 4.2 7.69998 2.4 9.59998C1 11.1 0.5 14.4 0.5 14.4C0.5 14.4 0 18.3 0 22.2V25.8C0 29.7 0.5 33.6 0.5 33.6C0.5 33.6 1 36.9 2.4 38.4C4.2 40.3 6.6 40.3 7.7 40.5C11.5 40.9 24 41 24 41C24 41 34.1 41 40.8 40.5C41.7 40.4 43.8 40.4 45.6 38.5C47 37 47.5 33.7 47.5 33.7C47.5 33.7 48 29.8 48 25.9V22.3C48 18.3 47.5 14.4 47.5 14.4ZM19 30.2V16.7L32 23.5L19 30.2Z" fill="currentColor"/>\n</svg>\n    '})},13099:function(e,t,r){"use strict";r.d(t,{$Q:function(){return p}});var n=r(93433),o=r(29439),i=r(4942),a=r(15861),u=r(87757),c=r.n(u);function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function f(e){return e instanceof Date?e.toISOString():Array.isArray(e)?e.map(f):e}function _(){return(_=(0,a.Z)(c().mark((function e(t,r){var o,i,a,u,s,l,_;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.data,a=i.key,u=i.params,e.prev=1,e.next=4,r.apply(void 0,(0,n.Z)(u));case 4:s=e.sent,e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),s=void 0;try{l=e.t0.toString()}catch(c){l="Exception can't be stringified."}case 11:_={key:a},void 0!==s&&(s=f(s),_.result={type:"string",value:s}),void 0!==l&&(_.error=l),(null===(o=t.source)||void 0===o?void 0:o.postMessage.bind(o))(_,"*");case 15:case"end":return e.stop()}}),e,null,[[1,7]])})))).apply(this,arguments)}function p(e){return window.addEventListener("message",(function(t){return function(e,t){return _.apply(this,arguments)}(t,e.run)})),l(l({},e),{},{json:JSON.stringify(d(e),null,2)})}function d(e){var t=e.name,r=e.description,n=e.author,i=e.result,a=e.params,u=e.about,c=e.video,s=e.icon,f=void 0===s?'<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M12.0002 34.828L2.58624 25.414C1.80524 24.633 1.80524 23.367 2.58624 22.586L12.0002 13.172L14.8292 16L6.82924 24L14.8292 32L12.0002 34.828Z" fill="currentColor"/>\n<path d="M36.0004 34.828L33.1714 32L41.1714 24L33.1714 16L36.0004 13.172L45.4144 22.586C46.1954 23.367 46.1954 24.633 45.4144 25.414L36.0004 34.828Z" fill="currentColor"/>\n<path d="M26.5485 5.57617L17.5723 41.4553L21.4527 42.4261L30.4289 6.54697L26.5485 5.57617Z" fill="currentColor"/>\n</svg>':s;return"glide"===f&&(f='\n        <svg\n          width="48"\n          height="48"\n          viewBox="0 0 26 27"\n          fill="none"\n          xmlns="http://www.w3.org/2000/svg"\n        >\n          <path\n            d="M0 14.85L14.3 0V7.29C14.3 11.4653 11.0406 14.85 7.02 14.85H0Z"\n            fill="currentColor"\n          />\n          <path\n            d="M11.7 19.71C11.7 15.5347 14.9594 12.15 18.98 12.15H26L11.7 27V19.71Z"\n            fill="currentColor"\n          />\n        </svg>\n    '),{name:t,description:r,author:n,result:i,about:u,icon:f,video:c,params:Object.entries(a).map((function(e){var t=(0,o.Z)(e,2);return l({name:t[0]},t[1])}))}}},36137:function(module,exports,__webpack_require__){var __dirname="/",__filename="/index.js",process=__webpack_require__(34155),__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;(function(){"use strict";function unwrapExports(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}var readOnlyError=createCommonjsModule((function(e){e.exports=function(e){throw new TypeError('"'+e+'" is read-only')},e.exports.default=e.exports,e.exports.__esModule=!0})),_readOnlyError=unwrapExports(readOnlyError),setPrototypeOf=createCommonjsModule((function(e){function t(r,n){return e.exports=t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},e.exports.default=e.exports,e.exports.__esModule=!0,t(r,n)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0}));unwrapExports(setPrototypeOf);var isNativeReflectConstruct=createCommonjsModule((function(e){e.exports=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}},e.exports.default=e.exports,e.exports.__esModule=!0}));unwrapExports(isNativeReflectConstruct);var construct=createCommonjsModule((function(e){function t(r,n,o){return isNativeReflectConstruct()?(e.exports=t=Reflect.construct,e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=t=function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&setPrototypeOf(o,r.prototype),o},e.exports.default=e.exports,e.exports.__esModule=!0),t.apply(null,arguments)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0})),_construct=unwrapExports(construct),arrayWithHoles=createCommonjsModule((function(e){e.exports=function(e){if(Array.isArray(e))return e},e.exports.default=e.exports,e.exports.__esModule=!0}));unwrapExports(arrayWithHoles);var iterableToArray=createCommonjsModule((function(e){e.exports=function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.default=e.exports,e.exports.__esModule=!0}));unwrapExports(iterableToArray);var arrayLikeToArray=createCommonjsModule((function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n},e.exports.default=e.exports,e.exports.__esModule=!0}));unwrapExports(arrayLikeToArray);var unsupportedIterableToArray=createCommonjsModule((function(e){e.exports=function(e,t){if(e){if("string"===typeof e)return arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?arrayLikeToArray(e,t):void 0}},e.exports.default=e.exports,e.exports.__esModule=!0}));unwrapExports(unsupportedIterableToArray);var nonIterableRest=createCommonjsModule((function(e){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.default=e.exports,e.exports.__esModule=!0}));unwrapExports(nonIterableRest);var toArray=createCommonjsModule((function(e){e.exports=function(e){return arrayWithHoles(e)||iterableToArray(e)||unsupportedIterableToArray(e)||nonIterableRest()},e.exports.default=e.exports,e.exports.__esModule=!0})),_toArray=unwrapExports(toArray),arrayWithoutHoles=createCommonjsModule((function(e){e.exports=function(e){if(Array.isArray(e))return arrayLikeToArray(e)},e.exports.default=e.exports,e.exports.__esModule=!0}));unwrapExports(arrayWithoutHoles);var nonIterableSpread=createCommonjsModule((function(e){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.default=e.exports,e.exports.__esModule=!0}));unwrapExports(nonIterableSpread);var toConsumableArray=createCommonjsModule((function(e){e.exports=function(e){return arrayWithoutHoles(e)||iterableToArray(e)||unsupportedIterableToArray(e)||nonIterableSpread()},e.exports.default=e.exports,e.exports.__esModule=!0})),_toConsumableArray=unwrapExports(toConsumableArray),asyncToGenerator=createCommonjsModule((function(e){function t(e,t,r,n,o,i,a){try{var u=e[i](a),c=u.value}catch(s){return void r(s)}u.done?t(c):Promise.resolve(c).then(n,o)}e.exports=function(e){return function(){var r=this,n=arguments;return new Promise((function(o,i){var a=e.apply(r,n);function u(e){t(a,o,i,u,c,"next",e)}function c(e){t(a,o,i,u,c,"throw",e)}u(void 0)}))}},e.exports.default=e.exports,e.exports.__esModule=!0})),_asyncToGenerator=unwrapExports(asyncToGenerator),classCallCheck=createCommonjsModule((function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.default=e.exports,e.exports.__esModule=!0})),_classCallCheck=unwrapExports(classCallCheck),createClass=createCommonjsModule((function(e){function t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e},e.exports.default=e.exports,e.exports.__esModule=!0})),_createClass=unwrapExports(createClass),defineProperty=createCommonjsModule((function(e){e.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},e.exports.default=e.exports,e.exports.__esModule=!0})),_defineProperty=unwrapExports(defineProperty),objectWithoutPropertiesLoose=createCommonjsModule((function(e){e.exports=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o},e.exports.default=e.exports,e.exports.__esModule=!0}));unwrapExports(objectWithoutPropertiesLoose);var objectWithoutProperties=createCommonjsModule((function(e){e.exports=function(e,t){if(null==e)return{};var r,n,o=objectWithoutPropertiesLoose(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o},e.exports.default=e.exports,e.exports.__esModule=!0})),_objectWithoutProperties=unwrapExports(objectWithoutProperties),iterableToArrayLimit=createCommonjsModule((function(e){e.exports=function(e,t){var r=e&&("undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,i=[],a=!0,u=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(c){u=!0,o=c}finally{try{a||null==r.return||r.return()}finally{if(u)throw o}}return i}},e.exports.default=e.exports,e.exports.__esModule=!0}));unwrapExports(iterableToArrayLimit);var slicedToArray=createCommonjsModule((function(e){e.exports=function(e,t){return arrayWithHoles(e)||iterableToArrayLimit(e,t)||unsupportedIterableToArray(e,t)||nonIterableRest()},e.exports.default=e.exports,e.exports.__esModule=!0})),_slicedToArray=unwrapExports(slicedToArray),_typeof_1=createCommonjsModule((function(e){function t(r){return"function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?(e.exports=t=function(e){return typeof e},e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=t=function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.default=e.exports,e.exports.__esModule=!0),t(r)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0})),_typeof=unwrapExports(_typeof_1),asyncIterator=createCommonjsModule((function(e){e.exports=function(e){var t;if("undefined"!==typeof Symbol&&(Symbol.asyncIterator&&(t=e[Symbol.asyncIterator]),null==t&&Symbol.iterator&&(t=e[Symbol.iterator])),null==t&&(t=e["@@asyncIterator"]),null==t&&(t=e["@@iterator"]),null==t)throw new TypeError("Object is not async iterable");return t.call(e)},e.exports.default=e.exports,e.exports.__esModule=!0})),_asyncIterator=unwrapExports(asyncIterator),AwaitValue=createCommonjsModule((function(e){e.exports=function(e){this.wrapped=e},e.exports.default=e.exports,e.exports.__esModule=!0}));unwrapExports(AwaitValue);var awaitAsyncGenerator=createCommonjsModule((function(e){e.exports=function(e){return new AwaitValue(e)},e.exports.default=e.exports,e.exports.__esModule=!0})),_awaitAsyncGenerator=unwrapExports(awaitAsyncGenerator),AsyncGenerator_1=createCommonjsModule((function(e){function t(e){var t,r;function n(t,r){try{var i=e[t](r),a=i.value,u=a instanceof AwaitValue;Promise.resolve(u?a.wrapped:a).then((function(e){u?n("return"===t?"return":"next",e):o(i.done?"return":"normal",e)}),(function(e){n("throw",e)}))}catch(c){o("throw",c)}}function o(e,o){switch(e){case"return":t.resolve({value:o,done:!0});break;case"throw":t.reject(o);break;default:t.resolve({value:o,done:!1})}(t=t.next)?n(t.key,t.arg):r=null}this._invoke=function(e,o){return new Promise((function(i,a){var u={key:e,arg:o,resolve:i,reject:a,next:null};r?r=r.next=u:(t=r=u,n(e,o))}))},"function"!==typeof e.return&&(this.return=void 0)}t.prototype["function"===typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)},e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0}));unwrapExports(AsyncGenerator_1);var wrapAsyncGenerator=createCommonjsModule((function(e){e.exports=function(e){return function(){return new AsyncGenerator_1(e.apply(this,arguments))}},e.exports.default=e.exports,e.exports.__esModule=!0})),_wrapAsyncGenerator=unwrapExports(wrapAsyncGenerator),runtime_1=createCommonjsModule((function(e){var t=function(e){var t,r=Object.prototype,n=r.hasOwnProperty,o="function"===typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(P){c=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var o=t&&t.prototype instanceof h?t:h,i=Object.create(o.prototype),a=new A(n||[]);return i._invoke=function(e,t,r){var n=f;return function(o,i){if(n===p)throw new Error("Generator is already running");if(n===d){if("throw"===o)throw i;return k()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=C(a,r);if(u){if(u===m)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===f)throw n=d,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=p;var c=l(e,t,r);if("normal"===c.type){if(n=r.done?d:_,c.arg===m)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n=d,r.method="throw",r.arg=c.arg)}}}(e,r,a),i}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(P){return{type:"throw",arg:P}}}e.wrap=s;var f="suspendedStart",_="suspendedYield",p="executing",d="completed",m={};function h(){}function y(){}function v(){}var b={};b[i]=function(){return this};var g=Object.getPrototypeOf,w=g&&g(g(S([])));w&&w!==r&&n.call(w,i)&&(b=w);var x=v.prototype=h.prototype=Object.create(b);function D(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function L(e,t){function r(o,i,a,u){var c=l(e[o],e,i);if("throw"!==c.type){var s=c.arg,f=s.value;return f&&"object"===typeof f&&n.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,a,u)}),(function(e){r("throw",e,a,u)})):t.resolve(f).then((function(e){s.value=e,a(s)}),(function(e){return r("throw",e,a,u)}))}u(c.arg)}var o;this._invoke=function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}}function C(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,C(e,r),"throw"===r.method))return m;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var o=l(n,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var i=o.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function F(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(F,this),this.reset(!0)}function S(e){if(e){var r=e[i];if(r)return r.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}return{next:k}}function k(){return{value:t,done:!0}}return y.prototype=x.constructor=v,v.constructor=y,y.displayName=c(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,c(e,u,"GeneratorFunction")),e.prototype=Object.create(x),e},e.awrap=function(e){return{__await:e}},D(L.prototype),L.prototype[a]=function(){return this},e.AsyncIterator=L,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new L(s(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},D(x),c(x,u,"Generator"),x[i]=function(){return this},x.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=S,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;E(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:S(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}(e.exports);try{regeneratorRuntime=t}catch(r){Function("r","regeneratorRuntime = r")(t)}})),regenerator=runtime_1,_excluded=["token"],_excluded2=["stderr","stdin","stdout"],root,factory;function _createForOfIteratorHelper(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"===typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}root="undefined"!==typeof __webpack_require__.g?__webpack_require__.g:self,factory=function(root,BN,undefined$1){function contentLoaded(e,t){var r=!1,n=!0,o=e.document,i=o.documentElement,a=o.addEventListener,u=a?"addEventListener":"attachEvent",c=a?"removeEventListener":"detachEvent",s=a?"":"on",l=function n(i){"readystatechange"==i.type&&"complete"!=o.readyState||(("load"==i.type?e:o)[c](s+i.type,n,!1),!r&&(r=!0)&&t.call(e,i.type||i))};if("complete"==o.readyState)t.call(e,"lazy");else{if(!a&&i.doScroll){try{n=!e.frameElement}catch(f){}n&&function e(){try{i.doScroll("left")}catch(f){return void setTimeout(e,50)}l("poll")}()}o[u](s+"DOMContentLoaded",l,!1),o[u](s+"readystatechange",l,!1),e[u](s+"load",l,!1)}}function log(e){var t=arguments.length>1&&arguments[1]!==undefined$1?arguments[1]:null,r=!0===arguments[1];function n(e){if(is_debug()){var n=global_env.get("repr")(e);(null===t||t instanceof RegExp&&t.test(n))&&console.log(global_env.get("type")(e)+": "+n),r&&console.log(e)}}return is_promise(e)?e.then(n):n(e),e}function is_debug(){return user_env&&user_env.get("DEBUG",{throwError:!1})}function num_mnemicic_re(e){return e?"(?:#".concat(e,"(?:#[ie])?|#[ie]#").concat(e,")"):"(?:#[ie])?"}function gen_rational_re(e,t){return"".concat(num_mnemicic_re(e),"[+-]?").concat(t,"+/").concat(t,"+")}function gen_complex_re(e,t){return"".concat(num_mnemicic_re(e),"(?:[+-]?(?:").concat(t,"+/").concat(t,"+|nan.0|inf.0|").concat(t,"+))?(?:[+-]i|[+-]?(?:").concat(t,"+/").concat(t,"+|").concat(t,"+|nan.0|inf.0)i)(?=[()[\\]\\s]|$)")}function gen_integer_re(e,t){return"".concat(num_mnemicic_re(e),"[+-]?").concat(t,"+")}root.fetch||(root.fetch=function(e,t){return t=t||{},new Promise((function(r,n){var o=new XMLHttpRequest;for(var i in o.open(t.method||"get",e,!0),t.headers)o.setRequestHeader(i,t.headers[i]);function a(){var e,t=[],r=[],n={};return o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,(function(o,i,a){t.push(i=i.toLowerCase()),r.push([i,a]),e=n[i],n[i]=e?"".concat(e,",").concat(a):a})),{ok:2==(o.status/100|0),status:o.status,statusText:o.statusText,url:o.responseURL,clone:a,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([o.response]))},headers:{keys:function(){return t},entries:function(){return r},get:function(e){return n[e.toLowerCase()]},has:function(e){return e.toLowerCase()in n}}}}o.withCredentials="include"==t.credentials,o.onload=function(){r(a())},o.onerror=n,o.send(t.body||null)}))});var re_re=/^#\/((?:\\\/|[^/]|\[[^\]]*\/[^\]]*\])+)\/([gimyus]*)$/,float_stre="(?:[-+]?(?:[0-9]+(?:[eE][-+]?[0-9]+)|(?:\\.[0-9]+|[0-9]+\\.[0-9]+)(?:[eE][-+]?[0-9]+)?)|[0-9]+\\.)",complex_float_stre="(?:#[ie])?(?:[+-]?(?:[0-9]+/[0-9]+|nan.0|inf.0|".concat(float_stre,"|[+-]?[0-9]+))?(?:").concat(float_stre,"|[+-](?:[0-9]+/[0-9]+|[0-9]+|nan.0|inf.0))i"),float_re=new RegExp("^(#[ie])?".concat(float_stre,"$"),"i");function make_complex_match_re(e,t){var r="x"===e?"(?!\\+|".concat(t,")"):"(?!\\.|".concat(t,")"),n="";return""===e&&(n="(?:[-+]?(?:[0-9]+(?:[eE][-+]?[0-9]+)|(?:\\.[0-9]+|[0-9]+\\.[0-9]+(?![0-9]))(?:[eE][-+]?[0-9]+)?))"),new RegExp("^((?:(?:".concat(n,"|[-+]?inf.0|[-+]?nan.0|[+-]?").concat(t,"+/").concat(t,"+(?!").concat(t,")|[+-]?").concat(t,"+)").concat(r,")?)(").concat(n,"|[-+]?inf.0|[-+]?nan.0|[+-]?").concat(t,"+/").concat(t,"+|[+-]?").concat(t,"+|[+-])i$"),"i")}var complex_list_re=function(){var e={};return[[10,"","[0-9]"],[16,"x","[0-9a-fA-F]"],[8,"o","[0-7]"],[2,"b","[01]"]].forEach((function(t){var r=_slicedToArray(t,3),n=r[0],o=r[1],i=r[2];e[n]=make_complex_match_re(o,i)})),e}(),characters={alarm:"\x07",backspace:"\b",delete:"\x7f",escape:"\x1b",newline:"\n",null:"\0",return:"\r",space:" ",tab:"\t",dle:"\x10",soh:"\x01",dc1:"\x11",stx:"\x02",dc2:"\x12",etx:"\x03",dc3:"\x13",eot:"\x04",dc4:"\x14",enq:"\x05",nak:"\x15",ack:"\x06",syn:"\x16",bel:"\x07",etb:"\x17",bs:"\b",can:"\x18",ht:"\t",em:"\x19",lf:"\n",sub:"\x1a",vt:"\v",esc:"\x1b",ff:"\f",fs:"\x1c",cr:"\r",gs:"\x1d",so:"\x0e",rs:"\x1e",si:"\x0f",us:"\x1f",del:"\x7f"};function ucs2decode(e){for(var t=[],r=0,n=e.length;r<n;){var o=e.charCodeAt(r++);if(o>=55296&&o<=56319&&r<n){var i=e.charCodeAt(r++);56320===(64512&i)?t.push(((1023&o)<<10)+(1023&i)+65536):(t.push(o),r--)}else t.push(o)}return t}var character_symbols=Object.keys(characters).join("|"),char_sre_re="#\\\\(?:x[0-9a-f]+|".concat(character_symbols,"|[\\s\\S])"),char_re=new RegExp("^".concat(char_sre_re,"$"),"i");function make_num_stre(e){var t=[["o","[0-7]"],["x","[0-9a-fA-F]"],["b","[01]"],["d","[0-9]"],["","[0-9]"]].map((function(t){var r=_slicedToArray(t,2),n=r[0],o=r[1];return e(n,o)})).join("|");return e===gen_complex_re&&(t=complex_float_stre+"|"+t),t}function make_type_re(e){return new RegExp("^(?:"+make_num_stre(e)+")$","i")}var complex_re=make_type_re(gen_complex_re),rational_re=make_type_re(gen_rational_re),int_re=make_type_re(gen_integer_re),int_bare_re=new RegExp("^(?:"+gen_integer_re("","[0-9a-f]")+")$","i"),rational_bare_re=new RegExp("^(?:"+gen_rational_re("","[0-9a-f]")+")$","i"),complex_bare_re=new RegExp("^(?:"+gen_complex_re("","[0-9a-f]")+")$","i"),complex_bare_match_re=make_complex_match_re("","[0-9a-fA-F]"),pre_num_parse_re=/((?:#[xodbie]){0,2})(.*)/i;function num_pre_parse(e){var t=e.match(pre_num_parse_re),r={};if(t[1]){var n=t[1].replace(/#/g,"").toLowerCase().split("");n.includes("x")?r.radix=16:n.includes("o")?r.radix=8:n.includes("b")?r.radix=2:n.includes("d")&&(r.radix=10),n.includes("i")&&(r.inexact=!0),n.includes("e")&&(r.exact=!0)}return r.number=t[2],r}function parse_rational(e){var t=arguments.length>1&&arguments[1]!==undefined$1?arguments[1]:10,r=num_pre_parse(e),n=r.number.split("/"),o=LRational({num:LNumber([n[0],r.radix||t]),denom:LNumber([n[1],r.radix||t])});return r.inexact?o.valueOf():o}function parse_integer(e){var t=arguments.length>1&&arguments[1]!==undefined$1?arguments[1]:10,r=num_pre_parse(e);return r.inexact?LFloat(parseInt(r.number,r.radix||t)):LNumber([r.number,r.radix||t])}function parse_character(e){var t,r=e.match(/#\\x([0-9a-f]+)$/i);if(r){var n=parseInt(r[1],16);t=String.fromCodePoint(n)}else(r=e.match(/#\\(.+)$/))&&(t=r[1]);if(t)return LCharacter(t);throw new Error("Parse: invalid character")}function parse_complex(e){var t=arguments.length>1&&arguments[1]!==undefined$1?arguments[1]:10;function r(e){var r;if("+"===e)r=LNumber(1);else if("-"===e)r=LNumber(-1);else if(e.match(int_bare_re))r=LNumber([e,t]);else{if(!e.match(rational_bare_re)){if(e.match(float_re)){var n=parse_float(e);return o.exact?n.toRational():n}if(e.match(/nan.0$/))return LNumber(NaN);if(e.match(/inf.0$/))return"-"===e[0]?LNumber(Number.NEGATIVE_INFINITY):LNumber(Number.POSITIVE_INFINITY);throw new Error("Internal Parser Error")}var i=e.split("/");r=LRational({num:LNumber([i[0],t]),denom:LNumber([i[1],t])})}return o.inexact?LFloat(r.valueOf()):r}var n,o=num_pre_parse(e);t=o.radix||t;var i,a,u=o.number.match(complex_bare_match_re);return a=r((n=10!==t&&u?u:o.number.match(complex_list_re[t]))[2]),i=n[1]?r(n[1]):LNumber(0),0===a.cmp(0)&&"bigint"===a.__type__?i:LComplex({im:a,re:i})}function is_int(e){return parseInt(e.toString(),10)===e}function parse_big_int(e){var t=e.match(/^(([-+]?[0-9]*)(?:\.([0-9]+))?)e([-+]?[0-9]+)/i);if(t){var r,n=parseInt(t[4],10),o=t[1].replace(/[-+]?([0-9]*)\..+$/,"$1").length,i=t[3]&&t[3].length;o<Math.abs(n)&&(r=LNumber([t[1].replace(/\./,""),10]),i&&(n-=i))}return{exponent:n,mantisa:r}}function parse_float(e){var t=num_pre_parse(e),r=parseFloat(t.number),n=(t.number.match(/\.0$/)||!t.number.match(/\./))&&!t.number.match(/e/i);if(!t.inexact){if(t.exact&&n)return LNumber(r);if(is_int(r)&&t.number.match(/e\+?[0-9]/i))return LNumber(r);var o=parse_big_int(t.number),i=o.mantisa,a=o.exponent;if(i!==undefined$1&&a!==undefined$1){var u=LNumber(10).pow(LNumber(Math.abs(a)));if(t.exact&&a<0)return LRational({num:i,denom:u});if(a>0)return LNumber(i).mul(u)}}return r=LFloat(r),t.exact?r.toRational():r}function parse_string(e){var t=(e=e.replace(/\\x([0-9a-f]+);/gi,(function(e,t){return"\\u"+t.padStart(4,"0")})).replace(/\n/g,"\\n")).match(/(\\*)(\\x[0-9A-F])/i);if(t&&t[1].length%2===0)throw new Error("Invalid string literal, unclosed ".concat(t[2]));try{return LString(JSON.parse(e))}catch(r){throw new Error("Invalid string literal")}}function parse_symbol(e){if(e.match(/^\|.*\|$/)){e=e.replace(/(^\|)|(\|$)/g,"");var t={t:"\t",r:"\r",n:"\n"};e=e.replace(/\\(x[^;]+);/g,(function(e,t){return String.fromCharCode(parseInt("0"+t,16))})).replace(/\\(.)/g,(function(e,r){return t[r]||r}))}return new LSymbol(e)}function parse_argument(e){if(constants.hasOwnProperty(e))return constants[e];if(e.match(/^"[\s\S]*"$/))return parse_string(e);if("#"===e[0]){var t=e.match(re_re);if(t)return new RegExp(t[1],t[2]);if(e.match(char_re))return parse_character(e);var r=e.match(/#\\(.+)/);if(r&&1===ucs2decode(r[1]).length)return parse_character(e)}if(e.match(/[0-9a-f]|[+-]i/i)){if(e.match(int_re))return parse_integer(e);if(e.match(float_re))return parse_float(e);if(e.match(rational_re))return parse_rational(e);if(e.match(complex_re))return parse_complex(e)}if(e.match(/^#[iexobd]/))throw new Error("Invalid numeric constant: "+e);return parse_symbol(e)}function is_symbol_string(e){return!(["(",")","[","]"].includes(e)||e.match(re_re)||e.match(/^"[\s\S]*"$/)||e.match(int_re)||e.match(float_re)||e.match(complex_re)||e.match(rational_re)||e.match(char_re)||["#t","#f","nil","true","false"].includes(e))}var string_re=/"(?:\\[\S\s]|[^"])*"?/g;function escape_regex(e){return"string"===typeof e?e.replace(/([-\\^$[\]()+{}?*.|])/g,"\\$1"):e}function Stack(){this.data=[]}function tokens(e){e instanceof LString&&(e=e.valueOf());for(var t=new Lexer(e,{whitespace:!0}),r=[];;){var n=t.peek(!0);if(n===eof)break;r.push(n),t.skip()}return r}function multiline_formatter(e){var t=e.token,r=_objectWithoutProperties(e,_excluded);if(t.match(/^"[\s\S]*"$/)&&t.match(/\n/)){var n=new RegExp("^ {1,"+(e.col+1)+"}","mg");t=t.replace(n,"")}return _objectSpread({token:t},r)}function Thunk(e){var t=arguments.length>1&&arguments[1]!==undefined$1?arguments[1]:function(){};this.fn=e,this.cont=t}function trampoline(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return unwind(e.apply(this,r))}}function unwind(e){for(;e instanceof Thunk;){var t=e;(e=e.fn())instanceof Thunk||t.cont()}return e}function tokenize(e){var t=arguments.length>1&&arguments[1]!==undefined$1&&arguments[1];if(e instanceof LString&&(e=e.toString()),t)return tokens(e);var r=tokens(e).map((function(e){return"#\\ "===e.token?e.token:e.token.trim()})).filter((function(e){return e&&!e.match(/^;/)&&!e.match(/^#\|[\s\S]*\|#$/)}));return strip_s_comments(r)}function strip_s_comments(e){for(var t=0,r=null,n=[],o=0;o<e.length;++o){var i=e[o];"#;"!==i?null!==r&&([")","]"].includes(i)?t--:["(","["].includes(i)&&t++,0===t&&(n.push([r,o+1]),r=null)):(["(","["].includes(e[o+1])?(t=1,r=o):n.push([o,o+2]),o+=1)}e=e.slice(),n.reverse();for(var a=0,u=n;a<u.length;a++){var c=_slicedToArray(u[a],2),s=c[0],l=c[1];e.splice(s,l-s)}return e}function isSymbol(e){return"symbol"===_typeof(e)||"object"===_typeof(e)&&"[object Symbol]"===Object.prototype.toString.call(e)}function LSymbol(e){return"undefined"!==typeof this&&this.constructor!==LSymbol||"undefined"===typeof this?new LSymbol(e):(e instanceof LString&&(e=e.valueOf()),LSymbol.list[e]instanceof LSymbol?LSymbol.list[e]:(this.__name__=e,void("string"===typeof e&&(LSymbol.list[e]=this))))}function symbol_to_string(e){return e.toString().replace(/^Symbol\(([^)]+)\)/,"$1")}function is_gensym(e){return"symbol"===_typeof(e)&&!!e.toString().match(/^Symbol\(#:/)}Stack.prototype.push=function(e){this.data.push(e)},Stack.prototype.top=function(){return this.data[this.data.length-1]},Stack.prototype.pop=function(){return this.data.pop()},Stack.prototype.is_empty=function(){return!this.data.length},Thunk.prototype.toString=function(){return"#<Thunk>"},LSymbol.list={},LSymbol.is=function(e,t){return e instanceof LSymbol&&(t instanceof LSymbol&&e.__name__===t.__name__||"string"===typeof t&&e.__name__===t||t instanceof RegExp&&t.test(e.__name__))},LSymbol.prototype.toString=function(e){if(isSymbol(this.__name__))return symbol_to_string(this.__name__);var t=this.valueOf();return e&&t.match(/\s/)?"|".concat(t,"|"):t},LSymbol.prototype.serialize=function(){return LString.isString(this.__name__)?this.__name__:[symbol_to_string(this.__name__)]},LSymbol.prototype.valueOf=function(){return this.__name__.valueOf()},LSymbol.prototype.is_gensym=function(){return is_gensym(this.__name__)};var gensym=function(){var e=0;return function(){var t=arguments.length>0&&arguments[0]!==undefined$1?arguments[0]:null;return t instanceof LSymbol&&(t=t.valueOf()),is_gensym(t)?LSymbol(t):null!==t?new LSymbol(Symbol("#:".concat(t))):(e++,new LSymbol(Symbol("#:g".concat(e))))}}();function QuotedPromise(e){var t=this,r={pending:!0,rejected:!1,fulfilled:!1,reason:undefined$1,type:undefined$1};read_only(this,"_promise",e=e.then((function(e){return r.type=type(e),r.fulfilled=!0,r.pending=!1,e})),{hidden:!0}),is_function(e.catch)&&(e=e.catch((function(e){r.rejected=!0,r.pending=!1,r.reason=e}))),Object.keys(r).forEach((function(e){Object.defineProperty(t,"__".concat(e,"__"),{enumerable:!0,get:function(){return r[e]}})})),read_only(this,"__promise__",e),this.then=!1}function promise_all(e){return Array.isArray(e)?Promise.all(escape_quoted_promises(e)).then(unescape_quoted_promises):e}function escape_quoted_promises(e){for(var t=new Array(e.length),r=e.length;r--;){var n=e[r];t[r]=n instanceof QuotedPromise?new Value(n):n}return t}function unescape_quoted_promises(e){for(var t=new Array(e.length),r=e.length;r--;){var n=e[r];t[r]=n instanceof Value?n.valueOf():n}return t}QuotedPromise.prototype.then=function(e){return new QuotedPromise(this.valueOf().then(e))},QuotedPromise.prototype.catch=function(e){return new QuotedPromise(this.valueOf().catch(e))},QuotedPromise.prototype.valueOf=function(){if(!this._promise)throw new Error("QuotedPromise: invalid promise created");return this._promise},QuotedPromise.prototype.toString=function(){return this.__pending__?QuotedPromise.pending_str:this.__rejected__?QuotedPromise.rejected_str:"#<js-promise resolved (".concat(this.__type__,")>")},QuotedPromise.pending_str="#<js-promise (pending)>",QuotedPromise.rejected_str="#<js-promise (rejected)>";var specials={LITERAL:Symbol.for("literal"),SPLICE:Symbol.for("splice"),SYMBOL:Symbol.for("symbol"),names:function(){return Object.keys(this._specials)},type:function(e){return this.get(e).type},get:function(e){return this._specials[e]},off:function(e){var t=this,r=arguments.length>1&&arguments[1]!==undefined$1?arguments[1]:null;Array.isArray(e)?e.forEach((function(e){return t.off(e,r)})):null===r?delete this._events[e]:this._events=this._events.filter((function(e){return e!==r}))},on:function(e,t){var r=this;Array.isArray(e)?e.forEach((function(e){return r.on(e,t)})):this._events[e]?this._events[e].push(t):this._events[e]=[t]},trigger:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];this._events[e]&&this._events[e].forEach((function(e){return e.apply(void 0,r)}))},remove:function(e){this.trigger("remove"),delete this._specials[e]},append:function(e,t,r){this.trigger("append"),this._specials[e]={seq:e,symbol:t,type:r}},_events:{},_specials:{}};function is_literal(e){return specials.type(e)===specials.LITERAL}var defined_specials=[["'",new LSymbol("quote"),specials.LITERAL],["`",new LSymbol("quasiquote"),specials.LITERAL],[",@",new LSymbol("unquote-splicing"),specials.LITERAL],[",",new LSymbol("unquote"),specials.LITERAL],["'>",new LSymbol("quote-promise"),specials.LITERAL]];Object.defineProperty(specials,"builtin",{writable:!1,value:defined_specials.map((function(e){return e[0]}))}),defined_specials.forEach((function(e){var t=_slicedToArray(e,3),r=t[0],n=t[1],o=t[2];specials.append(r,n,o)}));var Lexer=function(){function e(t){var r=this,n=arguments.length>1&&arguments[1]!==undefined$1?arguments[1]:{},o=n.whitespace,i=void 0!==o&&o;_classCallCheck(this,e),read_only(this,"__input__",t.replace(/\r/g,""));var a={};["_i","_whitespace","_col","_newline","_line","_state","_next","_token","_prev_char"].forEach((function(e){Object.defineProperty(r,e,{configurable:!1,enumerable:!1,get:function(){return a[e]},set:function(t){a[e]=t}})})),this._whitespace=i,this._i=this._line=this._col=this._newline=0,this._state=this._next=this._token=null,this._prev_char=""}return _createClass(e,[{key:"get",value:function(e){return this.__internal[e]}},{key:"set",value:function(e,t){this.__internal[e]=t}},{key:"token",value:function(){var e=arguments.length>0&&arguments[0]!==undefined$1&&arguments[0];if(e){var t=this._line;return this._whitespace&&"\n"===this._token&&--t,{token:this._token,col:this._col,offset:this._i,line:t}}return this._token}},{key:"peek",value:function(){var e=arguments.length>0&&arguments[0]!==undefined$1&&arguments[0];if(this._i>=this.__input__.length)return eof;if(this._token)return this.token(e);var t=this.next_token();return t?(this._token=this.__input__.substring(this._i,this._next),this.token(e)):eof}},{key:"skip",value:function(){null!==this._next&&(this._token=null,this._i=this._next)}},{key:"read_line",value:function(){var e=this.__input__.length;if(this._i>=e)return eof;for(var t=this._i;t<e;++t)if("\n"===this.__input__[t]){var r=this.__input__.substring(this._i,t);return this._i=t+1,++this._line,r}return this.read_rest()}},{key:"read_rest",value:function(){var e=this._i;return this._i=this.__input__.length,this.__input__.substring(e)}},{key:"read_string",value:function(e){var t=this.__input__.length;if(this._i>=t)return eof;if(e+this._i>=t)return this.read_rest();var r=this._i+e,n=this.__input__.substring(this._i,r),o=n.match(/\n/g);return o&&(this._line+=o.length),this._i=r,n}},{key:"peek_char",value:function(){return this._i>=this.__input__.length?eof:LCharacter(this.__input__[this._i])}},{key:"read_char",value:function(){var e=this.peek_char();return this.skip_char(),e}},{key:"skip_char",value:function(){this._i<this.__input__.length&&(++this._i,this._token=null)}},{key:"match_rule",value:function(e){var t=arguments.length>1&&arguments[1]!==undefined$1?arguments[1]:{},r=t.prev_char,n=t.char,o=t.next_char,i=_slicedToArray(e,4),a=i[0],u=i[1],c=i[2],s=i[3];if(5!==e.length)throw new Error("Lexer: Invald rule of length ".concat(e.length));return!!n.match(a)&&!!match_or_null(u,r)&&!!match_or_null(c,o)&&s===this._state}},{key:"next_token",value:function(){if(this._i>=this.__input__.length)return!1;var t=!0;e:for(var r=this._i,n=this.__input__.length;r<n;++r){var o=this.__input__[r],i=this.__input__[r-1]||"",a=this.__input__[r+1]||"";if("\n"===o){++this._line;var u=this._newline;if(null===this._state&&(this._newline=r+1),this._whitespace&&null===this._state)return this._next=r+1,this._col=this._i-u,!0}if(t&&null===this._state&&o.match(/\s/)){if(this._whitespace){if(a.match(/\s/))continue;return this._next=r+1,this._col=this._i-this._newline,!0}this._i=r+1}else{t=!1;var c,s=_createForOfIteratorHelper(e.rules);try{for(s.s();!(c=s.n()).done;){var l=c.value;if(this.match_rule(l,{prev_char:i,char:o,next_char:a})){var f=l[l.length-1];if(this._state=f,null===this._state)return this._next=r+1,this._col=this._i-this._newline,!0;continue e}}}catch(p){s.e(p)}finally{s.f()}if(null===this._state){var _=this.__input__.split("\n")[this._line];throw new Error("Invalid Syntax at line ".concat(this._line,"\n").concat(_))}}}}}]),e}();function match_or_null(e,t){return null===e||t.match(e)}Lexer.symbol_rule=function(e,t){return Lexer.literal_rule(e,t,Lexer.boundary,/\S/).concat([[/\S/,/\S/,Lexer.boundary,null,null],[/\S/,/\S/,null,null,Lexer.symbol],[/\S/,null,Lexer.boundary,Lexer.symbol,null]])},Lexer.literal_rule=function(e,t){var r=arguments.length>2&&arguments[2]!==undefined$1?arguments[2]:null,n=arguments.length>3&&arguments[3]!==undefined$1?arguments[3]:null;if(0===e.length)throw new Error("Lexer: invalid literal rule");if(1===e.length)return[[e,r,n,null,null]];for(var o=[],i=0,a=e.length;i<a;++i){var u=[];u.push(e[i]),u.push(e[i-1]||r),u.push(e[i+1]||n),0===i?(u.push(null),u.push(t)):i===a-1?(u.push(t),u.push(null)):(u.push(t),u.push(t)),o.push(u)}return o},Lexer.string=Symbol.for("string"),Lexer.symbol=Symbol.for("symbol"),Lexer.comment=Symbol.for("comment"),Lexer.regex=Symbol.for("regex"),Lexer.regex_class=Symbol.for("regex_class"),Lexer.character=Symbol.for("character"),Lexer.bracket=Symbol.for("bracket"),Lexer.b_symbol=Symbol.for("b_symbol"),Lexer.b_comment=Symbol.for("b_comment"),Lexer.i_comment=Symbol.for("i_comment"),Lexer.l_datum=Symbol.for("l_datum"),Lexer.boundary=/^$|[\s()[\]]/,Lexer._rules=[[/"/,/^$|[^\\]/,null,null,Lexer.string],[/"/,/^$|[^\\]/,null,Lexer.string,null],[/#/,null,/[bdxoeitf]/i,null,Lexer.symbol],[/#/,null,/\\/,null,Lexer.character],[/\\/,/#/,/\s/,Lexer.character,Lexer.character],[/\\/,/#/,/[()[\]]/,Lexer.character,Lexer.character],[/\s/,/\\/,null,Lexer.character,null],[/\S/,null,Lexer.boundary,Lexer.character,null],[/#/,Lexer.boundary,/\//,null,Lexer.regex],[/[ \t]/,null,null,Lexer.regex,Lexer.regex],[/\[/,null,null,Lexer.regex,Lexer.regex_class],[/\]/,/[^\\]/,null,Lexer.regex_class,Lexer.regex],[/[()[\]]/,null,null,Lexer.regex,Lexer.regex],[/\//,/\\/,null,Lexer.regex,Lexer.regex],[/\//,/[^#]/,Lexer.boundary,Lexer.regex,null],[/[gimyus]/,/\//,Lexer.boundary,Lexer.regex,null],[/[gimyus]/,/\//,/[gimyus]/,Lexer.regex,Lexer.regex],[/[gimyus]/,/[gimyus]/,Lexer.boundary,Lexer.regex,null],[/;/,/^$|[^#]/,null,null,Lexer.comment],[/[\s\S]/,null,/\n/,Lexer.comment,null],[/\s/,null,null,Lexer.comment,Lexer.comment],[/#/,null,/\|/,null,Lexer.b_comment],[/\s/,null,null,Lexer.b_comment,Lexer.b_comment],[/#/,/\|/,null,Lexer.b_comment,null],[/#/,null,/;/,null,Lexer.i_comment],[/;/,/#/,null,Lexer.i_comment,null],[/#/,null,/[0-9]/,null,Lexer.l_datum],[/=/,/[0-9]/,null,Lexer.l_datum,null],[/#/,/[0-9]/,null,Lexer.l_datum,null],[/\|/,null,null,null,Lexer.b_symbol],[/\s/,null,null,Lexer.b_symbol,Lexer.b_symbol],[/\|/,null,Lexer.boundary,Lexer.b_symbol,null]],Lexer._brackets=[[/[()[\]]/,null,null,null,null]],Lexer._symbol_rules=[[/\S/,Lexer.boundary,Lexer.boundary,null,null],[/\S/,Lexer.boundary,null,null,Lexer.symbol],[/\S/,null,Lexer.boundary,null,null],[/\S/,null,null,null,Lexer.symbol],[/\S/,null,Lexer.boundary,Lexer.symbol,null]],Lexer._cache={valid:!1,rules:null},specials.on(["remove","append"],(function(){Lexer._cache.valid=!1,Lexer._cache.rules=null})),Object.defineProperty(Lexer,"rules",{get:function(){if(Lexer._cache.valid)return Lexer._cache.rules;var e=specials.names().sort((function(e,t){return t.length-e.length||e.localeCompare(t)})).reduce((function(e,t){var r,n,o=specials.get(t),i=o.type,a=o.symbol;return n="#"===t[0]?1===t.length?Symbol.for(t):Symbol.for(t[1]):a,r=i===specials.SYMBOL?Lexer.symbol_rule(t,n):Lexer.literal_rule(t,n),e.concat(r)}),[]);return Lexer._cache.rules=Lexer._rules.concat(Lexer._brackets,e,Lexer._symbol_rules),Lexer._cache.valid=!0,Lexer._cache.rules}});var Parser=function(){function e(t){var r=arguments.length>1&&arguments[1]!==undefined$1?arguments[1]:{},n=r.env,o=r.meta,i=void 0!==o&&o,a=r.formatter,u=void 0===a?multiline_formatter:a;_classCallCheck(this,e),t instanceof LString&&(t=t.toString()),read_only(this,"_formatter",u,{hidden:!0}),read_only(this,"__lexer__",new Lexer(t)),read_only(this,"__env__",n),read_only(this,"_meta",i,{hidden:!0}),read_only(this,"_refs",[],{hidden:!0})}return _createClass(e,[{key:"resolve",value:function(e){return this.__env__&&this.__env__.get(e,{throwError:!1})}},{key:"peek",value:function(){var e=_asyncToGenerator(regenerator.mark((function e(){var t;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=this.__lexer__.peek(!0))!==eof){e.next=4;break}return e.abrupt("return",eof);case 4:if(!this.is_comment(t.token)){e.next=7;break}return this.skip(),e.abrupt("continue",0);case 7:if("#;"!==t.token){e.next=14;break}if(this.skip(),this.__lexer__.peek()!==eof){e.next=11;break}throw new Error("Lexer: syntax error eof found after comment");case 11:return e.next=13,this._read_object();case 13:return e.abrupt("continue",0);case 14:return e.abrupt("break",17);case 17:if(t=this._formatter(t),!this._meta){e.next=20;break}return e.abrupt("return",t);case 20:return e.abrupt("return",t.token);case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"reset",value:function(){this._refs.length=0}},{key:"skip",value:function(){this.__lexer__.skip()}},{key:"is_special",value:function(e){return specials.names().includes(e)}},{key:"is_builtin",value:function(e){return specials.builtin.includes(e)}},{key:"read",value:function(){var e=_asyncToGenerator(regenerator.mark((function e(){var t;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.peek();case 2:return t=e.sent,this.skip(),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"match_datum_label",value:function(e){var t=e.match(/^#([0-9]+)=$/);return t&&t[1]}},{key:"match_datum_ref",value:function(e){var t=e.match(/^#([0-9]+)#$/);return t&&t[1]}},{key:"is_open",value:function(e){return["(","["].includes(e)}},{key:"is_close",value:function(e){return[")","]"].includes(e)}},{key:"read_list",value:function(){var e=_asyncToGenerator(regenerator.mark((function e(){var t,r,n,o;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t=_nil;case 1:return e.next=4,this.peek();case 4:if((n=e.sent)!==eof){e.next=7;break}return e.abrupt("break",27);case 7:if(!this.is_close(n)){e.next=10;break}return this.skip(),e.abrupt("break",27);case 10:if("."!==n||t===_nil){e.next=17;break}return this.skip(),e.next=14,this._read_object();case 14:r.cdr=e.sent,e.next=25;break;case 17:return e.t0=Pair,e.next=20,this._read_object();case 20:e.t1=e.sent,e.t2=_nil,o=new e.t0(e.t1,e.t2),t===_nil?t=o:r.cdr=o,r=o;case 25:e.next=1;break;case 27:return e.abrupt("return",t);case 28:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"read_value",value:function(){var e=_asyncToGenerator(regenerator.mark((function e(){var t;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.read();case 2:if((t=e.sent)!==eof){e.next=5;break}throw new Error("Parser: Expected token eof found");case 5:return e.abrupt("return",parse_argument(t));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"is_comment",value:function(e){return e.match(/^;/)||e.match(/^#\|/)&&e.match(/\|#$/)}},{key:"evaluate",value:function(e){return _evaluate(e,{env:this.__env__,error:function(e){throw e}})}},{key:"read_object",value:function(){var e=_asyncToGenerator(regenerator.mark((function e(){var t;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.reset(),e.next=3,this._read_object();case 3:if((t=e.sent)instanceof DatumReference&&(t=t.valueOf()),!this._refs.length){e.next=7;break}return e.abrupt("return",this._resolve_object(t));case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_resolve_object",value:function(){var e=_asyncToGenerator(regenerator.mark((function e(t){var r,n=this;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Array.isArray(t)){e.next=2;break}return e.abrupt("return",t.map((function(e){return n._resolve_object(e)})));case 2:if(!is_plain_object(t)){e.next=6;break}return r={},Object.keys(t).forEach((function(e){r[e]=n._resolve_object(t[e])})),e.abrupt("return",r);case 6:if(!(t instanceof Pair)){e.next=8;break}return e.abrupt("return",this._resolve_pair(t));case 8:return e.abrupt("return",t);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_resolve_pair",value:function(){var e=_asyncToGenerator(regenerator.mark((function e(t){return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t instanceof Pair)){e.next=15;break}if(!(t.car instanceof DatumReference)){e.next=7;break}return e.next=4,t.car.valueOf();case 4:t.car=e.sent,e.next=8;break;case 7:this._resolve_pair(t.car);case 8:if(!(t.cdr instanceof DatumReference)){e.next=14;break}return e.next=11,t.cdr.valueOf();case 11:t.cdr=e.sent,e.next=15;break;case 14:this._resolve_pair(t.cdr);case 15:return e.abrupt("return",t);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_read_object",value:function(){var e=_asyncToGenerator(regenerator.mark((function e(){var t,r,n,o,i,a,u,c,s;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.peek();case 2:if((t=e.sent)!==eof){e.next=5;break}return e.abrupt("return",t);case 5:if(!this.is_special(t)){e.next=35;break}return r=specials.get(t),n=this.is_builtin(t),this.skip(),e.next=11,this._read_object();case 11:if(i=e.sent,n){e.next=22;break}if("function"!==typeof(a=this.__env__.get(r.symbol))){e.next=22;break}if(!is_literal(t)){e.next=19;break}return e.abrupt("return",a.call(this.__env__,i));case 19:if(!(i instanceof Pair)){e.next=21;break}return e.abrupt("return",a.apply(this.__env__,i.to_array(!1)));case 21:throw new Error("Parse Error: Invalid parser extension "+"invocation ".concat(r.symbol));case 22:if(o=is_literal(t)?new Pair(r.symbol,new Pair(i,_nil)):new Pair(r.symbol,i),!n){e.next=25;break}return e.abrupt("return",o);case 25:if(!(a instanceof Macro)){e.next=34;break}return e.next=28,this.evaluate(o);case 28:if(!((u=e.sent)instanceof Pair||u instanceof LSymbol)){e.next=31;break}return e.abrupt("return",Pair.fromArray([LSymbol("quote"),u]));case 31:return e.abrupt("return",u);case 34:throw new Error("Parse Error: invlid parser extension: "+r.symbol);case 35:if(null===(c=this.match_datum_ref(t))){e.next=41;break}if(this.skip(),!this._refs[c]){e.next=40;break}return e.abrupt("return",new DatumReference(c,this._refs[c]));case 40:throw new Error("Parse Error: invalid datum label #".concat(c,"#"));case 41:if(null===(s=this.match_datum_label(t))){e.next=48;break}return this.skip(),this._refs[s]=this._read_object(),e.abrupt("return",this._refs[s]);case 48:if(!this.is_open(t)){e.next=53;break}return this.skip(),e.abrupt("return",this.read_list());case 53:return e.abrupt("return",this.read_value());case 54:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),DatumReference=function(){function e(t,r){_classCallCheck(this,e),this.name=t,this.data=r}return _createClass(e,[{key:"valueOf",value:function(){return this.data}}]),e}();function parse(e,t){return _parse.apply(this,arguments)}function _parse(){return(_parse=_wrapAsyncGenerator(regenerator.mark((function e(t,r){var n,o;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r||(r=global_env?global_env.get("**interaction-environment**",{throwError:!1}):user_env),n=new Parser(t,{env:r});case 2:return e.next=5,_awaitAsyncGenerator(n.read_object());case 5:if((o=e.sent)!==eof){e.next=8;break}return e.abrupt("break",12);case 8:return e.next=10,o;case 10:e.next=2;break;case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function unpromise(e){var t=arguments.length>1&&arguments[1]!==undefined$1?arguments[1]:function(e){return e},r=arguments.length>2&&arguments[2]!==undefined$1?arguments[2]:null;if(is_promise(e)){var n=e.then(t);return null===r?n:n.catch(r)}return e instanceof Array?unpromise_array(e,t,r):is_plain_object(e)?unpromise_object(e,t,r):t(e)}function unpromise_array(e,t,r){return e.find(is_promise)?unpromise(promise_all(e),(function(t){return Object.isFrozen(e)&&Object.freeze(t),t}),r):t(e)}function unpromise_object(e,t,r){for(var n=Object.keys(e),o=[],i=[],a=n.length;a--;){var u=n[a],c=e[u];o[a]=c,is_promise(c)&&i.push(c)}return i.length?unpromise(promise_all(o),(function(t){var r={};return t.forEach((function(e,t){var o=n[t];r[o]=e})),Object.isFrozen(e)&&Object.freeze(r),r}),r):t(e)}function read_only(e,t,r){var n=arguments.length>3&&arguments[3]!==undefined$1?arguments[3]:{},o=n.hidden,i=void 0!==o&&o;Object.defineProperty(e,t,{value:r,configurable:!0,enumerable:!i})}function uniterate_async(e){return _uniterate_async.apply(this,arguments)}function _uniterate_async(){return(_uniterate_async=_asyncToGenerator(regenerator.mark((function e(t){var r,n,o,i,a,u,c,s;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],n=!0,o=!1,e.prev=3,a=_asyncIterator(t);case 5:return e.next=7,a.next();case 7:return u=e.sent,n=u.done,e.next=11,u.value;case 11:if(c=e.sent,n){e.next=18;break}s=c,r.push(s);case 15:n=!0,e.next=5;break;case 18:e.next=24;break;case 20:e.prev=20,e.t0=e.catch(3),o=!0,i=e.t0;case 24:if(e.prev=24,e.prev=25,n||null==a.return){e.next=29;break}return e.next=29,a.return();case 29:if(e.prev=29,!o){e.next=32;break}throw i;case 32:return e.finish(29);case 33:return e.finish(24);case 34:return e.abrupt("return",r);case 35:case"end":return e.stop()}}),e,null,[[3,20,24,34],[25,,29,33]])})))).apply(this,arguments)}function matcher(e,t){if(t instanceof RegExp)return function(e){return String(e).match(t)};if(is_function(t))return t;throw new Error("Invalid matcher")}function doc(e,t,r,n){return"string"!==typeof e&&(t=arguments[0],r=arguments[1],n=arguments[2],e=null),r&&(t.__doc__=n?r:trim_lines(r)),e?t.__name__=e:t.name&&!is_lambda(t)&&(t.__name__=t.name),t}function trim_lines(e){return e.split("\n").map((function(e){return e.trim()})).join("\n")}function previousSexp(e){var t=arguments.length>1&&arguments[1]!==undefined$1?arguments[1]:1,r=e.length;if(t<=0)throw Error("previousSexp: Invalid argument sexp = ".concat(t));e:for(;t--&&r>=0;){for(var n=1;n>0;){var o=e[--r];if(!o)break e;"("===o||"("===o.token?n--:")"!==o&&")"!==o.token||n++}r--}return e.slice(r+1)}function lineIndent(e){if(!e||!e.length)return 0;var t=e.length;if("\n"===e[t-1].token)return 0;for(;--t;)if("\n"===e[t].token){var r=(e[t+1]||{}).token;if(r)return r.length}return 0}function match(e,t){return function e(t,r){function n(t,r){var n,o=_createForOfIteratorHelper(t);try{for(o.s();!(n=o.n()).done;){var i=n.value,a=e(i,r);if(-1!==a)return a}}catch(u){o.e(u)}finally{o.f()}return-1}function o(){var n=t[i+1],o=r[u+1];if(n!==undefined$1&&o!==undefined$1)return e([n],[o])}for(var i=0,a={},u=0;u<r.length;++u){if("undefined"===typeof t[i])return u;if(t[i]instanceof Pattern){var c;if(["+","*"].includes(t[i].flag)){for(;u<r.length&&-1!==(c=n(t[i].patterns,r.slice(u)));)u+=c;u-=1,i++;continue}if("?"===t[i].flag){-1===(c=n(t[i].patterns,r.slice(u)))?u-=2:i++;continue}}else if(t[i]instanceof RegExp){if(!r[u].match(t[i]))return-1}else if(lips.LString.isString(t[i])){if(t[i].valueOf()!==r[u])return-1}else{if("symbol"!==_typeof(t[i])){if(t[i]instanceof Array){var s=e(t[i],r.slice(u));if(-1===s||s+u>r.length)return-1;u+=s-1,i++;continue}return-1}if(t[i]===Symbol.for("*")){if(a[i]=a[i]||0,["(","["].includes(r[u])?a[i]++:[")","]"].includes(r[u])&&a[i]--,"undefined"!==typeof t[i+1]&&0===a[i]&&-1===o()||a[i]>0)continue}else if(t[i]===Symbol.for("symbol")&&!is_symbol_string(r[u]))return-1}i++}return t.length!==i?-1:r.length}(e,t)===t.length}function Formatter(e){this.__code__=e.replace(/\r/g,"")}function Ahead(e){this.pattern=e}function Pattern(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t.pop();this.patterns=t,this.flag=n}Formatter.defaults={offset:0,indent:2,exceptions:{specials:[/^(?:#:)?(?:define(?:-values|-syntax|-macro|-class|-record-type)?|(?:call-with-(?:input-file|output-file|port))|lambda|let-env|try|catch|when|unless|while|syntax-rules|(let|letrec)(-syntax|\*)?)$/],shift:{1:["&","#"]}}},Formatter.match=match,Formatter.prototype._options=function(e){var t=Formatter.defaults;if("undefined"===typeof e)return Object.assign({},t);var r=e&&e.exceptions||{},n=r.specials||[],o=r.shift||{1:[]};return _objectSpread(_objectSpread(_objectSpread({},t),e),{},{exceptions:{specials:[].concat(_toConsumableArray(t.exceptions.specials),_toConsumableArray(n)),shift:_objectSpread(_objectSpread({},o),{},{1:[].concat(_toConsumableArray(t.exceptions.shift[1]),_toConsumableArray(o[1]))})}})},Formatter.prototype.indent=function(e){var t=tokenize(this.__code__,!0);return this._indent(t,e)},Formatter.exception_shift=function(e,t){function r(t){if(!t.length)return!1;if(-1!==t.indexOf(e))return!0;var r=t.filter((function(e){return e instanceof RegExp}));if(!r.length)return!1;var n,o=_createForOfIteratorHelper(r);try{for(o.s();!(n=o.n()).done;){var i=n.value;if(e.match(i))return!0}}catch(a){o.e(a)}finally{o.f()}return!1}if(r(t.exceptions.specials))return t.indent;for(var n=t.exceptions.shift,o=0,i=Object.entries(n);o<i.length;o++){var a=_slicedToArray(i[o],2),u=a[0];if(r(a[1]))return+u}return-1},Formatter.prototype._indent=function(e,t){var r=this._options(t),n=lineIndent(e),o=previousSexp(e),i=e[e.length-o.length-1];if(e[e.length-1].token.match(/^"[\S\s]+[^"]$/))return n+r.indent;if(!o||!o.length)return 0;if(o[0].line>0&&(r.offset=0),o.toString()===e.toString()&&balanced(o))return r.offset+o[0].col;if(1===o.length)return r.offset+o[0].col+1;var a=-1;if(i){var u=Formatter.exception_shift(i.token,r);-1!==u&&(a=u)}if(-1===a&&(a=Formatter.exception_shift(o[1].token,r)),-1!==a)return r.offset+o[0].col+a;if(o[0].line<o[1].line)return r.offset+o[0].col+1;if(o.length>3&&o[1].line===o[3].line)return"("===o[1].token||"["===o[1].token?r.offset+o[1].col:r.offset+o[3].col;if(o[0].line===o[1].line)return r.offset+r.indent+o[0].col;for(var c=o.slice(2),s=0;s<c.length;++s){var l=c[s];if(l.token.trim())return l.col}return n+r.indent},Ahead.prototype.toString=function(){return"#<pattern(".concat(this.pattern,")>")},Ahead.prototype.match=function(e){return e.match(this.pattern)},Pattern.prototype.toString=function(){var e=this.patterns.map((function(e){return toString(e)})).join("|");return"#<pattern(".concat(e," ").concat(this.flag,")>")},Formatter.Pattern=Pattern,Formatter.Ahead=Ahead;var p_o=/^[[(]$/,p_e=/^[\])]$/,not_p=/[^()[\]]/,not_close=new Ahead(/[^)\]]/),glob=Symbol.for("*"),sexp_or_atom=new Pattern([p_o,glob,p_e],[not_p],"+"),sexp=new Pattern([p_o,glob,p_e],"+"),symbol=new Pattern([Symbol.for("symbol")],"?"),symbols=new Pattern([Symbol.for("symbol")],"*"),identifiers=[p_o,symbols,p_e],let_value=new Pattern([p_o,Symbol.for("symbol"),glob,p_e],"+"),def_lambda_re=keywords_re("define","lambda","define-macro","syntax-rules"),non_def=/^(?!.*\b(?:[()[\]]|define(?:-macro)?|let(?:\*|rec|-env|-syntax|)?|lambda|syntax-rules)\b).*$/,let_re=/^(?:#:)?(let(?:\*|rec|-env|-syntax)?)$/;function keywords_re(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new RegExp("^(?:#:)?(?:".concat(t.join("|"),")$"))}function flatten(e,t){var r,n=Object.prototype.toString,o=[],i=t&&e||e.slice();if(!e.length)return o;r=i.pop();do{"[object Array]"===n.call(r)?i.push.apply(i,r):o.push(r)}while(i.length&&(r=i.pop())!==undefined$1);return o.reverse(),o}function Nil(){}Formatter.rules=[[[sexp],0,not_close],[[p_o,keywords_re("begin","cond-expand")],1],[[p_o,let_re,symbol,p_o,let_value,p_e],1],[[p_o,let_re,symbol,sexp,sexp_or_atom],0,not_close],[[p_o,keywords_re("define-syntax"),/.+/],1],[[p_o,non_def,new Pattern([/[^()[\]]/],"+"),sexp],1,not_close],[[p_o,sexp],1,not_close],[[p_o,not_p,sexp],1,not_close],[[p_o,keywords_re("lambda","if"),not_p],1,not_close],[[p_o,keywords_re("while"),not_p,sexp],1,not_close],[[p_o,keywords_re("if"),not_p,glob],1],[[p_o,def_lambda_re,identifiers],1,not_close],[[p_o,def_lambda_re,identifiers,string_re],1,not_close],[[p_o,def_lambda_re,identifiers,string_re,sexp],1,not_close],[[p_o,def_lambda_re,identifiers,sexp],1,not_close]],Formatter.prototype.break=function(){for(var e=tokenize(this.__code__.replace(/\n[ \t]*/g,"\n "),!0).map((function(e){return e.token.match(string_re)||e.token.match(re_re)?e.token:e.token.replace(/\s+/," ")})).filter((function(e){return"\n"!==e})),t=Formatter.rules,r=1;r<e.length;++r)if(e[r].trim()){var n=e.slice(0,r),o={};t.map((function(e){return e[1]})).forEach((function(e){(e=e.valueOf())>0&&!o[e]&&(o[e]=previousSexp(n,e))}));var i,a=_createForOfIteratorHelper(t);try{for(a.s();!(i=a.n()).done;){var u=_slicedToArray(i.value,3),c=u[0],s=u[1],l=u[2],f=match(c,((s=s.valueOf())>0?o[s]:n).filter((function(e){return e.trim()}))),_=e.slice(r).find((function(e){return e.trim()}));f&&(l instanceof Ahead&&l.match(_)||!l)&&(e[r-1].trim()?(e.splice(r,0,"\n"),r++):e[r-1]="\n")}}catch(p){a.e(p)}finally{a.f()}}return this.__code__=e.join(""),this},Formatter.prototype._spaces=function(e){return new Array(e+1).join(" ")},Formatter.prototype.format=function(e){for(var t=tokenize(this.__code__.replace(/[ \t]*\n[ \t]*/g,"\n "),!0),r=this._options(e),n=0,o=0,i=0;i<t.length;++i)if("\n"===t[i].token&&(o+=n=this._indent(t.slice(0,i),r),t[i+1])){t[i+1].token=this._spaces(n),n--,o--;for(var a=i+2;a<t.length;++a)if(t[a].offset+=o,t[a].col+=n,"\n"===t[a].token){i=a-1;break}}return t.map((function(e){if(e.token.match(string_re)&&e.token.match(/\n/)){var t=new Array(e.col+1).join(" "),r=e.token.split("\n");e.token=[r[0]].concat(r.slice(1).map((function(e){return t+e}))).join("\n")}return e.token})).join("")},Nil.prototype.toString=function(){return"()"},Nil.prototype.valueOf=function(){return undefined$1},Nil.prototype.serialize=function(){return 0},Nil.prototype.to_object=function(){return{}},Nil.prototype.append=function(e){return new Pair(e,_nil)},Nil.prototype.to_array=function(){return[]};var _nil=new Nil;function Pair(e,t){if("undefined"!==typeof this&&this.constructor!==Pair||"undefined"===typeof this)return new Pair(e,t);this.car=e,this.cdr=t}function to_array(e,t){return function(r){if(typecheck(e,r,["pair","nil"]),r===_nil)return[];for(var n=[],o=r;;){if(!(o instanceof Pair)){if(o===_nil)break;throw new Error("".concat(e,": can't convert improper list"))}if(o.haveCycles("cdr"))break;var i=o.car;t&&i instanceof Pair&&(i=this.get(e).call(this,i)),n.push(i),o=o.cdr}return n}}Pair.prototype.flatten=function(){return Pair.fromArray(flatten(this.to_array()))},Pair.prototype.length=function(){for(var e=0,t=this;t&&t!==_nil&&t instanceof Pair&&!t.haveCycles("cdr");)e++,t=t.cdr;return e},Pair.match=function(e,t){return e instanceof LSymbol?LSymbol.is(e,t):e instanceof Pair?Pair.match(e.car,t)||Pair.match(e.cdr,t):Array.isArray(e)?e.some((function(e){return Pair.match(e,t)})):!!is_plain_object(e)&&Object.values(e).some((function(e){return Pair.match(e,t)}))},Pair.prototype.find=function(e){return Pair.match(this,e)},Pair.prototype.clone=function(){var e=!(arguments.length>0&&arguments[0]!==undefined$1)||arguments[0],t=new Map;function r(n){if(n instanceof Pair){if(t.has(n))return t.get(n);var o=new Pair;return t.set(n,o),o.car=e?r(n.car):n.car,o.cdr=r(n.cdr),o[__cycles__]=n[__cycles__],o}return n}return r(this)},Pair.prototype.last_pair=function(){for(var e=this;;){if(e.cdr===_nil)return e;e=e.cdr}},Pair.prototype.to_array=function(){var e=!(arguments.length>0&&arguments[0]!==undefined$1)||arguments[0],t=[];return this.car instanceof Pair?e?t.push(this.car.to_array()):t.push(this.car):t.push(this.car.valueOf()),this.cdr instanceof Pair&&(t=t.concat(this.cdr.to_array())),t},Pair.fromArray=function(e){var t=!(arguments.length>1&&arguments[1]!==undefined$1)||arguments[1],r=arguments.length>2&&arguments[2]!==undefined$1&&arguments[2];if(e instanceof Pair||r&&e instanceof Array&&e[__data__])return e;if(!1===t){for(var n=_nil,o=e.length;o--;)n=new Pair(e[o],n);return n}!e.length||e instanceof Array||(e=_toConsumableArray(e));for(var i=_nil,a=e.length;a--;){var u=e[a];u instanceof Array?u=Pair.fromArray(u,t,r):"string"===typeof u?u=LString(u):"number"!==typeof u||Number.isNaN(u)||(u=LNumber(u)),i=new Pair(u,i)}return i},Pair.prototype.to_object=function(){for(var e=arguments.length>0&&arguments[0]!==undefined$1&&arguments[0],t=this,r={};t instanceof Pair&&t.car instanceof Pair;){var n=t.car,o=n.car;o instanceof LSymbol&&(o=o.__name__),o instanceof LString&&(o=o.valueOf());var i=n.cdr;i instanceof Pair&&(i=i.to_object(e)),is_native(i)&&(e||(i=i.valueOf())),r[o]=i,t=t.cdr}return r},Pair.fromPairs=function(e){return e.reduce((function(e,t){return new Pair(new Pair(new LSymbol(t[0]),t[1]),e)}),_nil)},Pair.fromObject=function(e){var t=Object.keys(e).map((function(t){return[t,e[t]]}));return Pair.fromPairs(t)},Pair.prototype.reduce=function(e){for(var t=this,r=_nil;t!==_nil;)r=e(r,t.car),t=t.cdr;return r},Pair.prototype.reverse=function(){if(this.haveCycles())throw new Error("You can't reverse list that have cycles");for(var e=this,t=_nil;e!==_nil;){var r=e.cdr;e.cdr=t,t=e,e=r}return t},Pair.prototype.transform=function(e){return function t(r){if(r instanceof Pair){if(r.replace)return delete r.replace,r;var n=e(r.car);n instanceof Pair&&(n=t(n));var o=e(r.cdr);return o instanceof Pair&&(o=t(o)),new Pair(n,o)}return r}(this)},Pair.prototype.map=function(e){return"undefined"!==typeof this.car?new Pair(e(this.car),this.cdr===_nil?_nil:this.cdr.map(e)):_nil};var repr=new Map;function is_plain_object(e){return e&&"object"===_typeof(e)&&e.constructor===Object}var props=Object.getOwnPropertyNames(Array.prototype),array_methods=[];function is_array_method(e){return e=unbind(e),array_methods.includes(e)}function is_lips_function(e){return is_function(e)&&(is_lambda(e)||e.__doc__)}function user_repr(e){var t,r=e.constructor||Object,n=is_plain_object(e),o=is_function(e[Symbol.asyncIterator])||is_function(e[Symbol.iterator]);return repr.has(r)?t=repr.get(r):repr.forEach((function(r,i){i=unbind(i),e.constructor===i&&(i===Object&&n&&!o||i!==Object)&&(t=r)})),t}props.forEach((function(e){array_methods.push(Array[e],Array.prototype[e])}));var str_mapping=new Map;function symbolize(e){if(e&&"object"===_typeof(e)){var t={};return Object.getOwnPropertySymbols(e).forEach((function(r){var n=r.toString().replace(/Symbol\(([^)]+)\)/,"$1");t[n]=toString(e[r])})),Object.getOwnPropertyNames(e).forEach((function(r){var n=e[r];n&&"object"===_typeof(n)&&n.constructor===Object?t[r]=symbolize(n):t[r]=toString(n)})),t}return e}function get_props(e){return Object.keys(e).concat(Object.getOwnPropertySymbols(e))}function has_own_function(e,t){return e.hasOwnProperty(t)&&is_function(e.toString)}function function_to_string(e){if(is_native_function(e))return"#<procedure(native)>";var t=e.prototype&&e.prototype.constructor;if(is_function(t)&&is_lambda(t)&&e[__class__]&&t.hasOwnProperty("__name__")){var r=t.__name__;return LString.isString(r)?(r=r.toString(),"#<class:".concat(r,">")):"#<class>"}if(e.hasOwnProperty("__name__")){var n=e.__name__;if("symbol"===_typeof(n)&&(n=symbol_to_string(n)),"string"===typeof n)return"#<procedure:".concat(n,">")}return has_own_function(e,"toString")?e.toString():e.name&&!is_lambda(e)?"#<procedure:".concat(e.name.trim(),">"):"#<procedure>"}[[!0,"#t"],[!1,"#f"],[null,"null"],[undefined$1,"#<undefined>"]].forEach((function(e){var t=_slicedToArray(e,2),r=t[0],n=t[1];str_mapping.set(r,n)}));var instances=new Map;[[Error,function(e){return e.message}],[Pair,function(e,t){var r=t.quote,n=t.skip_cycles,o=t.pair_args;return n||e.markCycles(),e.toString.apply(e,[r].concat(_toConsumableArray(o)))}],[LCharacter,function(e,t){return t.quote?e.toString():e.valueOf()}],[LString,function(e,t){var r=t.quote;return e=e.toString(),r?JSON.stringify(e).replace(/\\n/g,"\n"):e}],[RegExp,function(e){return"#"+e.toString()}]].forEach((function(e){var t=_slicedToArray(e,2),r=t[0],n=t[1];instances.set(r,n)}));var native_types=[LSymbol,LNumber,Macro,Values,InputPort,OutputPort,Environment,QuotedPromise];function toString(e,t,r){if("undefined"!==typeof jQuery&&e instanceof jQuery.fn.init)return"#<jQuery("+e.length+")>";if(str_mapping.has(e))return str_mapping.get(e);if(e){var n=e.constructor;if(instances.has(n)){for(var o=arguments.length,i=new Array(o>3?o-3:0),a=3;a<o;a++)i[a-3]=arguments[a];return instances.get(n)(e,{quote:t,skip_cycles:r,pair_args:i})}}var u,c=_createForOfIteratorHelper(native_types);try{for(c.s();!(u=c.n()).done;){var s=u.value;if(e instanceof s)return e.toString(t)}}catch(p){c.e(p)}finally{c.f()}if([_nil,eof].includes(e))return e.toString();if(is_function(e))return function_to_string(e);if(e===root)return"#<js:global>";if(null===e)return"null";if("object"===_typeof(e)){var l,f=e.constructor;if(f||(f=Object),"string"===typeof f.__class__)l=f.__class__;else{if(is_prototype(e))return"#<prototype>";var _=user_repr(e);if(_){if(is_function(_))return _(e,t);throw new Error("toString: Invalid repr value")}l=f.name}return is_function(e.toString)&&is_lambda(e.toString)?e.toString().valueOf():("instance"===type(e)&&(is_lambda(f)&&f.__name__?l=f.__name__.valueOf():is_native_function(f)||(l="instance")),is_iterator(e,Symbol.iterator)?l?"#<iterator(".concat(l,")>"):"#<iterator>":is_iterator(e,Symbol.asyncIterator)?l?"#<asyncIterator(".concat(l,")>"):"#<asyncIterator>":""!==l?"#<"+l+">":"#<Object>")}return"string"!==typeof e?e.toString():e}function is_prototype(e){return e&&"object"===_typeof(e)&&e.hasOwnProperty&&e.hasOwnProperty("constructor")&&"function"===typeof e.constructor&&e.constructor.prototype===e}function markCycles(e){var t=[],r=[],n=[];function o(e,t,o,i){if(o instanceof Pair&&i.includes(o))return n.includes(o)||n.push(o),e[__cycles__]||(e[__cycles__]={}),e[__cycles__][t]=o,r.includes(e)||r.push(e),!0}var i=trampoline((function e(r,n){if(r instanceof Pair){delete r.ref,delete r[__cycles__],function(e){t.includes(e)||t.push(e)}(r),n.push(r);var a=o(r,"car",r.car,n),u=o(r,"cdr",r.cdr,n);if(a||i(r.car,n.slice()),!u)return new Thunk((function(){return e(r.cdr,n.slice())}))}}));function a(e,t){if(e[__cycles__][t]instanceof Pair){var r=u.indexOf(e[__cycles__][t]);e[__cycles__][t]="#".concat(r,"#")}}i(e,[]);var u=t.filter((function(e){return n.includes(e)}));u.forEach((function(e,t){e[__ref__]="#".concat(t,"=")})),r.forEach((function(e){a(e,"car"),a(e,"cdr")}))}function abs(e){return e<0?-e:e}function seq_compare(e,t){for(var r=_toArray(t),n=r[0],o=r.slice(1);o.length>0;){if(!e(n,_slicedToArray(o,1)[0]))return!1;var i=_toArray(o);n=i[0],o=i.slice(1)}return!0}function equal(e,t){return is_function(e)?is_function(t)&&unbind(e)===unbind(t):e instanceof LNumber?t instanceof LNumber&&e.__type__===t.__type__&&("complex"!==e.__type__||e.__im__.__type__===t.__im__.__type__&&e.__re__.__type__===t.__re__.__type__)&&0===e.cmp(t)&&(0!==e.valueOf()||Object.is(e.valueOf(),t.valueOf())):"number"===typeof e?"number"===typeof t&&(Number.isNaN(e)?Number.isNaN(t):e===Number.NEGATIVE_INFINITY?t===Number.NEGATIVE_INFINITY:e===Number.POSITIVE_INFINITY?t===Number.POSITIVE_INFINITY:equal(LNumber(e),LNumber(t))):e instanceof LCharacter?t instanceof LCharacter&&e.__char__===t.__char__:e===t}function same_atom(e,t){return type(e)===type(t)&&!!is_atom(e)&&(e instanceof RegExp?e.source===t.source:e instanceof LString?e.valueOf()===t.valueOf():equal(e,t))}function is_atom(e){return e instanceof LSymbol||LString.isString(e)||e===_nil||null===e||e instanceof LCharacter||e instanceof LNumber||!0===e||!1===e}Pair.prototype.markCycles=function(){return markCycles(this),this},Pair.prototype.haveCycles=function(){var e=arguments.length>0&&arguments[0]!==undefined$1?arguments[0]:null;return e?!(!this[__cycles__]||!this[__cycles__][e]):this.haveCycles("car")||this.haveCycles("cdr")},Pair.prototype.toString=function(e){var t,r=arguments.length>1&&arguments[1]!==undefined$1?arguments[1]:{},n=r.nested,o=void 0!==n&&n,i=[];if(this[__ref__]?i.push(this[__ref__]+"("):o||i.push("("),(t=this[__cycles__]&&this[__cycles__].car?this[__cycles__].car:toString(this.car,e,!0))!==undefined$1&&i.push(t),this.cdr instanceof Pair)if(this[__cycles__]&&this[__cycles__].cdr)i.push(" . "),i.push(this[__cycles__].cdr);else{this.cdr[__ref__]?i.push(" . "):i.push(" ");var a=this.cdr.toString(e,{nested:!0});i.push(a)}else this.cdr!==_nil&&(i=i.concat([" . ",toString(this.cdr,e,!0)]));return o&&!this[__ref__]||i.push(")"),i.join("")},Pair.prototype.set=function(e,t){this[e]=t,t instanceof Pair&&this.markCycles()},Pair.prototype.append=function(e){if(e instanceof Array)return this.append(Pair.fromArray(e));var t=this;if(t.car===undefined$1)e instanceof Pair?(this.car=e.car,this.cdr=e.cdr):this.car=e;else if(e!==_nil){for(;t instanceof Pair&&t.cdr!==_nil;)t=t.cdr;t.cdr=e}return this},Pair.prototype.serialize=function(){return[this.car,this.cdr]};var truncate=Math.trunc?Math.trunc:function(e){return 0===e?0:e<0?Math.ceil(e):Math.floor(e)};function Macro(e,t,r,n){if("undefined"!==typeof this&&this.constructor!==Macro||"undefined"===typeof this)return new Macro(e,t);typecheck("Macro",e,"string",1),typecheck("Macro",t,"function",2),r&&(this.__doc__=n?r:trim_lines(r)),this.__name__=e,this.__fn__=t}Macro.defmacro=function(e,t,r,n){var o=new Macro(e,t,r,n);return o.__defmacro__=!0,o},Macro.prototype.invoke=function(e,t,r){var n=t.env,o={dynamic_scope:t.dynamic_scope,error:t.error,macro_expand:r};return this.__fn__.call(n,e,o,this.__name__)},Macro.prototype.toString=function(){return"#<macro:".concat(this.__name__,">")};var macro="define-macro",recur_guard=-1e4;function macro_expand(e){return function(){var t=_asyncToGenerator(regenerator.mark((function t(r,n){var o,i,a,u,c,s,l,f,_,p,d,m,h,y,v;return regenerator.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(v=function(){return(v=_asyncToGenerator(regenerator.mark((function e(t,r,o){var a,u,c,h,v,b,g,w,x,D,L,C;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t instanceof Pair&&t.car instanceof LSymbol)){e.next=50;break}if(!t[__data__]){e.next=3;break}return e.abrupt("return",t);case 3:if(a=t.car.valueOf(),u=o.get(t.car,{throwError:!1}),!(((c=s(t.car))||l(u,t)||f(u))&&t.cdr.car instanceof Pair)){e.next=28;break}if(!c){e.next=15;break}return i=p(t.cdr.car),e.next=12,m(t.cdr.car,r);case 12:h=e.sent,e.next=17;break;case 15:i=_(t.cdr.car),h=t.cdr.car;case 17:return e.t0=Pair,e.t1=t.car,e.t2=Pair,e.t3=h,e.next=23,y(t.cdr.cdr,r,o);case 23:return e.t4=e.sent,e.t5=new e.t2(e.t3,e.t4),e.abrupt("return",new e.t0(e.t1,e.t5));case 28:if(!d(a,u)){e.next=50;break}return v=u instanceof Syntax?t:t.cdr,e.next=32,u.invoke(v,_objectSpread(_objectSpread({},n),{},{env:o}),!0);case 32:if(b=e.sent,!(u instanceof Syntax)){e.next=41;break}if(w=(g=b).expr,x=g.scope,!(w instanceof Pair)){e.next=40;break}if(!(-1!==r&&r<=1||r<recur_guard)){e.next=38;break}return e.abrupt("return",w);case 38:return-1!==r&&(r-=1),e.abrupt("return",y(w,r,x));case 40:b=w;case 41:if(!(b instanceof LSymbol)){e.next=43;break}return e.abrupt("return",quote(b));case 43:if(!(b instanceof Pair)){e.next=48;break}if(!(-1!==r&&r<=1||r<recur_guard)){e.next=46;break}return e.abrupt("return",b);case 46:return-1!==r&&(r-=1),e.abrupt("return",y(b,r,o));case 48:if(!is_atom(b)){e.next=50;break}return e.abrupt("return",b);case 50:if(!((D=t.car)instanceof Pair)){e.next=55;break}return e.next=54,y(D,r,o);case 54:D=e.sent;case 55:if(!((L=t.cdr)instanceof Pair)){e.next=60;break}return e.next=59,y(L,r,o);case 59:L=e.sent;case 60:return C=new Pair(D,L),e.abrupt("return",C);case 62:case"end":return e.stop()}}),e)})))).apply(this,arguments)},y=function(e,t,r){return v.apply(this,arguments)},h=function(){return(h=_asyncToGenerator(regenerator.mark((function e(t,r){var n;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==_nil){e.next=2;break}return e.abrupt("return",_nil);case 2:return n=t.car,e.t0=Pair,e.t1=Pair,e.t2=n.car,e.next=8,y(n.cdr,r,o);case 8:return e.t3=e.sent,e.t4=new e.t1(e.t2,e.t3),e.next=12,m(t.cdr);case 12:return e.t5=e.sent,e.abrupt("return",new e.t0(e.t4,e.t5));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)},m=function(e,t){return h.apply(this,arguments)},d=function(e,t){return t instanceof Macro&&t.__defmacro__&&!i.includes(e)},p=function(e){return[].concat(_toConsumableArray(i),_toConsumableArray(e.to_array(!1).map((function(e){if(e instanceof Pair)return e.car.valueOf();throw new Error("macroexpand: Invalid let binding")}))))},_=function(e){for(var t=[];e!==_nil;){if(e instanceof LSymbol){t.push(e.valueOf());break}t.push(e.car.valueOf()),e=e.cdr}return[].concat(_toConsumableArray(i),t)},f=function(e){return e===u},l=function(e,t){return e===c&&t.cdr.car instanceof Pair},s=function(e){var t=e.valueOf();return a.includes(t)},o=n.env=this,i=[],a=["let","let*","letrec"],u=global_env.get("lambda"),c=global_env.get("define"),!(r.cdr instanceof Pair&&LNumber.isNumber(r.cdr.car))){t.next=21;break}return t.t0=quote,t.next=19,y(r,r.cdr.car.valueOf(),o);case 19:return t.t1=t.sent.car,t.abrupt("return",(0,t.t0)(t.t1));case 21:if(!e){t.next=27;break}return t.t2=quote,t.next=25,y(r,1,o);case 25:return t.t3=t.sent.car,t.abrupt("return",(0,t.t2)(t.t3));case 27:return t.t4=quote,t.next=30,y(r,-1,o);case 30:return t.t5=t.sent.car,t.abrupt("return",(0,t.t4)(t.t5));case 32:case"end":return t.stop()}}),t,this)})));return function(e,r){return t.apply(this,arguments)}}()}function Syntax(e,t){this.__env__=t,this.__fn__=e,this.__defmacro__=!0}function extract_patterns(e,t,r,n){var o=arguments.length>4&&arguments[4]!==undefined$1?arguments[4]:{},i={"...":{symbols:{},lists:[]},symbols:{}},a=o.expansion,u=o.define;function c(e){is_debug()&&console.log(e)}function s(e,t){var o=arguments.length>2&&arguments[2]!==undefined$1?arguments[2]:[],l=arguments.length>3&&arguments[3]!==undefined$1&&arguments[3];if(c({code:t&&toString(t,!0),pattern:e&&toString(e,!0)}),is_atom(e)&&!(e instanceof LSymbol))return same_atom(e,t);if(e instanceof LSymbol&&r.includes(e.valueOf())){var f=a.ref(t);return!!LSymbol.is(t,e)&&("undefined"===typeof f||f===u||f===global_env)}if(e instanceof Pair&&e.car instanceof Pair&&e.car.cdr instanceof Pair&&LSymbol.is(e.car.cdr.car,n)&&(c(">> 0"),t===_nil&&(c({pattern:e.toString()}),e.car.car instanceof LSymbol))){if(e.car.cdr instanceof Pair&&LSymbol.is(e.car.cdr.car,n)){var _=e.car.car.valueOf(),p=e.last_pair();return!!LSymbol.is(p.car,n)&&(i["..."].symbols[_]=null,!0)}var d=e.car.car.valueOf();if(i["..."].symbols[d])throw new Error("syntax: named ellipsis can only appear onces");i["..."].symbols[d]=t}if(e instanceof Pair&&e.cdr instanceof Pair&&LSymbol.is(e.cdr.car,n)){if(e.cdr.cdr!==_nil&&e.cdr.cdr instanceof Pair){for(var m=e.cdr.cdr.length(),h=t.length(),y=t;h-1>m;)y=y.cdr,h--;var v=y.cdr;if(y.cdr=_nil,!s(e.cdr.cdr,v,o,l))return!1}if(e.car instanceof LSymbol){var b=e.car.__name__;if(i["..."].symbols[b]&&!o.includes(b)&&!l)throw new Error("syntax: named ellipsis can only appear onces");if(c(">> 1"),t===_nil)c(">> 2"),l?(c("NIL"),i["..."].symbols[b]=_nil):(c("NULL"),i["..."].symbols[b]=null);else if(t instanceof Pair&&(t.car instanceof Pair||t.car===_nil))if(c(">> 3 "+l),l)if(i["..."].symbols[b]){var g=i["..."].symbols[b];g=g===_nil?new Pair(_nil,new Pair(t,_nil)):g.append(new Pair(t,_nil)),i["..."].symbols[b]=g}else i["..."].symbols[b]=new Pair(t,_nil);else c(">> 4"),i["..."].symbols[b]=new Pair(t,_nil);else{if(c(">> 6"),!(t instanceof Pair))return c(">> 8"),!1;if(c(">> 7 "+l),o.push(b),i["..."].symbols[b]){var w=i["..."].symbols[b];i["..."].symbols[b]=w.append(new Pair(t,_nil))}else i["..."].symbols[b]=new Pair(t,_nil);c({IIIIII:i["..."].symbols[b].toString()})}return!0}if(e.car instanceof Pair){var x=_toConsumableArray(o);if(t===_nil)return c(">> 9"),i["..."].lists.push(_nil),!0;c(">> 10");for(var D=t;D instanceof Pair;){if(!s(e.car,D.car,x,!0))return!1;D=D.cdr}return!0}return!1}if(e instanceof LSymbol){if(LSymbol.is(e,n))throw new Error("syntax: invalid usage of ellipsis");c(">> 11");var L=e.__name__;return r.includes(L)||(c({name:L,ellipsis:l}),l&&(i["..."].symbols[L]=i["..."].symbols[L]||[],i["..."].symbols[L].push(t)),i.symbols[L]=t,i.symbols[L]),!0}if(!(e instanceof Pair&&t instanceof Pair)){if(e!==_nil||t!==_nil&&t!==undefined$1){if(e.car instanceof Pair&&LSymbol.is(e.car.car,n))throw new Error("syntax: invalid usage of ellipsis");return!1}return!0}if(c(">> 12"),c({a:12,code:t&&t.toString(),pattern:e.toString()}),t.cdr===_nil){var C=e.car instanceof LSymbol&&e.cdr instanceof LSymbol;if(C){if(!s(e.car,t.car,o,l))return!1;c(">> 12 | 1");var F=e.cdr.valueOf();return F in i.symbols||(i.symbols[F]=_nil),(F=e.car.valueOf())in i.symbols||(i.symbols[F]=t.car),!0}}if(c({pattern:e.toString(),code:t.toString()}),e.cdr instanceof Pair&&e.car instanceof LSymbol&&e.cdr.cdr instanceof Pair&&e.cdr.car instanceof LSymbol&&LSymbol.is(e.cdr.cdr.car,n)&&e.cdr.cdr.cdr instanceof Pair&&!LSymbol.is(e.cdr.cdr.cdr.car,n)&&s(e.car,t.car,o,l)&&s(e.cdr.cdr.cdr,t.cdr,o,l)){var E=e.cdr.car.__name__;return c({pattern:e.car.toString(),code:t.car.toString(),name:E}),r.includes(E)||(i["..."].symbols[E]=null),!0}return c("recur"),!(!s(e.car,t.car,o,l)||!s(e.cdr,t.cdr,o,l))||void 0}if(c(r),s(e,t))return i}function clear_gensyms(e,t){return function e(r){if(r instanceof Pair)return t.length?new Pair(e(r.car),e(r.cdr)):r;if(r instanceof LSymbol){var n=t.find((function(e){return e.gensym===r}));return n?LSymbol(n.name):r}return r}(e)}function transform_syntax(){var e=arguments.length>0&&arguments[0]!==undefined$1?arguments[0]:{},t=e.bindings,r=e.expr,n=e.scope,o=e.symbols,i=e.names,a=e.ellipsis,u={};function c(e){return e instanceof LSymbol||["string","symbol"].includes(_typeof(e))}function s(e){if(!c(e)){var r=type(e);throw new Error("syntax: internal error, need symbol got ".concat(r))}var n=e.valueOf();if(n===a)throw new Error("syntax: internal error, ellipis not transformed");var i=_typeof(n);if(["string","symbol"].includes(i)){if(n in t.symbols)return t.symbols[n];if("string"===i&&n.match(/\./)){var u=n.split("."),s=u[0];if(s in t.symbols)return Pair.fromArray([LSymbol("."),t.symbols[s]].concat(u.slice(1).map((function(e){return LString(e)}))))}}return o.includes(n)?LSymbol(n):f(n)}function l(e){is_debug()&&console.log(e)}function f(e){if(!u[e]){var t=n.ref(e),r=gensym(e);if(t){var o=n.get(e);n.set(r,o)}else{var a=n.get(e,{throwError:!1});"undefined"!==typeof a&&n.set(r,a)}i.push({name:e,gensym:r}),u[e]=r}return u[e]}function _(e,t,r){var n=arguments.length>3&&arguments[3]!==undefined$1?arguments[3]:function(){},o=r.nested;if(l(" ==> "+e.toString(!0)),l(t),e instanceof LSymbol){var i=e.valueOf();if(l("[t 1"),t[i]){if(t[i]instanceof Pair){var u=t[i],c=u.car,f=u.cdr;if(o){var p=c.car,d=c.cdr;return d!==_nil&&n(i,new Pair(d,_nil)),p}return f!==_nil&&n(i,f),c}if(t[i]instanceof Array)return n(i,t[i].slice(1)),t[i][0]}return s(i)}if(e instanceof Pair){if(e.car instanceof LSymbol&&e.cdr instanceof Pair&&LSymbol.is(e.cdr.car,a)){l("[t 2");var m=e.car.valueOf(),h=t[m];if(l({expr:e.toString(!0),name:m,bindings:t,item:h}),null===h)return;if(h){if(l({b:t[m].toString()}),h instanceof Pair){l("[t 2 Pair "+o),l({______:h.toString()});var y=h.car,v=h.cdr;return o?(v!==_nil&&(l("|| next 1"),n(m,v)),l({car:y.toString()}),y):(y.cdr!==_nil&&(l("|| next 2"),n(m,new Pair(y.cdr,v))),l({car:y.car.toString()}),y.car)}if(h instanceof Array){if(l("[t 2 Array "+o),o)return n(m,h.slice(1)),Pair.fromArray(h);var b=h.slice(1);return b.length&&n(m,b),h[0]}return h}}l("[t 3 recur "+e.toString());var g=_(e.car,t,r,n),w=_(e.cdr,t,r,n);return new Pair(g,w)}return e}function p(e,t){var r=Object.values(e),n=Object.getOwnPropertySymbols(e);return n.length&&r.push.apply(r,_toConsumableArray(n.map((function(t){return e[t]})))),r.length&&r.every((function(e){return null===e?!t:e instanceof Pair||e===_nil||e instanceof Array&&e.length}))}function d(e){return Object.keys(e).concat(Object.getOwnPropertySymbols(e))}function m(e){var r=arguments.length>1&&arguments[1]!==undefined$1?arguments[1]:{},o=r.disabled;if(l("traverse>> "+e.toString()),e instanceof Pair){if(!o&&e.car instanceof Pair&&LSymbol.is(e.car.car,a))return m(e.car.cdr,{disabled:!0});if(e.cdr instanceof Pair&&LSymbol.is(e.cdr.car,a)&&!o){l(">> 1");var i=t["..."].symbols,u=Object.values(i);if(u.length&&u.every((function(e){return null===e})))return m(e.cdr.cdr,{disabled:o});var c=d(i),f=e.car instanceof LSymbol&&LSymbol.is(e.cdr.cdr.car,a);if(e.car instanceof Pair||f){if(t["..."].lists[0]===_nil)return _nil;var h,y=e.car;if(f&&(y=new Pair(e.car,new Pair(e.cdr.car,_nil))),l(">> 2"),c.length){l(">> 2 (a)");var v=_objectSpread({},i);h=_nil;for(var b=function(){if(!p(v))return"break";var e={},t=_(y,v,{nested:!0},(function(t,r){e[t]=r}));t!==undefined$1&&(h=f?h===_nil?t:h.append(t):new Pair(t,h)),v=e};;){var g=b();if("break"===g)break}if(h===_nil||f||(h=h.reverse()),e.cdr.cdr!==_nil&&!LSymbol.is(e.cdr.cdr.car,a)){var w=m(e.cdr.cdr,{disabled:o});return h.append(w)}return h}l(">> 3");var x=_(e.car,i,{nested:!0});return x?new Pair(x,_nil):_nil}if(e.car instanceof LSymbol){l(">> 4"),LSymbol.is(e.cdr.cdr.car,a)?l(">> 4 (a)"):l(">> 4 (b)");for(var D=e.car.__name__,L=_defineProperty({},D,i[D]),C=null===i[D],F=_nil,E=function(){if(!p(L,!0))return l({bind:L}),"break";var t={},r=_(e,L,{nested:!1},(function(e,r){t[e]=r}));l({value:r.toString()}),"undefined"!==typeof r&&(F=new Pair(r,F)),L=t};;){var A=E();if("break"===A)break}if(F!==_nil&&(F=F.reverse()),e.cdr instanceof Pair&&(e.cdr.cdr instanceof Pair||e.cdr.cdr instanceof LSymbol)){var S=m(e.cdr.cdr,{disabled:o});if(C)return S;l("<<<< 1"),F.append(S)}return l("<<<< 2"),F}}var k,P,N=m(e.car,{disabled:o});if(e.car instanceof LSymbol){var O=n.get(e.car,{throwError:!1});P=O instanceof Macro&&"syntax-rules"===O.__name__}return k=P?e.cdr.car instanceof LSymbol?new Pair(m(e.cdr.car,{disabled:o}),new Pair(e.cdr.cdr.car,m(e.cdr.cdr.cdr,{disabled:o}))):new Pair(e.cdr.car,m(e.cdr.cdr,{disabled:o})):m(e.cdr,{disabled:o}),l({a:!0,car:toString(e.car),cdr:toString(e.cdr),head:toString(N),rest:toString(k)}),new Pair(N,k)}if(e instanceof LSymbol){if(o&&LSymbol.is(e,a))return e;var j=s(e);if("undefined"!==typeof j)return j}return e}return m(r,{})}function is_null(e){return is_undef(e)||e===_nil||null===e}function is_function(e){return"function"===typeof e&&"function"===typeof e.bind}function is_promise(e){return!(e instanceof QuotedPromise)&&(e instanceof Promise||e&&is_function(e.then))}function is_undef(e){return"undefined"===typeof e}function box(e){switch(_typeof(e)){case"string":return LString(e);case"number":if(!Number.isNaN(e))return LNumber(e)}return e}function map_object(e,t){var r=Object.getOwnPropertyNames(e),n=Object.getOwnPropertySymbols(e);return r.concat(n).forEach((function(r){var n=t(e[r]),o=Object.getOwnPropertyDescriptor(e,r);(!o||o.writable&&e[r]!==n)&&(e[r]=n)})),e}function unbox(e){return[LString,LCharacter,LNumber].some((function(t){return e instanceof t}))?e.valueOf():e instanceof Array?e.map(unbox):(e instanceof QuotedPromise&&delete e.then,is_plain_object(e)?map_object(e,unbox):e)}function patch_value(e,t){return e instanceof Pair?(e.markCycles(),quote(e)):is_function(e)&&t?bind(e,t):box(e)}function unbind(e){return is_bound(e)?e[__fn__]:e}function bind(e,t){if(e[Symbol.for("__bound__")])return e;var r,n=e.bind(t),o=_createForOfIteratorHelper(Object.getOwnPropertyNames(e));try{for(o.s();!(r=o.n()).done;){var i=r.value;if(filter_fn_names(i))try{n[i]=e[i]}catch(a){}}}catch(u){o.e(u)}finally{o.f()}return hidden_prop(n,"__fn__",e),hidden_prop(n,"__context__",t),hidden_prop(n,"__bound__",!0),is_native_function(e)&&hidden_prop(n,"__native__",!0),is_plain_object(t)&&is_lambda(e)&&hidden_prop(n,"__method__",!0),n.valueOf=function(){return e},n}function is_object_bound(e){return is_bound(e)&&e[Symbol.for("__context__")]===Object}function is_bound(e){return!(!is_function(e)||!e[__fn__])}function lips_context(e){if(is_function(e)){var t=e[__context__];if(t&&(t===lips||t.constructor&&t.constructor.__class__))return!0}return!1}function is_port(e){return e instanceof InputPort||e instanceof OutputPort}function is_port_method(e){return!(!is_function(e)||!is_port(e[__context__]))}Syntax.__merge_env__=Symbol.for("merge"),Syntax.prototype=Object.create(Macro.prototype),Syntax.prototype.invoke=function(e,t,r){var n=t.error,o=t.env,i={error:n,env:o,dynamic_scope:this.__env__,macro_expand:r};return this.__fn__.call(o,e,i,this.__name__||"syntax")},Syntax.prototype.constructor=Syntax,Syntax.prototype.toString=function(){return this.__name__?"#<syntax:".concat(this.__name__,">"):"#<syntax>"},Syntax.className="syntax";var __context__=Symbol.for("__context__"),__fn__=Symbol.for("__fn__"),__data__=Symbol.for("__data__"),__ref__=Symbol.for("__ref__"),__cycles__=Symbol.for("__cycles__"),__class__=Symbol.for("__class__"),__method__=Symbol.for("__method__"),__prototype__=Symbol.for("__prototype__"),__lambda__=Symbol.for("__lambda__"),exluded_names=["name","length","caller","callee","arguments","prototype"];function filter_fn_names(e){return!exluded_names.includes(e)}function hidden_prop(e,t,r){Object.defineProperty(e,Symbol.for(t),{get:function(){return r},set:function(){},configurable:!1,enumerable:!1})}function set_fn_length(e,t){try{return Object.defineProperty(e,"length",{get:function(){return t}}),e}catch(n){var r=new Array(t).fill(0).map((function(e,t){return"a"+t})).join(",");return new Function("f","return function(".concat(r,") {\n                return f.apply(this, arguments);\n            };"))(e)}}function is_lambda(e){return e&&e[__lambda__]}function is_method(e){return e&&e[__method__]}function is_raw_lambda(e){return is_lambda(e)&&!e[__prototype__]&&!is_method(e)&&!is_port_method(e)}function is_native_function(e){var t=Symbol.for("__native__");return is_function(e)&&e.toString().match(/\{\s*\[native code\]\s*\}/)&&(e.name.match(/^bound /)&&!0===e[t]||!e.name.match(/^bound /)&&!e[t])}function let_macro(e){var t;switch(e){case Symbol.for("letrec"):t="letrec";break;case Symbol.for("let"):t="let";break;case Symbol.for("let*"):t="let*";break;default:throw new Error("Invalid let_macro value")}return Macro.defmacro(t,(function(e,r){var n,o=r.dynamic_scope,i=r.error,a=r.macro_expand;if(e.car instanceof LSymbol){if(!(e.cdr.car instanceof Pair||e.cdr.car===_nil))throw new Error("let require list of pairs");var u;return e.cdr.car===_nil?(n=_nil,u=_nil):(u=e.cdr.car.map((function(e){return e.car})),n=e.cdr.car.map((function(e){return e.cdr.car}))),Pair.fromArray([LSymbol("letrec"),[[e.car,Pair(LSymbol("lambda"),Pair(u,e.cdr.cdr))]],Pair(e.car,n)])}if(!a){var c=this;n=global_env.get("list->array")(e.car);var s,l,f=c.inherit(t);"let*"===t?l=f:"let"===t&&(s=[]);var _=0;return function e(){var r=n[_++];if(o&&(o="let*"===t?f:c),r){"let"===t?l=c:"letrec"===t&&(l=f);var a=_evaluate(r.cdr.car,{env:l,dynamic_scope:o,error:i});return"let*"===t&&(l=f=l.inherit("let*["+_+"]")),s?(s.push({name:r.car,value:a}),e()):unpromise(a,(function(t){return f.set(r.car,t),e()}))}if(s&&s.length){var u=s.map((function(e){return e.value}));if(u.filter(is_promise).length)return promise_all(u).then((function(e){for(var t=0,r=e.length;t<r;++t)f.set(s[t].name,e[t])})).then(p);var d,m=_createForOfIteratorHelper(s);try{for(m.s();!(d=m.n()).done;){var h=d.value,y=h.name,v=h.value;f.set(y,v)}}catch(b){m.e(b)}finally{m.f()}}return p()}()}function p(){return _evaluate(new Pair(new LSymbol("begin"),e.cdr),{env:f,dynamic_scope:o,error:i})}}))}function pararel(e,t){return new Macro(e,(function(e){var r=arguments.length>1&&arguments[1]!==undefined$1?arguments[1]:{},n=r.dynamic_scope,o=r.error,i=this;n&&(n=this);for(var a=e,u=[];a instanceof Pair;)u.push(_evaluate(a.car,{env:i,dynamic_scope:n,error:o})),a=a.cdr;var c=u.filter(is_promise).length;return c?promise_all(u).then(t.bind(this)):t.call(this,u)}))}function guard_math_call(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return r.forEach((function(e){typecheck("",e,"number")})),e.apply(void 0,r)}function pipe(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return r.forEach((function(e,t){typecheck("pipe",e,"function",t+1)})),function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return r.reduce((function(t,r){return[r.apply(e,t)]}),n)[0]}}function compose(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.forEach((function(e,t){typecheck("compose",e,"function",t+1)})),pipe.apply(void 0,_toConsumableArray(t.reverse()))}function fold(e,t){var r=this;return function n(o,i){typecheck(e,o,"function");for(var a=arguments.length,u=new Array(a>2?a-2:0),c=2;c<a;c++)u[c-2]=arguments[c];return u.some(is_null)?"number"===typeof i?LNumber(i):i:t.call.apply(t,[r,n,o,i].concat(u))}}function limit_math_op(e,t){return limit(e+1,curry(guard_math_call,t))}var single_math_op=curry(limit_math_op,1),binary_math_op=curry(limit_math_op,2);function reduce_math_op(e){var t=arguments.length>1&&arguments[1]!==undefined$1?arguments[1]:null;return function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return null!==t&&(n=[t].concat(_toConsumableArray(n))),n.reduce(binary_math_op(e))}}function curry(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];typecheck("curry",e,"function");var o=e.length;return function(){var t=r.slice();function n(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(t=t.concat(i)).length>=o?e.apply(this,t):n}return n.apply(this,arguments)}}function limit(e,t){return typecheck("limit",t,"function",2),function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return t.apply(void 0,_toConsumableArray(n.slice(0,e)))}}function LCharacter(e){if("undefined"!==typeof this&&!(this instanceof LCharacter)||"undefined"===typeof this)return new LCharacter(e);var t;if(e instanceof LString&&(e=e.valueOf()),Array.from(e).length>1){if(e=e.toLowerCase(),!LCharacter.__names__[e])throw new Error("Internal: Unknown named character");t=e,e=LCharacter.__names__[e]}else t=LCharacter.__rev_names__[e];Object.defineProperty(this,"__char__",{value:e,enumerable:!0}),t&&Object.defineProperty(this,"__name__",{value:t,enumerable:!0})}function LString(e){if("undefined"!==typeof this&&!(this instanceof LString)||"undefined"===typeof this)return new LString(e);this.__string__=e instanceof Array?e.map((function(e,t){return typecheck("LString",e,"character",t+1),e.toString()})).join(""):e.valueOf()}LCharacter.__names__=characters,LCharacter.__rev_names__={},Object.keys(LCharacter.__names__).forEach((function(e){var t=LCharacter.__names__[e];LCharacter.__rev_names__[t]=e})),LCharacter.prototype.toUpperCase=function(){return LCharacter(this.__char__.toUpperCase())},LCharacter.prototype.toLowerCase=function(){return LCharacter(this.__char__.toLowerCase())},LCharacter.prototype.toString=function(){return"#\\"+(this.__name__||this.__char__)},LCharacter.prototype.valueOf=LCharacter.prototype.serialize=function(){return this.__char__};var ignore=["length","constructor"],_keys=Object.getOwnPropertyNames(String.prototype).filter((function(e){return!ignore.includes(e)})),wrap=function(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.apply(this.__string__,r)}},_iterator11=_createForOfIteratorHelper(_keys),_step11;try{for(_iterator11.s();!(_step11=_iterator11.n()).done;){var key=_step11.value;LString.prototype[key]=wrap(String.prototype[key])}}catch(err){_iterator11.e(err)}finally{_iterator11.f()}function LNumber(e){var t=arguments.length>1&&arguments[1]!==undefined$1&&arguments[1];if(e instanceof LNumber)return e;if("undefined"!==typeof this&&!(this instanceof LNumber)||"undefined"===typeof this)return new LNumber(e,t);if("undefined"===typeof e)throw new Error("Invalid LNumber constructor call");var r=LNumber.getType(e);if(LNumber.types[r])return LNumber.types[r](e,t);var n,o=e instanceof Array&&LString.isString(e[0])&&LNumber.isNumber(e[1]);if(e instanceof LNumber)return LNumber(e.value);if(!LNumber.isNumber(e)&&!o)throw new Error("You can't create LNumber from ".concat(type(e)));if(null===e&&(e=0),o){var i=e,a=_slicedToArray(i,2),u=a[0],c=a[1];u instanceof LString&&(u=u.valueOf()),c instanceof LNumber&&(c=c.valueOf());var s=u.match(/^([+-])/),l=!1;s&&(u=u.replace(/^[+-]/,""),"-"===s[1]&&(l=!0))}if(Number.isNaN(e))return LFloat(e);if("undefined"!==typeof BigInt){if("bigint"!==typeof e){if(o){var f;switch(c){case 8:f="0o";break;case 16:f="0x";break;case 2:f="0b";break;case 10:f=""}if("undefined"===typeof f){var _=BigInt(c);n=_toConsumableArray(u).map((function(e,t){return BigInt(parseInt(e,c))*Math.pow(_,BigInt(t))})).reduce((function(e,t){return e+t}))}else n=BigInt(f+u)}else n=BigInt(e);l&&(n*=BigInt(-1))}else n=e;return LBigInteger(n,!0)}if(!("undefined"===typeof BN||e instanceof BN))return LBigInteger(e instanceof Array?_construct(BN,_toConsumableArray(e)):new BN(e));o?this.constant(parseInt(u,c),"integer"):this.constant(e,"integer")}LString.prototype.serialize=function(){return this.valueOf()},LString.isString=function(e){return e instanceof LString||"string"===typeof e},LString.prototype.get=function(e){return typecheck("LString::get",e,"number"),Array.from(this.__string__)[e.valueOf()]},LString.prototype.cmp=function(e){typecheck("LString::cmp",e,"string");var t=this.valueOf(),r=e.valueOf();return t<r?-1:t===r?0:1},LString.prototype.lower=function(){return LString(this.__string__.toLowerCase())},LString.prototype.upper=function(){return LString(this.__string__.toUpperCase())},LString.prototype.set=function(e,t){typecheck("LString::set",e,"number"),typecheck("LString::set",t,["string","character"]),e=e.valueOf(),t instanceof LCharacter&&(t=t.__char__);var r=[];e>0&&r.push(this.__string__.substring(0,e)),r.push(t),e<this.__string__.length-1&&r.push(this.__string__.substring(e+1)),this.__string__=r.join("")},Object.defineProperty(LString.prototype,"length",{get:function(){return this.__string__.length}}),LString.prototype.clone=function(){return LString(this.valueOf())},LString.prototype.fill=function(e){typecheck("LString::fill",e,["string","character"]),e instanceof LCharacter&&(e=e.toString());var t=this.__string__.length;this.__string__=new Array(t+1).join(e)},LNumber.prototype.constant=function(e,t){Object.defineProperty(this,"__value__",{value:e,enumerable:!0}),Object.defineProperty(this,"__type__",{value:t,enumerable:!0})},LNumber.types={float:function(e){var t=arguments.length>1&&arguments[1]!==undefined$1&&arguments[1];return new LFloat(e,t)},complex:function(e){var t=arguments.length>1&&arguments[1]!==undefined$1&&arguments[1];return LNumber.isComplex(e)||(e={im:0,re:e}),new LComplex(e,t)},rational:function(e){var t=arguments.length>1&&arguments[1]!==undefined$1&&arguments[1];return LNumber.isRational(e)||(e={num:e,denom:1}),new LRational(e,t)}},LNumber.prototype.serialize=function(){return this.__value__},LNumber.prototype.isNaN=function(){return Number.isNaN(this.__value__)},LNumber.prototype.gcd=function(e){var t=this.abs();if(1===(e=e.abs()).cmp(t)){var r=t;t=e,e=r}for(;;){if(0===(t=t.rem(e)).cmp(0))return e;if(0===(e=e.rem(t)).cmp(0))return t}},LNumber.isFloat=function(e){return e instanceof LFloat||Number(e)===e&&e%1!==0},LNumber.isNumber=function(e){return e instanceof LNumber||LNumber.isNative(e)||LNumber.isBN(e)},LNumber.isComplex=function(e){return!!e&&(e instanceof LComplex||(LNumber.isNumber(e.im)||Number.isNaN(e.im))&&(LNumber.isNumber(e.re)||Number.isNaN(e.re)))},LNumber.isRational=function(e){return!!e&&(e instanceof LRational||LNumber.isNumber(e.num)&&LNumber.isNumber(e.denom))},LNumber.isInteger=function(e){return!!(LNumber.isNative(e)||e instanceof LNumber)&&!LNumber.isFloat(e)&&!LNumber.isRational(e)&&!LNumber.isComplex(e)},LNumber.isNative=function(e){return"bigint"===typeof e||"number"===typeof e},LNumber.isBigInteger=function(e){return e instanceof LBigInteger||"bigint"===typeof e||LNumber.isBN(e)},LNumber.isBN=function(e){return"undefined"!==typeof BN&&e instanceof BN},LNumber.getArgsType=function(e,t){return e instanceof LFloat||t instanceof LFloat?LFloat:e instanceof LBigInteger||t instanceof LBigInteger?LBigInteger:LNumber},LNumber.prototype.toString=function(e){return Number.isNaN(this.__value__)?"+nan.0":e>2&&e<36?this.__value__.toString(e):this.__value__.toString()},LNumber.prototype.asType=function(e){var t=LNumber.getType(this);return LNumber.types[t]?LNumber.types[t](e):LNumber(e)},LNumber.prototype.isBigNumber=function(){return"bigint"===typeof this.__value__||"undefined"!==typeof BN&&!(this.value instanceof BN)},["floor","ceil","round"].forEach((function(e){LNumber.prototype[e]=function(){return this.float||LNumber.isFloat(this.__value__)?LNumber(Math[e](this.__value__)):LNumber(Math[e](this.valueOf()))}})),LNumber.prototype.valueOf=function(){return LNumber.isNative(this.__value__)?Number(this.__value__):LNumber.isBN(this.__value__)?this.__value__.toNumber():void 0};var matrix=function(){var e=function(e,t){return[e,t]};return{bigint:{bigint:e,float:function(e,t){return[LFloat(e.valueOf()),t]},rational:function(e,t){return[{num:e,denom:1},t]},complex:function(e,t){return[{im:0,re:e},t]}},integer:{integer:e,float:function(e,t){return[LFloat(e.valueOf()),t]},rational:function(e,t){return[{num:e,denom:1},t]},complex:function(e,t){return[{im:0,re:e},t]}},float:{bigint:function(e,t){return[e,t&&LFloat(t.valueOf())]},integer:function(e,t){return[e,t&&LFloat(t.valueOf())]},float:e,rational:function(e,t){return[e,t&&LFloat(t.valueOf())]},complex:function(e,t){return[{re:e,im:LFloat(0)},t]}},complex:{bigint:t("bigint"),integer:t("integer"),float:t("float"),rational:t("rational"),complex:function(e,t){var r=LNumber.coerce(e.__re__,t.__re__),n=_slicedToArray(r,2),o=n[0],i=n[1],a=LNumber.coerce(e.__im__,t.__im__),u=_slicedToArray(a,2);return[{im:u[0],re:o},{im:u[1],re:i}]}},rational:{bigint:function(e,t){return[e,t&&{num:t,denom:1}]},integer:function(e,t){return[e,t&&{num:t,denom:1}]},float:function(e,t){return[LFloat(e.valueOf()),t]},rational:e,complex:function(e,t){return[{im:coerce(e.__type__,t.__im__.__type__,0)[0],re:coerce(e.__type__,t.__re__.__type__,e)[0]},{im:coerce(e.__type__,t.__im__.__type__,t.__im__)[0],re:coerce(e.__type__,t.__re__.__type__,t.__re__)[0]}]}}};function t(e){return function(t,r){return[{im:coerce(e,t.__im__.__type__,0,t.__im__)[1],re:coerce(e,t.__re__.__type__,0,t.__re__)[1]},{im:coerce(e,t.__im__.__type__,0,0)[1],re:coerce(e,r.__type__,0,r)[1]}]}}}();function coerce(e,t,r,n){return matrix[e][t](r,n)}LNumber.coerce=function(e,t){var r=LNumber.getType(e),n=LNumber.getType(t);if(!matrix[r])throw new Error("LNumber::coerce unknown lhs type ".concat(r));if(!matrix[r][n])throw new Error("LNumber::coerce unknown rhs type ".concat(n));return matrix[r][n](e,t).map((function(e){return LNumber(e,!0)}))},LNumber.prototype.coerce=function(e){if(!("number"===typeof e||e instanceof LNumber))throw new Error("LNumber: you can't coerce ".concat(type(e)));return"number"===typeof e&&(e=LNumber(e)),LNumber.coerce(this,e)},LNumber.getType=function(e){return e instanceof LNumber?e.__type__:LNumber.isFloat(e)?"float":LNumber.isComplex(e)?"complex":LNumber.isRational(e)?"rational":"number"===typeof e?"integer":"undefined"!==typeof BigInt&&"bigint"!==typeof e||"undefined"!==typeof BN&&!(e instanceof BN)?"bigint":void 0},LNumber.prototype.isFloat=function(){return!(!LNumber.isFloat(this.__value__)&&!this.float)};var mapping={add:"+",sub:"-",mul:"*",div:"/",rem:"%",or:"|",and:"&",neg:"~",shl:">>",shr:"<<"},rev_mapping={};Object.keys(mapping).forEach((function(e){rev_mapping[mapping[e]]=e,LNumber.prototype[e]=function(t){return this.op(mapping[e],t)}})),LNumber._ops={"*":function(e,t){return e*t},"+":function(e,t){return e+t},"-":function(e,t){return"undefined"===typeof t?-e:e-t},"/":function(e,t){return e/t},"%":function(e,t){return e%t},"|":function(e,t){return e|t},"&":function(e,t){return e&t},"~":function(e){return~e},">>":function(e,t){return e>>t},"<<":function(e,t){return e<<t}},LNumber.prototype.op=function(e,t){if("undefined"===typeof t)return LNumber(LNumber._ops[e](this.valueOf()));if("number"===typeof t&&(t=LNumber(t)),Number.isNaN(this.__value__)&&!LNumber.isComplex(t)||!LNumber.isComplex(this)&&Number.isNaN(t.__value__))return LNumber(NaN);var r=this.coerce(t),n=_slicedToArray(r,2),o=n[0],i=n[1];return o._op?o._op(e,i):LNumber(LNumber._ops[e](o,i))},LNumber.prototype.sqrt=function(){var e=this.valueOf();return this.cmp(0)<0?LComplex({re:0,im:Math.sqrt(-e)}):new LNumber(Math.sqrt(e))};var pow=function(e,t){var r="bigint"===typeof e?BigInt(1):1;return new Array(Number(t)).fill(0).reduce((function(t){return t*e}),r)};function LComplex(e){var t=arguments.length>1&&arguments[1]!==undefined$1&&arguments[1];if("undefined"!==typeof this&&!(this instanceof LComplex)||"undefined"===typeof this)return new LComplex(e,t);if(e instanceof LComplex)return LComplex({im:e.__im__,re:e.__re__});if(LNumber.isNumber(e)&&t){if(!t)return Number(e)}else if(!LNumber.isComplex(e))throw new Error("Invalid constructor call for LComplex");var r=e.im instanceof LNumber?e.im:LNumber(e.im),n=e.re instanceof LNumber?e.re:LNumber(e.re);this.constant(r,n)}function LFloat(e){if("undefined"!==typeof this&&!(this instanceof LFloat)||"undefined"===typeof this)return new LFloat(e);if(!LNumber.isNumber(e))throw new Error("Invalid constructor call for LFloat");if(e instanceof LNumber)return LFloat(e.valueOf());"number"===typeof e&&(Object.is(e,-0)&&Object.defineProperty(this,"_minus",{value:!0}),this.constant(e,"float"))}LNumber.prototype.pow=function(e){var t;return t=LNumber.isBN(this.__value__)?this.__value__.pow(e.__value__):pow(this.__value__,e.__value__),LNumber(t)},LNumber.prototype.abs=function(){var e=this.__value__;return LNumber.isNative(this.__value__)?e<0&&(e=-e):LNumber.isBN(e)&&e.iabs(),new LNumber(e)},LNumber.prototype.isOdd=function(){return LNumber.isNative(this.__value__)?this.isBigNumber()?this.__value__%BigInt(2)===BigInt(1):this.__value__%2===1:LNumber.isBN(this.__value__)?this.__value__.isOdd():void 0},LNumber.prototype.isEven=function(){return!this.isOdd()},LNumber.prototype.cmp=function(e){var t=this.coerce(e),r=_slicedToArray(t,2),n=r[0],o=r[1];function i(e,t){return e.__value__<t.__value__?-1:e.__value__===t.__value__?0:1}if("bigint"===n.__type__){if(LNumber.isNative(n.__value__))return i(n,o);if(LNumber.isBN(n.__value__))return this.__value__.cmp(o.__value__)}else if(n instanceof LFloat)return i(n,o)},LComplex.prototype=Object.create(LNumber.prototype),LComplex.prototype.constructor=LComplex,LComplex.prototype.constant=function(e,t){Object.defineProperty(this,"__im__",{value:e,enumerable:!0}),Object.defineProperty(this,"__re__",{value:t,enumerable:!0}),Object.defineProperty(this,"__type__",{value:"complex",enumerable:!0})},LComplex.prototype.serialize=function(){return{re:this.__re__,im:this.__im__}},LComplex.prototype.toRational=function(e){return LNumber.isFloat(this.__im__)&&LNumber.isFloat(this.__re__)?LComplex({im:LFloat(this.__im__).toRational(e),re:LFloat(this.__re__).toRational(e)}):this},LComplex.prototype.add=function(e){return this.complex_op("add",e,(function(e,t,r,n){return{re:e.add(t),im:r.add(n)}}))},LComplex.prototype.factor=function(){if(this.__im__ instanceof LFloat||this.__im__ instanceof LFloat){var e,t,r=this.__re__,n=this.__im__;return e=r instanceof LFloat?r.toRational().mul(r.toRational()):r.mul(r),t=n instanceof LFloat?n.toRational().mul(n.toRational()):n.mul(n),e.add(t)}return this.__re__.mul(this.__re__).add(this.__im__.mul(this.__im__))},LComplex.prototype.modulus=function(){return this.factor().sqrt()},LComplex.prototype.conjugate=function(){return LComplex({re:this.__re__,im:this.__im__.sub()})},LComplex.prototype.sqrt=function(){var e,t,r=this.modulus();return 0===r.cmp(0)?e=t=r:1===this.__re__.cmp(0)?(e=LFloat(.5).mul(r.add(this.__re__)).sqrt(),t=this.__im__.div(e).div(2)):(t=LFloat(.5).mul(r.sub(this.__re__)).sqrt(),-1===this.__im__.cmp(0)&&(t=t.sub()),e=this.__im__.div(t).div(2)),LComplex({im:t,re:e})},LComplex.prototype.div=function(e){if(LNumber.isNumber(e)&&!LNumber.isComplex(e))return e instanceof LNumber||(e=LNumber(e)),LComplex({re:this.__re__.div(e),im:this.__im__.div(e)});if(!LNumber.isComplex(e))throw new Error("[LComplex::div] Invalid value");var t=this.coerce(e),r=_slicedToArray(t,2),n=r[0],o=r[1],i=o.factor(),a=n.mul(o.conjugate());return LComplex({re:a.__re__.op("/",i),im:a.__im__.op("/",i)})},LComplex.prototype.sub=function(e){return this.complex_op("sub",e,(function(e,t,r,n){return{re:e.sub(t),im:r.sub(n)}}))},LComplex.prototype.mul=function(e){return this.complex_op("mul",e,(function(e,t,r,n){return{re:e.mul(t).sub(r.mul(n)),im:e.mul(n).add(t.mul(r))}}))},LComplex.prototype.complex_op=function(e,t,r){var n=this,o=function(e,t){var o=r(n.__re__,e,n.__im__,t);return"im"in o&&"re"in o?0!==o.im.cmp(0)||LNumber.isFloat(o.im)?LComplex(o,!0):o.re:o};if("undefined"===typeof t)return o();if(LNumber.isNumber(t)&&!LNumber.isComplex(t)){t instanceof LNumber||(t=LNumber(t));var i=t.asType(0);t={__im__:i,__re__:t}}else if(!LNumber.isComplex(t))throw new Error("[LComplex::".concat(e,"] Invalid value"));return o(t.__re__ instanceof LNumber?t.__re__:this.__re__.asType(t.__re__),t.__im__ instanceof LNumber?t.__im__:this.__im__.asType(t.__im__))},LComplex._op={"+":"add","-":"sub","*":"mul","/":"div"},LComplex.prototype._op=function(e,t){return this[LComplex._op[e]](t)},LComplex.prototype.cmp=function(e){var t=this.coerce(e),r=_slicedToArray(t,2),n=r[0],o=r[1],i=n.__re__.coerce(o.__re__),a=_slicedToArray(i,2),u=a[0],c=a[1],s=u.cmp(c);if(0!==s)return s;var l=n.__im__.coerce(o.__im__),f=_slicedToArray(l,2),_=f[0],p=f[1];return _.cmp(p)},LComplex.prototype.valueOf=function(){return[this.__re__,this.__im__].map((function(e){return e.valueOf()}))},LComplex.prototype.toString=function(){var e;e=0!==this.__re__.cmp(0)?[toString(this.__re__)]:[];var t=this.__im__.valueOf(),r=[Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY].includes(t),n=toString(this.__im__);if(!r&&!Number.isNaN(t)){var o=this.__im__.cmp(0);o<0||0===o&&this.__im__._minus?e.push("-"):e.push("+"),n=n.replace(/^-/,"")}return e.push(n),e.push("i"),e.join("")},LFloat.prototype=Object.create(LNumber.prototype),LFloat.prototype.constructor=LFloat,LFloat.prototype.toString=function(){if(this.__value__===Number.NEGATIVE_INFINITY)return"-inf.0";if(this.__value__===Number.POSITIVE_INFINITY)return"+inf.0";if(Number.isNaN(this.__value__))return"+nan.0";var e=this.__value__.toString();if(!LNumber.isFloat(this.__value__)&&!e.match(/e/i)){var t=e+".0";return this._minus?"-"+t:t}return e.replace(/^([0-9]+)e/,"$1.0e")},LFloat.prototype._op=function(e,t){t instanceof LNumber&&(t=t.__value__);var r=LNumber._ops[e];return"/"===e&&0===this.__value__&&0===t?NaN:LFloat(r(this.__value__,t))},LFloat.prototype.toRational=function(){var e=arguments.length>0&&arguments[0]!==undefined$1?arguments[0]:null;return null===e?toRational(this.__value__.valueOf()):approxRatio(e.valueOf())(this.__value__.valueOf())};var toRational=approxRatio(1e-10);function approxRatio(e){return function(t){var r,n,o,i=(r=e||1e-4,n=1,o=t,Number.isNaN(n)||Number.isNaN(o)?NaN:function e(t,n){return n<r?t:e(n,t%n)}(Math.abs(n),Math.abs(o)));return LRational({num:Math.floor(t/i),denom:Math.floor(1/i)})}}function rationalize(e,t){var r,n=e.sub(t),o=e.add(t);return r=n.cmp(o)>0?simplest_rational2(o,n):o.cmp(n)<=0?n:n.cmp(0)>0?simplest_rational2(n,o):t.cmp(0)<0?LNumber(simplest_rational2(o.sub(),n.sub())).sub():LNumber(0),LNumber.isFloat(t)||LNumber.isFloat(e)?LFloat(r):r}function simplest_rational2(e,t){var r=LNumber(e).floor(),n=LNumber(t).floor();if(e.cmp(r)<1)return r;if(0===r.cmp(n)){var o=LNumber(1).div(t.sub(n)),i=LNumber(1).div(e.sub(r));return r.add(LNumber(1).div(simplest_rational2(o,i)))}return r.add(LNumber(1))}function LRational(e){var t,r,n=arguments.length>1&&arguments[1]!==undefined$1&&arguments[1];if("undefined"!==typeof this&&!(this instanceof LRational)||"undefined"===typeof this)return new LRational(e,n);if(!LNumber.isRational(e))throw new Error("Invalid constructor call for LRational");if(e instanceof LRational?(t=LNumber(e.__num__),r=LNumber(e.__denom__)):(t=LNumber(e.num),r=LNumber(e.denom)),!n&&0!==r.cmp(0)){var o=0===t.op("%",r).cmp(0);if(o)return LNumber(t.div(r))}this.constant(t,r)}function LBigInteger(e,t){if("undefined"!==typeof this&&!(this instanceof LBigInteger)||"undefined"===typeof this)return new LBigInteger(e,t);if(e instanceof LBigInteger)return LBigInteger(e.__value__,e._native);if(!LNumber.isBigInteger(e))throw new Error("Invalid constructor call for LBigInteger");this.constant(e,"bigint"),Object.defineProperty(this,"_native",{value:t})}function InputPort(e){var t,r=this;if("undefined"!==typeof this&&!(this instanceof InputPort)||"undefined"===typeof this)return new InputPort(e);typecheck("InputPort",e,"function"),read_only(this,"__type__",text_port),Object.defineProperty(this,"__parser__",{enumerable:!0,get:function(){return t},set:function(e){typecheck("InputPort::__parser__",e,"parser"),t=e}}),this._read=e,this._with_parser=this._with_init_parser.bind(this,_asyncToGenerator(regenerator.mark((function e(){var n;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.char_ready()){e.next=5;break}return e.next=3,r._read();case 3:n=e.sent,t=new Parser(n,{env:r});case 5:return e.abrupt("return",r.__parser__);case 6:case"end":return e.stop()}}),e)})))),this.char_ready=function(){return!!this.__parser__&&this.__parser__.__lexer__.peek()!==eof},this._make_defaults()}function OutputPort(e){if("undefined"!==typeof this&&!(this instanceof OutputPort)||"undefined"===typeof this)return new OutputPort(e);typecheck("OutputPort",e,"function"),read_only(this,"__type__",text_port),this.write=e}function OutputStringPort(e){var t=this;if("undefined"!==typeof this&&!(this instanceof OutputStringPort)||"undefined"===typeof this)return new OutputStringPort(e);typecheck("OutputStringPort",e,"function"),read_only(this,"__type__",text_port),read_only(this,"__buffer__",[]),this.write=function(r){r=LString.isString(r)?r.valueOf():e(r),t.__buffer__.push(r)}}function OutputFilePort(e,t){var r=this;if("undefined"!==typeof this&&!(this instanceof OutputFilePort)||"undefined"===typeof this)return new OutputFilePort(e,t);typecheck("OutputFilePort",e,"string"),read_only(this,"__filename__",e),read_only(this,"_fd",t.valueOf(),{hidden:!0}),read_only(this,"__type__",text_port),this.write=function(e){e=LString.isString(e)?e.valueOf():toString(e),r.fs().write(r._fd,e,(function(e){if(e)throw e}))}}function InputStringPort(e,t){var r=this;if("undefined"!==typeof this&&!(this instanceof InputStringPort)||"undefined"===typeof this)return new InputStringPort(e);typecheck("InputStringPort",e,"string"),t=t||global_env,e=e.valueOf(),this._with_parser=this._with_init_parser.bind(this,(function(){return r.__parser__||(r.__parser__=new Parser(e,{env:t})),r.__parser__})),read_only(this,"__type__",text_port),this._make_defaults()}function InputByteVectorPort(e){if("undefined"!==typeof this&&!(this instanceof InputByteVectorPort)||"undefined"===typeof this)return new InputByteVectorPort(e);typecheck("InputByteVectorPort",e,"uint8array"),read_only(this,"__vector__",e),read_only(this,"__type__",binary_port);var t=0;Object.defineProperty(this,"__index__",{enumerable:!0,get:function(){return t},set:function(e){if(typecheck("InputByteVectorPort::__index__",e,"number"),e instanceof LNumber&&(e=e.valueOf()),"bigint"===typeof e&&(e=Number(e)),Math.floor(e)!==e)throw new Error("InputByteVectorPort::__index__ value is not integer");t=e}})}function OutputByteVectorPort(){if("undefined"!==typeof this&&!(this instanceof OutputByteVectorPort)||"undefined"===typeof this)return new OutputByteVectorPort;read_only(this,"__type__",binary_port),read_only(this,"_buffer",[],{hidden:!0}),this.write=function(e){var t;typecheck("write",e,["number","uint8array"]),LNumber.isNumber(e)?this._buffer.push(e.valueOf()):(t=this._buffer).push.apply(t,_toConsumableArray(Array.from(e)))},Object.defineProperty(this,"__buffer__",{enumerable:!0,get:function(){return Uint8Array.from(this._buffer)}})}function InputFilePort(e,t){if("undefined"!==typeof this&&!(this instanceof InputFilePort)||"undefined"===typeof this)return new InputFilePort(e,t);InputStringPort.call(this,e),typecheck("InputFilePort",t,"string"),read_only(this,"__filename__",t)}function InputBinaryFilePort(e,t){if("undefined"!==typeof this&&!(this instanceof InputBinaryFilePort)||"undefined"===typeof this)return new InputBinaryFilePort(e,t);InputByteVectorPort.call(this,e),typecheck("InputBinaryFilePort",t,"string"),read_only(this,"__filename__",t)}function OutputBinaryFilePort(e,t){if("undefined"!==typeof this&&!(this instanceof OutputBinaryFilePort)||"undefined"===typeof this)return new OutputBinaryFilePort(e,t);var r,n;typecheck("OutputBinaryFilePort",e,"string"),read_only(this,"__filename__",e),read_only(this,"_fd",t.valueOf(),{hidden:!0}),read_only(this,"__type__",binary_port),this.write=function(e){var t,o=this;return typecheck("write",e,["number","uint8array"]),r||(r=this.internal("fs")),n||(n=this.internal("Buffer")),t=LNumber.isNumber(e)?n.from([e.valueOf()]):n.from(Array.from(e)),new Promise((function(e,n){r.write(o._fd,t,(function(t){t?n(t):e()}))}))}}LRational.prototype=Object.create(LNumber.prototype),LRational.prototype.constructor=LRational,LRational.prototype.constant=function(e,t){Object.defineProperty(this,"__num__",{value:e,enumerable:!0}),Object.defineProperty(this,"__denom__",{value:t,enumerable:!0}),Object.defineProperty(this,"__type__",{value:"rational",enumerable:!0})},LRational.prototype.serialize=function(){return{num:this.__num__,denom:this.__denom__}},LRational.prototype.pow=function(e){var t=e.cmp(0);if(0===t)return LNumber(1);if(-1===t)return e=e.sub(),LRational({num:this.__denom__.pow(e),denom:this.__num__.pow(e)});var r=this;for(e=e.valueOf();e>1;)r=r.mul(this),e--;return r},LRational.prototype.sqrt=function(){var e=this.__num__.sqrt(),t=this.__denom__.sqrt();return e instanceof LFloat&&(e.toRational(),_readOnlyError("num")),t instanceof LFloat&&(t.toRational(),_readOnlyError("denom")),LRational({num:e,denom:t})},LRational.prototype.abs=function(){var e=this.__num__,t=this.__denom__;return-1===e.cmp(0)&&(e=e.sub()),1!==t.cmp(0)&&(t=t.sub()),LRational({num:e,denom:t})},LRational.prototype.cmp=function(e){return LNumber(this.valueOf(),!0).cmp(e)},LRational.prototype.toString=function(){var e,t,r=this.__num__.gcd(this.__denom__);if(0!==r.cmp(1)?((e=this.__num__.div(r))instanceof LRational&&(e=LNumber(e.valueOf(!0))),(t=this.__denom__.div(r))instanceof LRational&&(t=LNumber(t.valueOf(!0)))):(e=this.__num__,t=this.__denom__),this.cmp(0)<0){if(0===e.abs().cmp(t.abs()))return e.toString()}else if(0===e.cmp(t))return e.toString();return e.toString()+"/"+t.toString()},LRational.prototype.valueOf=function(e){return 0===this.__denom__.cmp(0)?this.__num__.cmp(0)<0?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY:e?LNumber._ops["/"](this.__num__.value,this.__denom__.value):LFloat(this.__num__.valueOf()).div(this.__denom__.valueOf())},LRational.prototype.mul=function(e){if(e instanceof LNumber||(e=LNumber(e)),LNumber.isRational(e))return LRational({num:this.__num__.mul(e.__num__),denom:this.__denom__.mul(e.__denom__)});var t=LNumber.coerce(this,e),r=_slicedToArray(t,2),n=r[0],o=r[1];return n.mul(o)},LRational.prototype.div=function(e){if(e instanceof LNumber||(e=LNumber(e)),LNumber.isRational(e))return LRational({num:this.__num__.mul(e.__denom__),denom:this.__denom__.mul(e.__num__)});var t=LNumber.coerce(this,e),r=_slicedToArray(t,2),n=r[0],o=r[1];return n.div(o)},LRational.prototype._op=function(e,t){return this[rev_mapping[e]](t)},LRational.prototype.sub=function(e){if("undefined"===typeof e)return this.mul(-1);if(e instanceof LNumber||(e=LNumber(e)),LNumber.isRational(e)){var t=e.__num__.sub(),r=e.__denom__;return this.add(LRational({num:t,denom:r}))}e=e instanceof LNumber?e.sub():LNumber(e).sub();var n=LNumber.coerce(this,e),o=_slicedToArray(n,2),i=o[0],a=o[1];return i.add(a)},LRational.prototype.add=function(e){if(e instanceof LNumber||(e=LNumber(e)),LNumber.isRational(e)){var t,r,n=this.__denom__,o=e.__denom__,i=this.__num__,a=e.__num__;return n!==o?(r=o.mul(i).add(a.mul(n)),t=n.mul(o)):(r=i.add(a),t=n),LRational({num:r,denom:t})}if(LNumber.isFloat(e))return LFloat(this.valueOf()).add(e);var u=LNumber.coerce(this,e),c=_slicedToArray(u,2),s=c[0],l=c[1];return s.add(l)},LBigInteger.prototype=Object.create(LNumber.prototype),LBigInteger.prototype.constructor=LBigInteger,LBigInteger.bn_op={"+":"iadd","-":"isub","*":"imul","/":"idiv","%":"imod","|":"ior","&":"iand","~":"inot","<<":"ishrn",">>":"ishln"},LBigInteger.prototype.serialize=function(){return this.__value__.toString()},LBigInteger.prototype._op=function(e,t){if("undefined"===typeof t)return LNumber.isBN(this.__value__)?(e=LBigInteger.bn_op[e],LBigInteger(this.__value__.clone()[e](),!1)):LBigInteger(LNumber._ops[e](this.__value__),!0);if(LNumber.isBN(this.__value__)&&LNumber.isBN(t.__value__))return e=LBigInteger.bn_op[e],LBigInteger(this.__value__.clone()[e](t),!1);var r=LNumber._ops[e](this.__value__,t.__value__);return"/"===e?0===this.op("%",t).cmp(0)?LNumber(r):LRational({num:this,denom:t}):LBigInteger(r,!0)},LBigInteger.prototype.sqrt=function(){var e,t=this.cmp(0)<0;return LNumber.isNative(this.__value__)?e=LNumber(Math.sqrt(t?-this.valueOf():this.valueOf())):LNumber.isBN(this.__value__)&&(e=t?this.__value__.neg().sqrt():this.__value__.sqrt()),t?LComplex({re:0,im:e}):e},LNumber.NaN=LNumber(NaN),InputPort.prototype._make_defaults=function(){this.read=this._with_parser((function(e){return e.read_object()})),this.read_line=this._with_parser((function(e){return e.__lexer__.read_line()})),this.read_char=this._with_parser((function(e){return e.__lexer__.read_char()})),this.read_string=this._with_parser((function(e,t){return LNumber.isInteger(t)||typeErrorMessage("read-string",LNumber.getType(t),"integer"),e.__lexer__.read_string(t.valueOf())})),this.peek_char=this._with_parser((function(e){return e.__lexer__.peek_char()}))},InputPort.prototype._with_init_parser=function(e,t){var r=this;return function(){var n=_asyncToGenerator(regenerator.mark((function n(){var o,i,a,u,c=arguments;return regenerator.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.call(r);case 2:for(o=n.sent,i=c.length,a=new Array(i),u=0;u<i;u++)a[u]=c[u];return n.abrupt("return",t.apply(void 0,[o].concat(a)));case 5:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}()},InputPort.prototype.is_open=function(){return null!==this._with_parser},InputPort.prototype.close=function(){var e=this;this.__parser__=null,this._with_parser=null,["read","close","read_char","peek-char","read_line"].forEach((function(t){e[t]=function(){throw new Error("input-port: port is closed")}})),this.char_ready=function(){return!1}},InputPort.prototype.toString=function(){return"#<input-port>"},OutputPort.prototype.is_open=function(){return!0!==this._closed},OutputPort.prototype.close=function(){Object.defineProperty(this,"_closed",{get:function(){return!0},set:function(){},configurable:!1,enumerable:!1}),this.write=function(){throw new Error("output-port: port is closed")}},OutputPort.prototype.toString=function(){return"#<output-port>"},OutputStringPort.prototype=Object.create(OutputPort.prototype),OutputStringPort.prototype.constructor=OutputStringPort,OutputStringPort.prototype.toString=function(){return"#<output-port (string)>"},OutputStringPort.prototype.valueOf=function(){return this.__buffer__.map((function(e){return e.valueOf()})).join("")},OutputFilePort.prototype=Object.create(OutputPort.prototype),OutputFilePort.prototype.constructor=OutputFilePort,OutputFilePort.prototype.fs=function(){return this._fs||(this._fs=this.internal("fs")),this._fs},OutputFilePort.prototype.internal=function(e){return user_env.get("**internal-env**").get(e)},OutputFilePort.prototype.close=function(){var e=this;return new Promise((function(t,r){e.fs().close(e._fd,(function(n){n?r(n):(read_only(e,"_fd",null,{hidden:!0}),OutputPort.prototype.close.call(e),t())}))}))},OutputFilePort.prototype.toString=function(){return"#<output-port ".concat(this.__filename__,">")},InputStringPort.prototype.char_ready=function(){return!0},InputStringPort.prototype=Object.create(InputPort.prototype),InputStringPort.prototype.constructor=InputStringPort,InputStringPort.prototype.toString=function(){return"#<input-port (string)>"},InputByteVectorPort.prototype=Object.create(InputPort.prototype),InputByteVectorPort.prototype.constructor=InputByteVectorPort,InputByteVectorPort.prototype.toString=function(){return"#<input-port (bytevector)>"},InputByteVectorPort.prototype.close=function(){var e=this;read_only(this,"__vector__",_nil),["read_u8","close","peek_u8","read_u8_vector"].forEach((function(t){e[t]=function(){throw new Error("Input-binary-port: port is closed")}})),this.char_ready=function(){return!1}},InputByteVectorPort.prototype.u8_ready=function(){return!0},InputByteVectorPort.prototype.peek_u8=function(){return this.__index__>=this.__vector__.length?eof:this.__vector__[this.__index__]},InputByteVectorPort.prototype.skip=function(){this.__index__<=this.__vector__.length&&++this.__index__},InputByteVectorPort.prototype.read_u8=function(){var e=this.peek_u8();return this.skip(),e},InputByteVectorPort.prototype.read_u8_vector=function(e){return"undefined"===typeof e?e=this.__vector__.length:e>this.__index__+this.__vector__.length&&(e=this.__index__+this.__vector__.length),this.peek_u8()===eof?eof:this.__vector__.slice(this.__index__,e)},OutputByteVectorPort.prototype=Object.create(OutputPort.prototype),OutputByteVectorPort.prototype.constructor=OutputByteVectorPort,OutputByteVectorPort.prototype.close=function(){OutputPort.prototype.close.call(this),read_only(this,"_buffer",null,{hidden:!0})},OutputByteVectorPort.prototype._close_guard=function(){if(this._closed)throw new Error("output-port: binary port is closed")},OutputByteVectorPort.prototype.write_u8=function(e){typecheck("OutputByteVectorPort::write_u8",e,"number"),this.write(e)},OutputByteVectorPort.prototype.write_u8_vector=function(e){typecheck("OutputByteVectorPort::write_u8_vector",e,"uint8array"),this.write(e)},OutputByteVectorPort.prototype.toString=function(){return"#<output-port (bytevector)>"},OutputByteVectorPort.prototype.valueOf=function(){return this.__buffer__},InputFilePort.prototype=Object.create(InputStringPort.prototype),InputFilePort.prototype.constructor=InputFilePort,InputFilePort.prototype.toString=function(){return"#<input-port (".concat(this.__filename__,")>")},InputBinaryFilePort.prototype=Object.create(InputByteVectorPort.prototype),InputBinaryFilePort.prototype.constructor=InputBinaryFilePort,InputBinaryFilePort.prototype.toString=function(){return"#<input-binary-port (".concat(this.__filename__,")>")},OutputBinaryFilePort.prototype=Object.create(OutputFilePort.prototype),OutputBinaryFilePort.prototype.constructor=OutputBinaryFilePort,OutputBinaryFilePort.prototype.write_u8=function(e){typecheck("OutputByteVectorPort::write_u8",e,"number"),this.write(e)},OutputBinaryFilePort.prototype.write_u8_vector=function(e){typecheck("OutputByteVectorPort::write_u8_vector",e,"uint8array"),this.write(e)};var binary_port=Symbol.for("binary"),text_port=Symbol.for("text"),eof=new EOF;function EOF(){}function Interpreter(e){var t=arguments.length>1&&arguments[1]!==undefined$1?arguments[1]:{},r=t.stderr,n=t.stdin,o=t.stdout,i=_objectWithoutProperties(t,_excluded2);if("undefined"!==typeof this&&!(this instanceof Interpreter)||"undefined"===typeof this)return new Interpreter(e,_objectSpread({stdin:n,stdout:o,stderr:r},i));"undefined"===typeof e&&(e="anonymous"),this.__env__=user_env.inherit(e,i);var a="**interaction-environment-defaults**";this.set(a,get_props(i).concat(a));var u=internal_env.inherit("internal-".concat(e));is_port(n)&&u.set("stdin",n),is_port(r)&&u.set("stderr",r),is_port(o)&&u.set("stdout",o),set_interaction_env(this.__env__,u)}function LipsError(e,t){this.name="LipsError",this.message=e,this.args=t,this.stack=(new Error).stack}function Environment(e,t,r){1===arguments.length&&("object"===_typeof(arguments[0])?(e=arguments[0],t=null):"string"===typeof arguments[0]&&(e={},t=null,r=arguments[0])),this.__docs__=new Map,this.__env__=e,this.__parent__=t,this.__name__=r||"anonymous"}function Value(e){if("undefined"!==typeof this&&!(this instanceof Value)||"undefined"===typeof this)return new Value(e);this.value=e}function Values(e){return e.length&&1===e.length?e[0]:("undefined"===typeof this||this instanceof Values)&&"undefined"!==typeof this?void(this.__values__=e):new Values(e)}function quote(e){return is_promise(e)?e.then(quote):((e instanceof Pair||e instanceof LSymbol)&&(e[__data__]=!0),e)}EOF.prototype.toString=function(){return"#<eof>"},Interpreter.prototype.exec=function(e){var t=arguments.length>1&&arguments[1]!==undefined$1&&arguments[1],r=arguments.length>2&&arguments[2]!==undefined$1?arguments[2]:null;return typecheck("Interpreter::exec",e,["string","array"],1),typecheck("Interpreter::exec",t,"boolean",2),global_env.set("**interaction-environment**",this.__env__),null===r&&(r=this.__env__),exec(e,r,!!t&&r)},Interpreter.prototype.get=function(e){var t=this.__env__.get(e);return is_function(t)?t.bind(this.__env__):t},Interpreter.prototype.set=function(e,t){return this.__env__.set(e,t)},Interpreter.prototype.constant=function(e,t){return this.__env__.constant(e,t)},LipsError.prototype=new Error,LipsError.prototype.constructor=LipsError,Environment.prototype.list=function(){return get_props(this.__env__)},Environment.prototype.fs=function(){return this.get("**fs**")},Environment.prototype.unset=function(e){e instanceof LSymbol&&(e=e.valueOf()),e instanceof LString&&(e=e.valueOf()),delete this.__env__[e]},Environment.prototype.inherit=function(e){var t=arguments.length>1&&arguments[1]!==undefined$1?arguments[1]:{};return"object"===_typeof(e)&&(t=e),e&&"object"!==_typeof(e)||(e="child of "+(this.__name__||"unknown")),new Environment(t||{},this,e)},Environment.prototype.doc=function(e){var t=arguments.length>1&&arguments[1]!==undefined$1?arguments[1]:null,r=arguments.length>2&&arguments[2]!==undefined$1&&arguments[2];return e instanceof LSymbol&&(e=e.__name__),e instanceof LString&&(e=e.valueOf()),t?(r||(t=trim_lines(t)),this.__docs__.set(e,t),this):this.__docs__.has(e)?this.__docs__.get(e):this.__parent__?this.__parent__.doc(e):void 0},Environment.prototype.newFrame=function(e,t){var r=this.inherit("__frame__");return r.set("parent.frame",doc("parent.frame",(function(){var e=arguments.length>0&&arguments[0]!==undefined$1?arguments[0]:1;e=e.valueOf();var t=r.__parent__;if(!(t instanceof Environment))return _nil;if(e<=0)return t;var n=t.get("parent.frame");return n(e-1)}),global_env.__env__["parent.frame"].__doc__)),t.callee=e,r.set("arguments",t),r},Environment.prototype._lookup=function(e){return e instanceof LSymbol&&(e=e.__name__),e instanceof LString&&(e=e.valueOf()),this.__env__.hasOwnProperty(e)?Value(this.__env__[e]):this.__parent__?this.__parent__._lookup(e):void 0},Environment.prototype.toString=function(){return"#<environment:"+this.__name__+">"},Environment.prototype.clone=function(){var e=this,t={};return Object.keys(this.__env__).forEach((function(r){t[r]=e.__env__[r]})),new Environment(t,this.__parent__,this.__name__)},Environment.prototype.merge=function(e){var t=arguments.length>1&&arguments[1]!==undefined$1?arguments[1]:"merge";return typecheck("Environment::merge",e,"environment"),this.inherit(t,e.__env__)},Value.isUndefined=function(e){return e instanceof Value&&"undefined"===typeof e.value},Value.prototype.valueOf=function(){return this.value},Values.prototype.toString=function(){return this.__values__.map((function(e){return toString(e)})).join("\n")},Values.prototype.valueOf=function(){return this.__values__},Environment.prototype.get=function(e){var t=arguments.length>1&&arguments[1]!==undefined$1?arguments[1]:{};typecheck("Environment::get",e,["symbol","string"]);var r=t.throwError,n=void 0===r||r,o=e;(o instanceof LSymbol||o instanceof LString)&&(o=o.valueOf());var i=this._lookup(o);if(i instanceof Value)return Value.isUndefined(i)?undefined$1:patch_value(i.valueOf());if("string"===typeof o){var a=o.split(".").filter(Boolean);if(a.length>0){var u=_toArray(a),c=u[0],s=u.slice(1);if(i=this._lookup(c),s.length)try{return i instanceof Value?i=i.valueOf():is_function(i=get(root,c))&&(i=unbind(i)),get.apply(void 0,[i].concat(_toConsumableArray(s)))}catch(l){}else if(i instanceof Value)return patch_value(i.valueOf())}i=get(root,o)}if("undefined"!==typeof i)return i;if(n)throw new Error("Unbound variable `"+o.toString()+"'")},Environment.prototype.set=function(e,t){var r=arguments.length>2&&arguments[2]!==undefined$1?arguments[2]:null;return typecheck("Environment::set",e,["string","symbol"]),LNumber.isNumber(t)&&(t=LNumber(t)),e instanceof LSymbol&&(e=e.__name__),e instanceof LString&&(e=e.valueOf()),this.__env__[e]=t,r&&this.doc(e,r),this},Environment.prototype.constant=function(e,t){var r=this;if(this.__env__.hasOwnProperty(e))throw new Error("Environment::constant: ".concat(e," already exists"));if(1===arguments.length&&is_plain_object(arguments[0])){var n=arguments[0];Object.keys(n).forEach((function(t){r.constant(e,n[t])}))}else Object.defineProperty(this.__env__,e,{value:t,enumerable:!0});return this},Environment.prototype.has=function(e){return this.__env__.hasOwnProperty(e)},Environment.prototype.ref=function(e){for(var t=this;t;){if(t.has(e))return t;t=t.__parent__}},Environment.prototype.parents=function(){for(var e=this,t=[];e;)t.unshift(e),e=e.__parent__;return t};var native_lambda=parse(tokenize('(lambda ()\n                                          "[native code]"\n                                          (throw "Invalid Invocation"))'))[0],get=doc("get",(function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o;is_function(e)&&"symbol"!==_typeof(r[0])&&(e=unbind(e));for(var i=r.length;r.length;){var a,u=r.shift(),c=unbox(u);if("undefined"===typeof(o="then"===c&&e instanceof QuotedPromise?QuotedPromise.prototype.then:"__code__"===c&&is_function(e)&&"undefined"===typeof e.__code__?native_lambda:e[c])){if(r.length)throw new Error("Try to get ".concat(r[0]," from undefined"));return o}r.length-1<i&&(a=e),e=o=patch_value(o,a)}return o}),"(. obj . args)\n        (get obj . args)\n\n        Function use object as base and keep using arguments to get the\n        property of JavaScript object. Arguments need to be a strings.\n        e.g. `(. console \"log\")` if you use any function inside LIPS is\n        will be weakly bind (can be rebind), so you can call this log function\n        without problem unlike in JavaScript when you use\n       `var log = console.log`.\n       `get` is an alias because . don't work in every place, e.g. you can't\n        pass it as argument.");function internal(e,t){return interaction(e,"**internal-env**").get(t)}function interaction(e,t){return e.get("**interaction-environment**").get(t)}var internal_env=new Environment({stdout:new OutputPort((function(){var e;(e=console).log.apply(e,arguments)})),stderr:new OutputPort((function(){var e;(e=console).error.apply(e,arguments)})),stdin:InputPort((function(){return Promise.resolve(prompt(""))})),"letter-unicode-regex":/(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08C7\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\u9FFC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7CA\uA7F5-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82C[\uDC00-\uDD1E\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDEC0-\uDEEB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDD\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/,"numeral-unicode-regex":/(?:[0-9\xB2\xB3\xB9\xBC-\xBE\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u09F4-\u09F9\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0B72-\u0B77\u0BE6-\u0BF2\u0C66-\u0C6F\u0C78-\u0C7E\u0CE6-\u0CEF\u0D58-\u0D5E\u0D66-\u0D78\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F33\u1040-\u1049\u1090-\u1099\u1369-\u137C\u16EE-\u16F0\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1946-\u194F\u19D0-\u19DA\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\u2070\u2074-\u2079\u2080-\u2089\u2150-\u2182\u2185-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2CFD\u3007\u3021-\u3029\u3038-\u303A\u3192-\u3195\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\uA620-\uA629\uA6E6-\uA6EF\uA830-\uA835\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19]|\uD800[\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDEE1-\uDEFB\uDF20-\uDF23\uDF41\uDF4A\uDFD1-\uDFD5]|\uD801[\uDCA0-\uDCA9]|\uD802[\uDC58-\uDC5F\uDC79-\uDC7F\uDCA7-\uDCAF\uDCFB-\uDCFF\uDD16-\uDD1B\uDDBC\uDDBD\uDDC0-\uDDCF\uDDD2-\uDDFF\uDE40-\uDE48\uDE7D\uDE7E\uDE9D-\uDE9F\uDEEB-\uDEEF\uDF58-\uDF5F\uDF78-\uDF7F\uDFA9-\uDFAF]|\uD803[\uDCFA-\uDCFF\uDD30-\uDD39\uDE60-\uDE7E\uDF1D-\uDF26\uDF51-\uDF54\uDFC5-\uDFCB]|\uD804[\uDC52-\uDC6F\uDCF0-\uDCF9\uDD36-\uDD3F\uDDD0-\uDDD9\uDDE1-\uDDF4\uDEF0-\uDEF9]|\uD805[\uDC50-\uDC59\uDCD0-\uDCD9\uDE50-\uDE59\uDEC0-\uDEC9\uDF30-\uDF3B]|\uD806[\uDCE0-\uDCF2\uDD50-\uDD59]|\uD807[\uDC50-\uDC6C\uDD50-\uDD59\uDDA0-\uDDA9\uDFC0-\uDFD4]|\uD809[\uDC00-\uDC6E]|\uD81A[\uDE60-\uDE69\uDF50-\uDF59\uDF5B-\uDF61]|\uD81B[\uDE80-\uDE96]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDFCE-\uDFFF]|\uD838[\uDD40-\uDD49\uDEF0-\uDEF9]|\uD83A[\uDCC7-\uDCCF\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9])/,"space-unicode-regex":/[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]/},undefined$1,"internal"),nan=LNumber(NaN),constants={true:!0,false:!1,"#true":!0,"#false":!1,"#t":!0,"#f":!1,nil:_nil,null:null,NaN:nan,"+nan.0":nan,"-nan.0":nan},global_env=new Environment({eof:eof,undefined:undefined$1,"peek-char":doc("peek-char",(function(){var e=arguments.length>0&&arguments[0]!==undefined$1?arguments[0]:null;return null===e&&(e=internal(this,"stdin")),typecheck_text_port("peek-char",e,"input-port"),e.peek_char()}),"(peek-char port)\n\n            Function get character from string port or EOF object if no more\n            data in string port."),"read-line":doc("read-line",(function(){var e=arguments.length>0&&arguments[0]!==undefined$1?arguments[0]:null;return null===e&&(e=internal(this,"stdin")),typecheck_text_port("read-line",e,"input-port"),e.read_line()}),"(read-char port)\n\n            Function read next character from input port."),"read-char":doc("read-char",(function(){var e=arguments.length>0&&arguments[0]!==undefined$1?arguments[0]:null;return null===e&&(e=internal(this,"stdin")),typecheck_text_port("read-char",e,"input-port"),e.read_char()}),"(read-char port)\n\n            Function read next character from input port."),read:doc("read",function(){var e=_asyncToGenerator(regenerator.mark((function e(){var t,r,n,o,i,a,u,c,s,l=arguments;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=l.length>0&&l[0]!==undefined$1?l[0]:null,!LString.isString(t)){e.next=35;break}r=!0,n=!1,e.prev=4,i=_asyncIterator(parse(t,this));case 6:return e.next=8,i.next();case 8:return a=e.sent,r=a.done,e.next=12,a.value;case 12:if(u=e.sent,r){e.next=19;break}return c=u,e.abrupt("return",c);case 16:r=!0,e.next=6;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(4),n=!0,o=e.t0;case 25:if(e.prev=25,e.prev=26,r||null==i.return){e.next=30;break}return e.next=30,i.return();case 30:if(e.prev=30,!n){e.next=33;break}throw o;case 33:return e.finish(30);case 34:return e.finish(25);case 35:return typecheck_text_port("read",s=null===t?internal(this,"stdin"):t,"input-port"),e.abrupt("return",s.read.call(this));case 38:case"end":return e.stop()}}),e,this,[[4,21,25,35],[26,,30,34]])})));return function(){return e.apply(this,arguments)}}(),"(read [string])\n\n            Function if used with string will parse the string and return\n            list structure of LIPS code. If called without an argument it\n            will read string from standard input (using browser prompt or\n            user defined way) and call itself with that string (parse is)\n            function can be used together with eval to evaluate code from\n            string"),pprint:doc("pprint",(function(e){e instanceof Pair?(e=new lips.Formatter(e.toString(!0)).break().format(),global_env.get("display").call(global_env,e)):global_env.get("write").call(global_env,e),global_env.get("newline").call(global_env)}),"(pprint expression)\n\n           Pretty print list expression, if called with non-pair it just call\n           print function with passed argument."),print:doc("print",(function(){for(var e=global_env.get("display"),t=global_env.get("newline"),r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];n.forEach((function(r){e.call(global_env,r),t.call(global_env)}))}),"(print . args)\n\n            Function convert each argument to string and print the result to\n            standard output (by default it's console but it can be defined\n            it user code), the function call newline after printing each arg."),format:doc("format",(function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];typecheck("format",e,"string");var o=/(~[as%~])/g,i=e.match(/(~[as])/g);if(i&&i.length>r.length)throw new Error("Not enough arguments");var a=0,u=global_env.get("repr");if(i=(e=e.replace(o,(function(e){var t=e[1];if("~"===t)return"~";if("%"===t)return"\n";var n=r[a++];return"a"===t?u(n):u(n,!0)}))).match(/~([\S])/))throw new Error("format: Unrecognized escape seqence ".concat(i[1]));return e}),"(format string n1 n2 ...)\n\n            Function accepts string template and replacing any escape sequences\n            by arguments:\n\n            * ~a value as if printed with display\n            * ~s value as if printed with write\n            * ~% newline character\n            * ~~ literal tilde '~' is inserted\n\n            if there missing arguments or other escape character it throw exception."),display:doc("display",(function(e){var t=arguments.length>1&&arguments[1]!==undefined$1?arguments[1]:null;null===t?t=internal(this,"stdout"):typecheck("display",t,"output-port");var r=global_env.get("repr")(e);t.write.call(global_env,r)}),"(display arg [port])\n\n            Function send string to standard output or provied port."),"display-error":doc("display-error",(function(){for(var e=internal(this,"stderr"),t=global_env.get("repr"),r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];var i=n.map(t).join(" ");e.write.call(global_env,i),global_env.get("newline")(e)}),"(display-error . args)\n\n            Display error message."),"%same-functions":doc("%same-functions",(function(e,t){return!!is_function(e)&&!!is_function(t)&&unbind(e)===unbind(t)}),"(%same-functions a b)\n\n            Helper function that check if two bound functions are the same"),help:doc(new Macro("help",(function(e,t){var r,n,o=t.dynamic_scope,i=t.error;if(e.car instanceof LSymbol)r=e.car;else{if(!(e.car instanceof Pair&&e.car.car instanceof LSymbol)){o&&(o=this);var a=_evaluate(e.car,{env:this,error:i,dynamic_scope:o});return a&&a.__doc__?a.__doc__:void 0}r=e.car.car}var u=this.get(r);if(n=u&&u.__doc__)return n;var c=this.ref(r);return c&&(n=c.doc(r))?n:void 0})),"(help object)\n\n             Macro returns documentation for function or macro. You can save the function\n             or macro in variable and use it in context. But help for variable require\n             to pass the symbol itself."),cons:doc("cons",(function(e,t){return new Pair(e,t)}),"(cons left right)\n\n            Function return new Pair out of two arguments."),car:doc("car",(function(e){return typecheck("car",e,"pair"),e.car}),"(car pair)\n\n            Function returns car (head) of the list/pair."),cdr:doc("cdr",(function(e){return typecheck("cdr",e,"pair"),e.cdr}),"(cdr pair)\n\n            Function returns cdr (tail) of the list/pair."),"set!":doc(new Macro("set!",(function(e){var t=this,r=arguments.length>1&&arguments[1]!==undefined$1?arguments[1]:{},n=r.dynamic_scope,o=r.error;n&&(n=this);var i,a=this,u=_evaluate(e.cdr.car,{env:this,dynamic_scope:n,error:o});function c(e,t,r){return is_promise(e)?e.then((function(t){return c(e,t,r)})):is_promise(t)?t.then((function(t){return c(e,t,r)})):is_promise(r)?r.then((function(r){return c(e,t,r)})):(a.get("set-obj!").call(a,e,t,r),r)}if(u=resolve_promises(u),e.car instanceof Pair&&LSymbol.is(e.car.car,".")){var s=e.car.cdr.car,l=e.car.cdr.cdr.car,f=_evaluate(s,{env:this,dynamic_scope:n,error:o}),_=_evaluate(l,{env:this,dynamic_scope:n,error:o});return c(f,_,u)}if(!(e.car instanceof LSymbol))throw new Error("set! first argument need to be a symbol or dot accessor that evaluate to object.");var p=e.car.valueOf();return i=this.ref(e.car.__name__),unpromise(u,(function(e){if(!i){var r=p.split(".");if(r.length>1){var n=r.pop(),o=r.join("."),a=t.get(o,{throwError:!1});if(a)return void c(a,n,e)}throw new Error("Unbound variable `"+p+"'")}i.set(p,e)}))})),"(set! name value)\n\n            Macro that can be used to set the value of the variable (mutate)\n            it search the scope chain until it finds first non emtpy slot and set it."),"unset!":doc(new Macro("set!",(function(e){if(!(e.car instanceof LSymbol))throw new Error("unset! first argument need to be a symbol or dot accessor that evaluate to object.");var t=e.car,r=this.ref(t);r&&delete r.__env__[t.__name__]})),"(unset! name)\n\n            Function delete specified name from environment."),"set-car!":doc("set-car!",(function(e,t){typecheck("set-car!",e,"pair"),e.car=t}),"(set-car! obj value)\n\n            Function that set car (head) of the list/pair to specified value.\n            It can destroy the list. Old value is lost."),"set-cdr!":doc("set-cdr!",(function(e,t){typecheck("set-cdr!",e,"pair"),e.cdr=t}),"(set-cdr! obj value)\n\n            Function that set cdr (tail) of the list/pair to specified value.\n            It can destroy the list. Old value is lost."),"empty?":doc("empty?",(function(e){return"undefined"===typeof e||e===_nil}),"(empty? object)\n\n            Function return true if value is undfined empty list."),gensym:doc("gensym",gensym,"(gensym)\n\n             Function generate unique symbol, to use with macros as meta name."),load:doc("load",(function(e,t){typecheck("load",e,"string");var r=this;"__frame__"===r.__name__&&(r=r.__parent__),t instanceof Environment||(t=r===global_env?r:this.get("**interaction-environment**"));var n="**module-path**",o=global_env.get(n,{throwError:!1});function i(e){return"buffer"===type(e)&&(e=e.toString()),(e=e.replace(/^#!.*/,"")).match(/\{/)&&(e=unserialize(e)),exec(e,t)}return(e=e.valueOf()).match(/.[^.]+$/)||(e+=".scm"),is_node()?new Promise((function(t,r){var a=nodeRequire("path");o&&(o=o.valueOf(),e=a.join(o,e)),global_env.set(n,a.dirname(e)),nodeRequire("fs").readFile(e,(function(e,a){if(e)r(e),global_env.set(n,o);else try{i(a).then((function(){t(),global_env.set(n,o)})).catch(r)}catch(u){r(u)}}))})):(o&&(o=o.valueOf(),e=o+"/"+e.replace(/^\.?\/?/,"")),root.fetch(e).then((function(e){return e.text()})).then((function(t){return global_env.set(n,e.replace(/\/[^/]*$/,"")),i(t)})).then((function(){})).finally((function(){global_env.set(n,o)})))}),"(load filename)\n            (load filename environment)\n\n            Function fetch the file and evaluate its content as LIPS code,\n            If second argument is provided and it's environment the evaluation\n            will happen in that environment."),do:doc(new Macro("do",function(){var e=_asyncToGenerator(regenerator.mark((function e(t,r){var n,o,i,a,u,c,s,l,f,_,p;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=r.dynamic_scope,o=r.error,i=this,n&&(n=i),a=i.inherit("do"),u=t.car,c=t.cdr.car,(s=t.cdr.cdr)!==_nil&&(s=new Pair(LSymbol("begin"),s)),l={env:i,dynamic_scope:n,error:o},f=u;case 10:if(f===_nil){e.next=21;break}return _=f.car,e.t0=a,e.t1=_.car,e.next=16,_evaluate(_.cdr.car,l);case 16:e.t2=e.sent,e.t0.set.call(e.t0,e.t1,e.t2),f=f.cdr,e.next=10;break;case 21:l={env:a,dynamic_scope:n,error:o},p=regenerator.mark((function e(){var t,r,n,o,i;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s===_nil){e.next=3;break}return e.next=3,lips.evaluate(s,l);case 3:t=u,r={};case 5:if(t===_nil){e.next=15;break}if((n=t.car).cdr.cdr===_nil){e.next=12;break}return e.next=10,_evaluate(n.cdr.cdr.car,l);case 10:o=e.sent,r[n.car.valueOf()]=o;case 12:t=t.cdr,e.next=5;break;case 15:i=Object.getOwnPropertySymbols(r),Object.keys(r).concat(i).forEach((function(e){a.set(e,r[e])}));case 17:case"end":return e.stop()}}),e)}));case 23:return e.next=25,_evaluate(c.car,l);case 25:if(e.t3=e.sent,!1!==e.t3){e.next=30;break}return e.delegateYield(p(),"t4",28);case 28:e.next=23;break;case 30:if(c.cdr===_nil){e.next=34;break}return e.next=33,_evaluate(c.cdr.car,l);case 33:return e.abrupt("return",e.sent);case 34:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()),"(do ((<var> <init> <next>)) (test expression) . body)\n\n             Iteration macro that evaluate the expression body in scope of the variables.\n             On Eeach loop it increase the variables according to next expression and run\n             test to check if the loop should continue. If test is signle call the macro\n             will not return anything. If the test is pair of expression and value the\n             macro will return that value after finish."),if:doc(new Macro("if",(function(e,t){var r=t.dynamic_scope,n=t.error;r&&(r=this);var o=this;if(e===_nil)throw new Error("too few expressions for `if`");return unpromise(_evaluate(e.car,{env:o,dynamic_scope:r,error:n}),(function(t){return _evaluate(!1===t?e.cdr.cdr.car:e.cdr.car,{env:o,dynamic_scope:r,error:n})}))})),"(if cond true-expr false-expr)\n\n            Macro evaluate condition expression and if the value is true, it\n            evaluate and return true expression if not it evaluate and return\n            false expression"),"let-env":new Macro("let-env",(function(e){var t=arguments.length>1&&arguments[1]!==undefined$1?arguments[1]:{},r=t.dynamic_scope,n=t.error;typecheck("let-env",e,"pair");var o=_evaluate(e.car,{env:this,dynamic_scope:r,error:n});return unpromise(o,(function(t){return typecheck("let-env",t,"environment"),_evaluate(Pair(LSymbol("begin"),e.cdr),{env:t,dynamic_scope:r,error:n})}))}),"(let-env env . body)\n\n            Special macro that evaluate body in context of given environment\n            object."),letrec:doc(let_macro(Symbol.for("letrec")),"(letrec ((a value-a) (b value-b)) body)\n\n             Macro that creates new environment, then evaluate and assign values to\n             names and then evaluate the body in context of that environment.\n             Values are evaluated sequentialy and next value can access to\n             previous values/names."),"letrec*":doc(let_macro(Symbol.for("letrec")),"(letrec* ((a value-a) (b value-b)) body)\n\n             Same as letrec but the order of execution of the binding is guaranteed,\n             so use can use recursive code as well as reference previous binding.\n             In LIPS both letrec and letrec* behave the same."),"let*":doc(let_macro(Symbol.for("let*")),"(let* ((a value-a) (b value-b)) body)\n\n             Macro similar to `let` but next argument get environment\n             from previous let variable, so they you can define one variable,\n             and use in next argument."),let:doc(let_macro(Symbol.for("let")),"(let ((a value-a) (b value-b)) body)\n\n             Macro that creates new environment, then evaluate and assign values to\n             names and then evaluate the body in context of that environment.\n             Values are evaluated sequentialy but you can't access\n             previous values/names when next are evaluated. You can only get them\n             from body of let expression."),"begin*":doc(pararel("begin*",(function(e){return e.pop()})),"(begin* . expr)\n\n             This macro is parallel version of begin. It evaluate each expression and\n             if it's a promise it will evaluate it in parallel and return value\n             of last expression."),begin:doc(new Macro("begin",(function(e,t){var r,n=Object.assign({},t),o=global_env.get("list->array")(e);return n.dynamic_scope&&(n.dynamic_scope=this),n.env=this,function e(){return o.length?unpromise(_evaluate(o.shift(),n),(function(t){return r=t,e()})):r}()})),"(begin . args)\n\n             Macro runs list of expression and return valuate of the list one.\n             It can be used in place where you can only have single exression,\n             like if expression."),ignore:new Macro("ignore",(function(e,t){var r=t.dynamic_scope,n={env:this,error:t.error};r&&(n.dynamic_scope=this),_evaluate(new Pair(new LSymbol("begin"),e),n)}),"(ignore expression)\n\n            Macro that will evaluate expression and swallow any promises that may\n            be created. It wil run and ignore any value that may be returned by\n            expression. The code should have side effects and/or when it's promise\n            it should resolve to undefined."),define:doc(Macro.defmacro("define",(function(e,t){var r=this;if(e.car instanceof Pair&&e.car.car instanceof LSymbol)return new Pair(new LSymbol("define"),new Pair(e.car.car,new Pair(new Pair(new LSymbol("lambda"),new Pair(e.car.cdr,e.cdr)))));if(!t.macro_expand){t.dynamic_scope&&(t.dynamic_scope=this),t.env=r;var n,o=e.cdr.car;return o instanceof Pair?(o=_evaluate(o,t),n=!0):o instanceof LSymbol&&(o=r.get(o)),typecheck("define",e.car,"symbol"),unpromise(o,(function(t){var o;r.__name__===Syntax.__merge_env__&&(r=r.__parent__),n&&(is_function(t)&&is_lambda(t)||t instanceof Syntax)&&(t.__name__=e.car.valueOf(),t.__name__ instanceof LString&&(t.__name__=t.__name__.valueOf())),e.cdr.cdr instanceof Pair&&LString.isString(e.cdr.cdr.car)&&(o=e.cdr.cdr.car.valueOf()),r.set(e.car,t,o,!0)}))}})),"(define name expression)\n             (define (function-name . args) body)\n\n             Macro for defining values. It can be used to define variables,\n             or function. If first argument is list it will create function\n             with name beeing first element of the list. The macro evalute\n             code `(define function (lambda args body))`"),"set-obj!":doc("set-obj!",(function(e,t,r){var n=_typeof(e);if(is_null(e)||"object"!==n&&"function"!==n){var o=typeErrorMessage("set-obj!",type(e),["object","function"]);throw new Error(o)}typecheck("set-obj!",t,["string","symbol","number"]),e=unbind(e),t=t.valueOf(),2===arguments.length?delete e[t]:is_prototype(e)&&is_function(r)?(e[t]=unbind(r),e[t][__prototype__]=!0):is_function(r)||is_native(r)||r===_nil?e[t]=r:e[t]=r?r.valueOf():r}),"(set-obj! obj key value)\n\n            Function set property of JavaScript object"),"null-environment":doc("null-environment",(function(){return global_env.inherit("null")}),"(null-environment)\n\n            Function return new base environment with std lib."),values:doc("values",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Values(t)}),"(values a1 a2 ...)\n\n            If called with more then one elment it will create special\n            Values object that can be used in call-with-values function"),"call-with-values":doc("call-with-values",(function(e,t){typecheck("call-with-values",e,"function",1),typecheck("call-with-values",t,"function",2);var r=e();return r instanceof Values?t.apply(void 0,_toConsumableArray(r.valueOf())):t(r)}),"(call-with-values producer consumer)\n\n            Calls its producer argument with no values and a continuation that,\n            when passed some values, calls the consumer procedure with those\n            values as arguments."),"current-environment":doc("current-environment",(function(){return"__frame__"===this.__name__?this.__parent__:this}),"(current-environment)\n\n            Function return current environement."),"parent.frame":doc("parent.frame",(function(){return user_env}),"(parent.frame)\n\n            Return parent environment if called from inside function.\n            If no parent frame found it return nil."),eval:doc("eval",(function(e,t){var r=this;return _evaluate(e,{env:t=t||this,error:function(e){var t=global_env.get("display-error");if(t.call(r,e.message),e.code){var n=e.code.map((function(e,t){return"[".concat(t+1,"]: ").concat(e)})).join("\n");t.call(r,n)}}})}),"(eval expr)\n            (eval expr environment)\n\n            Function evalute LIPS Scheme code."),lambda:new Macro("lambda",(function(e){var t,r=arguments.length>1&&arguments[1]!==undefined$1?arguments[1]:{},n=r.dynamic_scope,o=r.error,i=this;function a(){var r;r=(r=n&&this instanceof Environment?this:i).inherit("lambda");var u,c=e.car,s=0;"undefined"===typeof this||this instanceof Environment||(this&&!this.__instance__&&Object.defineProperty(this,"__instance__",{enumerable:!1,get:function(){return!0},set:function(){},configurable:!1}),r.set("this",this));for(var l=arguments.length,f=new Array(l),_=0;_<l;_++)f[_]=arguments[_];if(this instanceof Environment){var p={throwError:!1};r.set("arguments",this.get("arguments",p)),r.set("parent.frame",this.get("parent.frame",p))}else{var d=f.slice();d.callee=a,d.env=r,r.set("arguments",d)}if(c instanceof LSymbol||c!==_nil)for(;;){if(c.car!==_nil){if(c instanceof LSymbol){u=quote(Pair.fromArray(f.slice(s),!1)),r.__env__[c.__name__]=u;break}u=f[s],r.__env__[c.car.__name__]=u}if(c.cdr===_nil)break;s++,c=c.cdr}n&&(n=r);var m=t?e.cdr.cdr:e.cdr,h=new Pair(new LSymbol("begin"),m);return _evaluate(h,{env:r,dynamic_scope:n,error:o})}e.cdr instanceof Pair&&LString.isString(e.cdr.car)&&e.cdr.cdr!==_nil&&(t=e.cdr.car.valueOf());var u=e.car instanceof Pair?e.car.length():null;return a.__code__=new Pair(new LSymbol("lambda"),e),a[__lambda__]=!0,e.car instanceof Pair?doc(set_fn_length(a,u),t,!0):doc(a,t,!0)}),"(lambda (a b) body)\n            (lambda args body)\n            (lambda (a b . rest) body)\n\n            Macro lambda create new anonymous function, if first element of the body\n            is string and there is more elements it will be documentation, that can\n            be read using (help fn)"),macroexpand:new Macro("macroexpand",macro_expand()),"macroexpand-1":new Macro("macroexpand-1",macro_expand(!0)),"define-macro":doc(new Macro(macro,(function(e,t){var r=t.dynamic_scope,n=t.error;if(e.car instanceof Pair&&e.car.car instanceof LSymbol){var o,i=e.car.car.__name__;LString.isString(e.cdr.car)&&e.cdr.cdr instanceof Pair&&(o=e.cdr.car.valueOf());var a=Macro.defmacro(i,(function(t){for(var i=new Environment({},this,"defmacro"),a=e.car.cdr,u=t;a!==_nil;){if(a instanceof LSymbol){i.__env__[a.__name__]=u;break}if(a.car!==_nil&&(u===_nil?i.__env__[a.car.__name__]=_nil:(u.car instanceof Pair&&(u.car[__data__]=!0),i.__env__[a.car.__name__]=u.car)),a.cdr===_nil)break;u!==_nil&&(u=u.cdr),a=a.cdr}r&&(r=i);var c={env:i,dynamic_scope:r,error:n};if(e.cdr instanceof Pair)return unpromise((o?e.cdr.cdr:e.cdr).reduce((function(e,t){return _evaluate(t,c)})),(function(e){return"object"===_typeof(e)&&delete e[__data__],e}))}),o,!0);a.__code__=new Pair(new LSymbol("define-macro"),e),this.set(i,a)}})),"(define-macro (name . args) body)\n\n             Meta macro, macro that create new macros, if return value is list structure\n             it will be evaluated when macro is invoked. You can use quasiquote ` and\n             unquote , and unquote-splicing ,@ inside to create expression that will be\n             evaluated on runtime. Macros works like this: if you pass any expression to\n             macro the arguments will not be evaluated unless macro itself evaluate it.\n             Because of this macro can manipulate expression (arguments) as lists."),"syntax-rules":new Macro("syntax-rules",(function(e,t){var r=t.dynamic_scope,n=t.error,o=this;function i(e){for(var t=[];e!==_nil;){var r=e.car;t.push(r.valueOf()),e=e.cdr}return t}function a(e){for(;e!==_nil;){if(!(e.car instanceof LSymbol))throw new Error("syntax-rules: wrong identifier");e=e.cdr}}e.car instanceof LSymbol?a(e.cdr.car):a(e.car);var u=new Syntax((function(t,a){var u=a.macro_expand,c=o.inherit("syntax");r&&(r=c);var s=this;s.__name__===Syntax.__merge_env__&&(Object.getOwnPropertySymbols(s.__env__).forEach((function(e){s.__parent__.set(e,s.__env__[e])})),s=s.__parent__);var l,f,_,p={env:c,dynamic_scope:r,error:n};for(e.car instanceof LSymbol?(l=e.car,_=i(e.cdr.car),f=e.cdr.cdr):(l="...",_=i(e.car),f=e.cdr);f!==_nil;){var d=f.car.car,m=f.car.cdr.car;log(d);var h=extract_patterns(d,t,_,l,{expansion:this,define:o});if(h){is_debug()&&(console.log(JSON.stringify(symbolize(h),!0,2)),console.log("PATTERN: "+d.toString(!0)),console.log("MACRO: "+t.toString(!0)));var y=[],v=transform_syntax({bindings:h,expr:m,symbols:_,scope:c,lex_scope:s,names:y,ellipsis:l});v&&(m=v);var b=s.merge(c,Syntax.__merge_env__);return u?{expr:m,scope:b}:clear_gensyms(_evaluate(m,_objectSpread(_objectSpread({},p),{},{env:b})),y)}f=f.cdr}throw new Error("Invalid Syntax ".concat(t.toString(!0)))}),o);return u.__code__=e,u}),"(syntax-rules () (pattern expression) ...)\n\n            Base of Hygienic macro, it will return new syntax expander\n            that works like lisp macros."),quote:doc(new Macro("quote",(function(e){return quote(e.car)})),"(quote expression)\n\n             Macro that return single lips expression as data (it don't evaluate its\n             argument). It will return list of pairs if put in front of lips code.\n             And if put in fron of symbol it will return that symbol not value\n             associated with that name."),"unquote-splicing":doc("unquote-splicing",(function(){throw new Error("You can't call `unquote-splicing` outside of quasiquote")}),"(unquote-splicing code)\n\n            Special form to be used in quasiquote macro, parser is processing special\n            characters ,@ and create call to this pseudo function. It can be used\n            to evalute expression inside and return the value without parenthesis.\n            the value will be joined to the output list structure."),unquote:doc("unquote",(function(){throw new Error("You can't call `unquote` outside of quasiquote")}),"(unquote code)\n\n            Special form to be used in quasiquote macro, parser is processing special\n            characters , and create call to this pseudo function. It can be used\n            to evalute expression inside and return the value, the output is inserted\n            into list structure created by queasiquote."),quasiquote:Macro.defmacro("quasiquote",(function(e,t){var r=t.dynamic_scope,n=t.error,o=this;function i(e){return e instanceof Pair||is_plain_object(e)||Array.isArray(e)}function a(e,t){return e instanceof Pair?t!==_nil&&e.append(t):e=new Pair(e,t),e}function u(e){return!!e.filter((function(e){return e instanceof Pair&&LSymbol.is(e.car,/^(unquote|unquote-splicing)$/)})).length}function c(e,t,i){if(t<i)return new Pair(new Pair(e.car.car,l(e.car.cdr,t,i)),_nil);var u=[];return function t(i){var c=_evaluate(i.car,{env:o,dynamic_scope:r,error:n});return u.push(c),i.cdr instanceof Pair?t(i.cdr):unpromise(u,(function(t){if(t.some((function(e){return!(e instanceof Pair)}))){if(e.cdr instanceof Pair&&LSymbol.is(e.cdr.car,".")&&e.cdr.cdr instanceof Pair&&e.cdr.cdr.cdr===_nil)return e.cdr.cdr.car;if(!(e.cdr===_nil||e.cdr instanceof Pair))throw new Error("You can't splice atom inside list");if(t.length>1)throw new Error("You can't splice multiple atoms inside list");if(!(e.cdr instanceof Pair&&t[0]===_nil))return t[0]}t=t.map((function(e){return s.has(e)?e.clone():(s.add(e),e)}));var r=l(e.cdr,0,1);return r===_nil&&t[0]===_nil?undefined$1:unpromise(r,(function(e){if(t[0]===_nil)return e;if(1===t.length)return a(t[0],e);var r=t.reduce((function(e,t){return a(e,t)}));return a(r,e)}))}))}(e.car.cdr)}r&&(r=o);var s=new Set;function l(e,t,a){if(e instanceof Pair){if(e.car instanceof Pair){if(LSymbol.is(e.car.car,"unquote-splicing"))return c(e,t+1,a);if(LSymbol.is(e.car.car,"unquote")){if(t+2===a&&e.car.cdr instanceof Pair&&e.car.cdr.car instanceof Pair&&LSymbol.is(e.car.cdr.car.car,"unquote-splicing")){var u=e.car.cdr;return new Pair(new Pair(new LSymbol("unquote"),c(u,t+2,a)),_nil)}if(e.car.cdr instanceof Pair&&e.car.cdr.cdr!==_nil){if(e.car.cdr.car instanceof Pair){var s=[];return function e(t){return t===_nil?Pair.fromArray(s):unpromise(_evaluate(t.car,{env:o,dynamic_scope:r,error:n}),(function(r){return s.push(r),e(t.cdr)}))}(e.car.cdr)}return e.car.cdr}}}if(LSymbol.is(e.car,"quasiquote")){var f=l(e.cdr,t,a+1);return new Pair(e.car,f)}if(LSymbol.is(e.car,"quote"))return new Pair(e.car,l(e.cdr,t,a));if(LSymbol.is(e.car,"unquote")){if(++t<a)return new Pair(new LSymbol("unquote"),l(e.cdr,t,a));if(t>a)throw new Error("You can't call `unquote` outside of quasiquote");if(e.cdr instanceof Pair){if(e.cdr.cdr!==_nil){if(e.cdr.car instanceof Pair){var _=[];return function e(t){return t===_nil?Pair.fromArray(_):unpromise(_evaluate(t.car,{env:o,dynamic_scope:r,error:n}),(function(r){return _.push(r),e(t.cdr)}))}(e.cdr)}return e.cdr}return _evaluate(e.cdr.car,{env:o,dynamic_scope:r,error:n})}return e.cdr}return function(e,t){var r=arguments.length>2&&arguments[2]!==undefined$1?arguments[2]:i;if(e instanceof Pair){var n=e.car,o=e.cdr;return r(n)&&(n=t(n)),r(o)&&(o=t(o)),is_promise(n)||is_promise(o)?promise_all([n,o]).then((function(e){var t=_slicedToArray(e,2);return new Pair(t[0],t[1])})):new Pair(n,o)}return e}(e,(function(e){return l(e,t,a)}))}return is_plain_object(e)?function(e,t,i){var a={};return t++,Object.keys(e).forEach((function(u){var c=e[u];if(c instanceof Pair){if(LSymbol.is(c.car,"unquote-splicing"))throw new Error("You can't call `unquote-splicing` inside object");var s;s=t<i?l(c.cdr.car,t,i):_evaluate(c.cdr.car,{env:o,dynamic_scope:r,error:n}),a[u]=s}else a[u]=c})),Object.isFrozen(e)&&Object.freeze(a),a}(e,t,a):e instanceof Array?function(e,t,i){return e.reduce((function(e,a){if(!(a instanceof Pair))return e.push(a),e;if(LSymbol.is(a.car,"unquote-splicing")){var u;if(!((u=t+1<i?l(a.cdr,t+1,i):_evaluate(a.cdr.car,{env:o,dynamic_scope:r,error:n}))instanceof Pair))throw new Error("Expecting list ".concat(type(a)," found"));return e.concat(u.to_array())}return e.push(l(a,t,i)),e}),[])}(e,t,a):e}function f(e){e instanceof Pair&&(delete e[__data__],e.haveCycles("car")||f(e.car),e.haveCycles("cdr")||f(e.cdr))}return is_plain_object(e.car)&&!u(Object.values(e.car))||Array.isArray(e.car)&&!u(e.car)||e.car instanceof Pair&&!e.car.find("unquote")&&!e.car.find("unquote-splicing")&&!e.car.find("quasiquote")?quote(e.car):unpromise(l(e.car,0,1),(function(e){return f(e),quote(e)}))}),"(quasiquote list ,value ,@value)\n\n            Similar macro to `quote` but inside it you can use special\n            expressions unquote abbreviated to , that will evaluate expresion inside\n            and return its value or unquote-splicing abbreviated to ,@ that will\n            evaluate expression but return value without parenthesis (it will join)\n            the list with its value. Best used with macros but it can be used outside"),clone:doc("clone",(function(e){return typecheck("clone",e,"pair"),e.clone()}),"(clone list)\n\n            Function return clone of the list."),append:doc("append",(function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return r=r.map((function(e){return e instanceof Pair?e.clone():e})),(e=global_env.get("append!")).call.apply(e,[this].concat(_toConsumableArray(r)))}),"(append item ...)\n\n            Function will create new list with eac argument appended to the end.\n            It will always return new list and not modify it's arguments."),"append!":doc("append!",(function(){for(var e=global_env.get("list?"),t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return r.reduce((function(t,r){if(typecheck("append!",t,["nil","pair"]),(r instanceof Pair||r===_nil)&&!e(r))throw new Error("append!: Invalid argument, value is not a list");return is_null(r)?t:t===_nil?r===_nil?_nil:r:t.append(r)}),_nil)}),"(append! arg1 ...)\n\n             Destructive version of append, it modify the list in place. It return\n             new list where each argument is appened to the end. It may modify\n             lists added as arguments."),reverse:doc("reverse",(function(e){if(typecheck("reverse",e,["array","pair","nil"]),e===_nil)return _nil;if(e instanceof Pair){var t=global_env.get("list->array")(e).reverse();return global_env.get("array->list")(t)}if(e instanceof Array)return e.reverse();throw new Error(typeErrorMessage("reverse",type(e),"array or pair"))}),"(reverse list)\n\n            Function will reverse the list or array. If value is not a list\n            or array it will throw exception."),nth:doc("nth",(function(e,t){if(typecheck("nth",e,"number"),typecheck("nth",t,["array","pair"]),t instanceof Pair){for(var r=t,n=0;n<e;){if(!r.cdr||r.cdr===_nil||r.haveCycles("cdr"))return _nil;r=r.cdr,n++}return r.car}if(t instanceof Array)return t[e];throw new Error(typeErrorMessage("nth",type(t),"array or pair",2))}),"(nth index obj)\n\n            Function return nth element of the list or array. If used with different\n            value it will throw exception"),list:doc("list",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reverse().reduce((function(e,t){return new Pair(t,e)}),_nil)}),"(list . args)\n\n            Function create new list out of its arguments."),substring:doc("substring",(function(e,t,r){return typecheck("substring",e,"string"),typecheck("substring",t,"number"),typecheck("substring",r,["number","undefined"]),e.substring(t.valueOf(),r&&r.valueOf())}),"(substring string start end)\n\n            Function return part of the string starting at start ending with end."),concat:doc("concat",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.forEach((function(e,t){return typecheck("concat",e,"string",t+1)})),t.join("")}),"(concat . strings)\n\n            Function create new string by joining its arguments"),join:doc("join",(function(e,t){return typecheck("join",e,"string"),typecheck("join",t,["pair","nil"]),global_env.get("list->array")(t).join(e)}),"(join separator list)\n\n            Function return string by joining elements of the list"),split:doc("split",(function(e,t){return typecheck("split",e,["regex","string"]),typecheck("split",t,"string"),global_env.get("array->list")(t.split(e))}),"(split separator string)\n\n            Function create list by splitting string by separatar that can\n            be a string or regular expression."),replace:doc("replace",(function(e,t,r){return typecheck("replace",e,["regex","string"]),typecheck("replace",t,["string","function"]),typecheck("replace",r,"string"),r.replace(e,t)}),"(replace pattern replacement string)\n\n            Function change pattern to replacement inside string. Pattern can be string\n            or regex and replacement can be function or string."),match:doc("match",(function(e,t){typecheck("match",e,["regex","string"]),typecheck("match",t,"string");var r=t.match(e);return!!r&&global_env.get("array->list")(r)}),"(match pattern string)\n\n            function return match object from JavaScript as list or #f if not match."),search:doc("search",(function(e,t){return typecheck("search",e,["regex","string"]),typecheck("search",t,"string"),t.search(e)}),"(search pattern string)\n\n            Function return first found index of the pattern inside a string"),repr:doc("repr",(function(e,t){return toString(e,t)}),"(repr obj)\n\n            Function return string LIPS representation of an object as string."),"escape-regex":doc("escape-regex",(function(e){return typecheck("escape-regex",e,"string"),escape_regex(e.valueOf())}),"(escape-regex string)\n\n            Function return new string where all special operators used in regex,\n            are escaped with slash so they can be used in RegExp constructor\n            to match literal string"),env:doc("env",(function(e){e=e||this;var t,r=Object.keys(e.__env__).map(LSymbol);return t=r.length?Pair.fromArray(r):_nil,e.__parent__ instanceof Environment?global_env.get("env")(e.__parent__).append(t):t}),"(env)\n            (env obj)\n\n            Function return list of values (functions, macros and variables)\n            inside environment and it's parents."),new:doc("new",(function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=_construct(unbind(e),_toConsumableArray(r.map((function(e){return unbox(e)}))));return o}),"(new obj . args)\n\n            Function create new JavaScript instance of an object."),typecheck:doc(typecheck,"(typecheck label value type [position])\n\n             Function check type and throw exception if type don't match.\n             Type can be string or list of strings. Position optional argument\n             is used to created proper error message."),"unset-special!":doc("unset-special!",(function(e){typecheck("remove-special!",e,"string"),specials.remove(e.valueOf())}),"(unset-special! name)\n\n            Function remove special symbol from parser. Added by `set-special!`,\n            name must be a string."),"set-special!":doc("set-special!",(function(e,t){var r=arguments.length>2&&arguments[2]!==undefined$1?arguments[2]:specials.LITERAL;typecheck("set-special!",e,"string",1),typecheck("set-special!",t,"symbol",2),specials.append(e.valueOf(),t,r)}),'(set-special! symbol name [type])\n\n            Add special symbol to the list of transforming operators by the parser.\n            e.g.: `(add-special! "#" \'x)` will allow to use `#(1 2 3)` and it will be\n            transformed into (x (1 2 3)) so you can write x macro that will process\n            the list. 3rd argument is optional and it can be constant value\n            lips.specials.SPLICE if this constant is used it will transform\n            `#(1 2 3)` into (x 1 2 3) that is required by # that define vectors.'),get:get,".":get,unbind:doc(unbind,"(unbind fn)\n\n             Function remove bidning from function so you can get props from it."),type:doc(type,"(type object)\n\n             Function return type of an object as string."),debugger:doc("debugger",(function(){}),"(debugger)\n\n            Function stop JavaScript code in debugger."),in:doc("in",(function(e,t){return(e instanceof LSymbol||e instanceof LString||e instanceof LNumber)&&(e=e.valueOf()),e in unbox(t)}),"(in key value)\n\n            Function use is in operator to check if value is in object."),instanceof:doc("instanceof",(function(e,t){return t instanceof unbind(e)}),"(instanceof type obj)\n\n            Function check of object is instance of object."),"prototype?":doc("prototype?",is_prototype,"(prototype? obj)\n\n             Function check if value is JavaScript Object prototype."),"macro?":doc("macro?",(function(e){return e instanceof Macro}),"(macro? expression)\n\n            Function check if value is a macro."),"function?":doc("function?",is_function,"(function? expression)\n\n             Function check if value is a function."),"real?":doc("real?",(function(e){return"number"===type(e)&&(e instanceof LNumber?e.isFloat():LNumber.isFloat(e))}),"(real? number)\n\n            Function check if value is real number."),"number?":doc("number?",(function(e){return Number.isNaN(e)||LNumber.isNumber(e)}),"(number? expression)\n\n            Function check if value is a number or NaN value."),"string?":doc("string?",(function(e){return LString.isString(e)}),"(string? expression)\n\n            Function check if value is a string."),"pair?":doc("pair?",(function(e){return e instanceof Pair}),"(pair? expression)\n\n            Function check if value is a pair or list structure."),"regex?":doc("regex?",(function(e){return e instanceof RegExp}),"(regex? expression)\n\n            Function check if value is regular expression."),"null?":doc("null?",(function(e){return is_null(e)}),"(null? expression)\n\n            Function check if value is nulish."),"boolean?":doc("boolean?",(function(e){return"boolean"===typeof e}),"(boolean? expression)\n\n            Function check if value is boolean."),"symbol?":doc("symbol?",(function(e){return e instanceof LSymbol}),"(symbol? expression)\n\n            Function check if value is LIPS symbol"),"array?":doc("array?",(function(e){return e instanceof Array}),"(array? expression)\n\n            Function check if value is an arrray."),"object?":doc("object?",(function(e){return e!==_nil&&null!==e&&!(e instanceof LCharacter)&&!(e instanceof RegExp)&&!(e instanceof LString)&&!(e instanceof Pair)&&!(e instanceof LNumber)&&"object"===_typeof(e)&&!(e instanceof Array)}),"(object? expression)\n\n            Function check if value is an plain object."),flatten:doc("flatten",(function(e){return typecheck("flatten",e,"pair"),e.flatten()}),"(flatten list)\n\n            Return shallow list from tree structure (pairs)."),"array->list":doc("array->list",(function(e){return typecheck("array->list",e,"array"),Pair.fromArray(e)}),"(array->list array)\n\n            Function convert JavaScript array to LIPS list."),"tree->array":doc("tree->array",to_array("tree->array",!0),"(tree->array list)\n\n             Function convert LIPS list structure into JavaScript array."),"list->array":doc("list->array",to_array("list->array"),"(list->array list)\n\n             Function convert LIPS list into JavaScript array."),apply:doc("apply",(function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];typecheck("apply",e,"function",1);var o=r.pop();return typecheck("apply",o,["pair","nil"],r.length+2),r=r.concat(global_env.get("list->array").call(this,o)),e.apply(this,prepare_fn_args(e,r))}),"(apply fn list)\n\n            Function that call function with list of arguments."),length:doc("length",(function(e){return e?e instanceof Pair?LNumber(e.length()):"length"in e?LNumber(e.length):void 0:LNumber(0)}),"(length expression)\n\n            Function return length of the object, the object can be list\n            or any object that have length property."),"string->number":doc("string->number",(function(e){var t=arguments.length>1&&arguments[1]!==undefined$1?arguments[1]:10;if(typecheck("string->number",e,"string",1),typecheck("string->number",t,"number",2),e=e.valueOf(),t=t.valueOf(),e.match(rational_bare_re)||e.match(rational_re))return parse_rational(e,t);if(e.match(complex_bare_re)||e.match(complex_re))return parse_complex(e,t);var r=10===t&&!e.match(/e/i)||16===t;return e.match(int_bare_re)&&r||e.match(int_re)?parse_integer(e,t):!!e.match(float_re)&&parse_float(e)}),"(string->number number [radix])\n\n           Function convert string to number."),try:doc(new Macro("try",(function(e,t){var r=this,n=t.dynamic_scope,o=t.error;return new Promise((function(t,i){var a,u;if(LSymbol.is(e.cdr.car.car,"catch")?(a=e.cdr.car,e.cdr.cdr instanceof Pair&&LSymbol.is(e.cdr.cdr.car.car,"finally")&&(u=e.cdr.cdr.car)):LSymbol.is(e.cdr.car.car,"finally")&&(u=e.cdr.car),!u&&!a)throw new Error("try: invalid syntax");var c=t;u&&(c=function(e,t){c=i,unpromise(_evaluate(new Pair(new LSymbol("begin"),u.cdr),s),(function(){t(e)}))});var s={env:r,error:function(e){var i=r.inherit("try");if(a){i.set(a.cdr.car.car,e);var u={env:i,error:o};n&&(u.dynamic_scope=r),unpromise(_evaluate(new Pair(new LSymbol("begin"),a.cdr.cdr),u),(function(e){c(e,t)}))}else c(e,o)}};n&&(s.dynamic_scope=r);var l=_evaluate(e.car,s);is_promise(l)?l.then((function(e){c(e,t)})).catch(s.error):c(l,t)}))})),"(try expr (catch (e) code))\n             (try expr (catch (e) code) (finally code))\n             (try expr (finally code))\n\n             Macro execute user code and catch exception. If catch is provided\n             it's executed when expression expr throw error. If finally is provide\n             it's always executed at the end."),raise:doc("raise",(function(e){throw e}),"(raise obj)\n\n            Throws new exception with given object."),throw:doc("throw",(function(e){throw new Error(e)}),"(throw string)\n\n            Throws new expection."),find:doc("find",(function e(t,r){return typecheck("find",t,["regex","function"]),typecheck("find",r,["pair","nil"]),is_null(r)?_nil:unpromise(matcher("find",t)(r.car),(function(n){return n&&n!==_nil?r.car:e(t,r.cdr)}))}),"(find fn list)\n            (find regex list)\n\n            Higher order Function find first value for which function return true.\n            If called with regex it will create matcher function."),"for-each":doc("for-each",(function(e){var t;typecheck("for-each",e,"function");for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];n.forEach((function(e,t){typecheck("for-each",e,["pair","nil"],t+1)}));var i=(t=global_env.get("map")).call.apply(t,[this,e].concat(n));if(is_promise(i))return i.then((function(){}))}),"(for-each fn . lists)\n\n            Higher order function that call function `fn` by for each\n            value of the argument. If you provide more then one list as argument\n            it will take each value from each list and call `fn` function\n            with that many argument as number of list arguments."),map:doc("map",(function e(t){for(var r=this,n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];typecheck("map",t,"function");var a=global_env.get("list?");if(o.forEach((function(e,t){if(typecheck("map",e,["pair","nil"],t+1),e instanceof Pair&&!a.call(r,e))throw new Error("map: argument ".concat(t+1," is not a list"))})),0===o.length)return _nil;if(o.some((function(e){return e===_nil})))return _nil;var u=o.map((function(e){return e.car})),c=this.get("parent.frame"),s=this.newFrame(t,u);return s.set("parent.frame",c),unpromise(t.call.apply(t,[s].concat(_toConsumableArray(u))),(function(n){return unpromise(e.call.apply(e,[r,t].concat(_toConsumableArray(o.map((function(e){return e.cdr}))))),(function(e){return new Pair(n,e)}))}))}),"(map fn . lists)\n\n            Higher order function that call function `fn` by for each\n            value of the argument. If you provide more then one list as argument\n            it will take each value from each list and call `fn` function\n            with that many argument as number of list arguments. The return\n            values of the function call is acumulated in result list and\n            returned by the call to map."),"list?":doc("list?",(function(e){for(var t=e;;){if(t===_nil)return!0;if(!(t instanceof Pair))return!1;if(t.haveCycles("cdr"))return!1;t=t.cdr}}),'(list? obj)\n\n            Function test if value is proper linked list structure.\n            The car of each pair can be any value. It return false on cycles."'),some:doc("some",(function e(t,r){return typecheck("some",t,"function"),typecheck("some",r,["pair","nil"]),!is_null(r)&&unpromise(t(r.car),(function(n){return n||e(t,r.cdr)}))}),"(some fn list)\n\n            Higher order function that call argument on each element of the list.\n            It stops when function fn return true for a value if so it will\n            return true. If none of the values give true, the function return false"),fold:doc("fold",fold("fold",(function(e,t,r){for(var n=arguments.length,o=new Array(n>3?n-3:0),i=3;i<n;i++)o[i-3]=arguments[i];if(typecheck("fold",t,"function"),o.forEach((function(e,t){typecheck("fold",e,["pair","nil"],t+1)})),o.some((function(e){return e===_nil})))return r;var a=e.call.apply(e,[this,t,r].concat(_toConsumableArray(o.map((function(e){return e.cdr})))));return unpromise(a,(function(e){return t.apply(void 0,_toConsumableArray(o.map((function(e){return e.car}))).concat([e]))}))})),"(fold fn init . lists)\n\n             Function fold is reverse of the reduce. it call function `fn`\n             on each elements of the list and return single value.\n             e.g. it call (fn a1 b1 (fn a2 b2 (fn a3 b3 '())))\n             for: (fold fn '() alist blist)"),pluck:doc("pluck",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){if(0===(t=t.map((function(e){return e instanceof LSymbol?e.__name__:e}))).length)return _nil;if(1===t.length){var r=_slicedToArray(t,1)[0];return e[r]}var n={};return t.forEach((function(t){n[t]=e[t]})),n}}),"(pluck . string)\n\n            If called with single string it will return function that will return\n            key from object. If called with more then one argument function will\n            return new object by taking all properties from given object."),reduce:doc("reduce",fold("reduce",(function(e,t,r){for(var n=this,o=arguments.length,i=new Array(o>3?o-3:0),a=3;a<o;a++)i[a-3]=arguments[a];return typecheck("reduce",t,"function"),i.forEach((function(e,t){typecheck("reduce",e,["pair","nil"],t+1)})),i.some((function(e){return e===_nil}))?r:unpromise(t.apply(void 0,_toConsumableArray(i.map((function(e){return e.car}))).concat([r])),(function(r){return e.call.apply(e,[n,t,r].concat(_toConsumableArray(i.map((function(e){return e.cdr})))))}))})),"(reduce fn init list . lists)\n\n             Higher order function take each element of the list and call\n             the function with result of previous call or init and next element\n             on the list until each element is processed and return single value\n             as result of last call to `fn` function.\n             e.g. it call (fn a3 b3 (fn a2 b2 (fn a1 b1 init)))\n             for (reduce fn init alist blist)"),filter:doc("filter",(function(e,t){typecheck("filter",e,["regex","function"]),typecheck("filter",t,["pair","nil"]);var r=global_env.get("list->array")(t),n=[],o=matcher("filter",e);return function e(t){if(t===r.length)return Pair.fromArray(n);var i=r[t];return unpromise(o(i),(function(r){return r&&r!==_nil&&n.push(i),e(++t)}))}(0)}),"(filter fn list)\n            (filter regex list)\n\n            Higher order function that call `fn` for each element of the list\n            and return list for only those elements for which funtion return\n            true value. If called with regex it will create matcher function."),compose:doc(compose,"(compose . fns)\n\n             Higher order function and create new function that apply all functions\n             From right to left and return it's value. Reverse of compose.\n             e.g.:\n             ((compose (curry + 2) (curry * 3)) 3)\n             11\n            "),pipe:doc(pipe,"(pipe . fns)\n\n             Higher order function and create new function that apply all functions\n             From left to right and return it's value. Reverse of compose.\n             e.g.:\n             ((pipe (curry + 2) (curry * 3)) 3)\n             15"),curry:doc(curry,"(curry fn . args)\n\n             Higher order function that create curried version of the function.\n             The result function will have parially applied arguments and it\n             will keep returning functions until all arguments are added\n\n             e.g.:\n             (define (add a b c d) (+ a b c d))\n             (define add1 (curry add 1))\n             (define add12 (add 2))\n             (display (add12 3 4))"),gcd:doc("gcd",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return typecheck_args("lcm",t,"number"),t.reduce((function(e,t){return e.gcd(t)}))}),"(gcd n1 n2 ...)\n\n            Function return the greatest common divisor of their arguments."),lcm:doc("lcm",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];typecheck_args("lcm",t,"number");for(var n=t.length,o=abs(t[0]),i=1;i<n;i++){for(var a=abs(t[i]),u=o;o&&a;)o>a?o%=a:a%=o;o=abs(u*t[i])/(o+a)}return LNumber(o)}),"(lcm n1 n2 ...)\n\n            Function return the least common multiple of their arguments."),"odd?":doc("odd?",single_math_op((function(e){return LNumber(e).isOdd()})),"(odd? number)\n\n             Function check if number os odd."),"even?":doc("even?",single_math_op((function(e){return LNumber(e).isEven()})),"(even? number)\n\n             Function check if number is even."),"*":doc("*",reduce_math_op((function(e,t){return LNumber(e).mul(t)}),LNumber(1)),"(* . numbers)\n\n        Multiplicate all numbers passed as arguments. If single value is passed\n        it will return that value."),"+":doc("+",reduce_math_op((function(e,t){return LNumber(e).add(t)}),LNumber(0)),"(+ . numbers)\n\n        Sum all numbers passed as arguments. If single value is passed it will\n        return that value."),"-":doc("-",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(0===t.length)throw new Error("-: procedure require at least one argument");return typecheck_args("-",t,"number"),1===t.length?LNumber(t[0]).sub():t.length?t.reduce(binary_math_op((function(e,t){return LNumber(e).sub(t)}))):void 0}),"(- n1 n2 ...)\n            (- n)\n\n            Substract number passed as argument. If only one argument is passed\n            it will negate the value."),"/":doc("/",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(0===t.length)throw new Error("/: procedure require at least one argument");return typecheck_args("/",t,"number"),1===t.length?LNumber(1).div(t[0]):t.reduce(binary_math_op((function(e,t){return LNumber(e).div(t)})))}),"(/ n1 n2 ...)\n            (/ n)\n\n            Divide number passed as arguments one by one. If single argument\n            is passed it will calculate (/ 1 n1)."),abs:doc("abs",single_math_op((function(e){return LNumber(e).abs()})),"(abs number)\n\n             Function create absolute value from number."),truncate:doc("truncate",(function(e){return typecheck("truncate",e,"number"),LNumber.isFloat(e)?(e instanceof LNumber&&(e=e.valueOf()),LFloat(truncate(e))):e}),"(truncate n)\n\n            Function return integer value from real number."),sqrt:doc("sqrt",single_math_op((function(e){return LNumber(e).sqrt()})),"(sqrt number)\n\n             Function return square root of the number."),"**":doc("**",binary_math_op((function(e,t){return e=LNumber(e),-1===(t=LNumber(t)).cmp(0)?LFloat(1).div(e).pow(t.sub()):e.pow(t)})),"(** a b)\n\n            Function calculate number a to to the power of b."),"1+":doc("1+",single_math_op((function(e){return LNumber(e).add(1)})),"(1+ number)\n\n             Function add 1 to the number and return result."),"1-":doc(single_math_op((function(e){return LNumber(e).sub(1)})),"(1- number)\n\n             Function substract 1 from the number and return result."),"%":doc("%",(function(e,t){return typecheck_args("%",[e,t],"number"),LNumber(e).rem(t)}),"(% n1 n2)\n\n             Function get reminder of it's arguments."),"==":doc("==",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return typecheck_args("==",t,"number"),seq_compare((function(e,t){return 0===LNumber(e).cmp(t)}),t)}),"(== x1 x2 ...)\n\n            Function compare its numerical arguments and check if they are equal"),">":doc(">",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return typecheck_args(">",t,"number"),seq_compare((function(e,t){return 1===LNumber(e).cmp(t)}),t)}),"(> x1 x2 ...)\n\n            Function compare its numerical arguments and check if they are\n            monotonically increasing"),"<":doc("<",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return typecheck_args("<",t,"number"),seq_compare((function(e,t){return-1===LNumber(e).cmp(t)}),t)}),"(< x1 x2 ...)\n\n            Function compare its numerical arguments and check if they are\n            monotonically decreasing"),"<=":doc("<=",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return typecheck_args("<=",t,"number"),seq_compare((function(e,t){return[0,-1].includes(LNumber(e).cmp(t))}),t)}),"(<= x1 x2 ...)\n\n            Function compare its numerical arguments and check if they are\n            monotonically nonincreasing"),">=":doc(">=",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return typecheck_args(">=",t,"number"),seq_compare((function(e,t){return[0,1].includes(LNumber(e).cmp(t))}),t)}),"(>= x1 x2 ...)\n\n            Function compare its numerical arguments and check if they are\n            monotonically nondecreasing"),"eq?":doc("eq?",equal,"(eq? a b)\n\n             Function compare two values if they are identical."),or:doc(new Macro("or",(function(e,t){var r,n=t.dynamic_scope,o=t.error,i=global_env.get("list->array")(e),a=this;return n&&(n=a),!!i.length&&function e(){return i.length?unpromise(_evaluate(i.shift(),{env:a,dynamic_scope:n,error:o}),(function(t){return!1!==(r=t)?r:e()})):!1!==r&&r}()})),"(or . expressions)\n\n             Macro execute the values one by one and return the one that is truthy value.\n             If there are no expression that evaluate to true it return false."),and:doc(new Macro("and",(function(e){var t,r=arguments.length>1&&arguments[1]!==undefined$1?arguments[1]:{},n=r.dynamic_scope,o=r.error,i=global_env.get("list->array")(e),a=this;return n&&(n=a),!i.length||function e(){var r=i.shift();return"undefined"===typeof r?!1!==t&&t:unpromise(_evaluate(r,{env:a,dynamic_scope:n,error:o}),(function(r){return!1!==(t=r)&&e()}))}()})),"(and . expressions)\n\n             Macro evalute each expression in sequence if any value return false it will\n             return false. If each value return true it will return the last value.\n             If it's called without arguments it will return true."),"|":doc("|",(function(e,t){return LNumber(e).or(t)}),"(& a b)\n\n            Function calculate or bit operation."),"&":doc("&",(function(e,t){return LNumber(e).and(t)}),"(& a b)\n\n            Function calculate and bit operation."),"~":doc("~",(function(e){return LNumber(e).neg()}),"(~ number)\n\n            Function negate the value."),">>":doc(">>",(function(e,t){return LNumber(e).shr(t)}),"(>> a b)\n\n            Function right shit the value a by value b."),"<<":doc("<<",(function(e,t){return LNumber(e).shl(t)}),"(<< a b)\n\n            Function left shit the value a by value b."),not:doc("not",(function(e){return!!is_null(e)||!e}),"(not object)\n\n            Function return negation of the argument.")},undefined$1,"global"),user_env=global_env.inherit("user-env");function set_interaction_env(e,t){e.constant("**internal-env**",t),e.doc("**internal-env**","**internal-env**\n\n            Constant used to hide stdin, stdout and stderr so they don't interfere\n            with variables with the same name. Constants are internal type\n            of variables that can't be redefined, defining variable with same name\n            will throw an error."),global_env.set("**interaction-environment**",e)}function allPossibleCases(e){if(1===e.length)return e[0];for(var t=[],r=allPossibleCases(e.slice(1)),n=0;n<r.length;n++)for(var o=0;o<e[0].length;o++)t.push(e[0][o]+r[n]);return t}function combinations(e,t,r){for(var n=[],o=t;o<=r;++o){for(var i=[],a=0;a<o;++a)i.push(e);n=n.concat(allPossibleCases(i))}return n}function reversseFind(e,t){for(var r=e.split(path.sep).filter(Boolean),n=r.length;n--;){var o=path.join.apply(path,["/"].concat(_toConsumableArray(r.slice(0,n+1))));if(t(o))return o}}function nodeModuleFind(e){return reversseFind(e,(function(e){return fs.existsSync(path.join(e,"node_modules"))}))}function is_node(){return"undefined"!==typeof __webpack_require__.g&&__webpack_require__.g.global===__webpack_require__.g}if(set_interaction_env(user_env,internal_env),global_env.doc("**interaction-environment**","**interaction-environment**\n\n        Internal dynamic, global variable used to find interpreter environment.\n        It's used so the read and write functions can locate **internal-env**\n        that contain references to stdin, stdout and stderr."),function(){var e={ceil:"ceiling"};["floor","round","ceil"].forEach((function(t){var r=e[t]?e[t]:t;global_env.set(r,doc(r,(function(e){if(typecheck(r,e,"number"),e instanceof LNumber)return e[t]()}),"(".concat(r," number)\n\n                Function calculate ").concat(r," of a number.")))}))}(),combinations(["d","a"],2,5).forEach((function(e){var t=e.split(""),r=t.slice().reverse(),n=t.map((function(e){return"(c".concat(e,"r")})).join(" ")+" arg"+")".repeat(t.length),o="c"+e+"r";global_env.set(o,doc(o,(function(e){return r.reduce((function(e,t){return typecheck(o,e,"pair"),"a"===t?e.car:e.cdr}),e)}),"(".concat(o," arg)\n\n            Function calculate ").concat(n)))})),is_node()){var nodeRequire=eval("require"),fs=nodeRequire("fs"),path=nodeRequire("path");global_env.set("global",__webpack_require__.g),global_env.set("self",__webpack_require__.g),global_env.set("window",undefined$1),global_env.set("__dirname",__dirname),global_env.set("__filename",__filename),global_env.set("require.resolve",doc("require.resolve",(function(e){typecheck("require.resolve",e,"string");var t=e.valueOf();return nodeRequire.resolve(t)}),"(require.resolve path)\n\n           Return path relative the current module.")),global_env.set("require",doc("require",(function(e){typecheck("require",e,"string"),e=e.valueOf();var t,r=process.cwd();try{if(e.match(/^\s*\./))t=nodeRequire(path.join(r,e));else{var n=nodeModuleFind(r);t=nodeRequire(n?path.join(n,"node_modules",e):e)}}catch(o){t=nodeRequire(e)}return patch_value(t,__webpack_require__.g)}),"(require module)\n\n            Function to be used inside Node.js to import the module."))}else window===root?(global_env.set("window",window),global_env.set("global",undefined$1),global_env.set("self",window)):"undefined"!==typeof self&&"undefined"!==typeof WorkerGlobalScope&&(global_env.set("self",self),global_env.set("window",undefined$1),global_env.set("global",undefined$1));function typeErrorMessage(e,t,r){var n=arguments.length>3&&arguments[3]!==undefined$1?arguments[3]:null,o=e?" in expression `".concat(e,"`"):"";if(null!==n&&(o+=" (argument ".concat(n,")")),r instanceof Array)if(1===r.length)r=r[0];else{var i=r[r.length-1];r=r.slice(0,-1).join(", ")+" or "+i}return"Expecting ".concat(r,", got ").concat(t).concat(o)}function typecheck_args(e,t,r){t.forEach((function(t,n){typecheck(e,t,r,n+1)}))}function typecheck_text_port(e,t,r){if(typecheck(e,t,r),t.__type__===binary_port)throw new Error(typeErrorMessage(e,"binary-port","textual-port"))}function typecheck(e,t,r){var n=arguments.length>3&&arguments[3]!==undefined$1?arguments[3]:null;e=e.valueOf();var o=type(t).toLowerCase(),i=!1;if(r instanceof Pair&&(r=r.to_array()),r instanceof Array&&(r=r.map((function(e){return e.valueOf()}))),r instanceof Array?(r=r.map((function(e){return e.valueOf().toLowerCase()}))).includes(o)&&(i=!0):r=r.valueOf().toLowerCase(),!i&&o!==r)throw new Error(typeErrorMessage(e,o,r,n))}function self_evaluated(e){var t=_typeof(e);return["string","function"].includes(t)||"symbol"===_typeof(e)||e instanceof QuotedPromise||e instanceof LSymbol||e instanceof LNumber||e instanceof LString||e instanceof RegExp}function is_native(e){return e instanceof LNumber||e instanceof LString||e instanceof LCharacter}function has_own_symbol(e,t){return null!==e&&"object"===_typeof(e)&&t in Object.getOwnPropertySymbols(e)}function is_iterator(e,t){if(has_own_symbol(e,t)||has_own_symbol(e.__proto__,t))return is_function(e[t])}function type(e){var t={pair:Pair,symbol:LSymbol,character:LCharacter,values:Values,"input-port":InputPort,"output-port":OutputPort,number:LNumber,regex:RegExp,syntax:Syntax,macro:Macro,string:LString,array:Array,"native-symbol":Symbol};if(Number.isNaN(e))return"NaN";if(e===_nil)return"nil";if(null===e)return"null";for(var r=0,n=Object.entries(t);r<n.length;r++){var o=_slicedToArray(n[r],2),i=o[0];if(e instanceof o[1])return i}if("object"===_typeof(e)){if(e.__instance__&&(e.__instance__=!1,e.__instance__))return is_function(e.toType)?e.toType():"instance";if(e.constructor){if(e.constructor.__class__)return e.constructor.__class__;if(e.constructor===Object){if(is_iterator(e,Symbol.iterator))return"iterator";if(is_iterator(e,Symbol.asyncIterator))return"async-iterator"}return e.constructor.name.toLowerCase()}}return _typeof(e)}function resolve_promises(e){var t=[];return function e(r){is_promise(r)?t.push(r):r instanceof Pair?(r.haveCycles("car")||e(r.car),r.haveCycles("cdr")||e(r.cdr)):r instanceof Array&&r.forEach(e)}(e),t.length?n(e):e;function r(){return(r=_asyncToGenerator(regenerator.mark((function e(t){var r;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=Pair,!t.haveCycles("car")){e.next=5;break}e.t1=t.car,e.next=8;break;case 5:return e.next=7,n(t.car);case 7:e.t1=e.sent;case 8:if(e.t2=e.t1,!t.haveCycles("cdr")){e.next=13;break}e.t3=t.cdr,e.next=16;break;case 13:return e.next=15,n(t.cdr);case 15:e.t3=e.sent;case 16:return e.t4=e.t3,r=new e.t0(e.t2,e.t4),t[__data__]&&(r[__data__]=!0),e.abrupt("return",r);case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function n(e){return e instanceof Array?promise_all(e.map(n)):e instanceof Pair&&t.length?function(e){return r.apply(this,arguments)}(e):e}}function evaluate_args(e,t){var r=t.env,n=t.dynamic_scope,o=t.error,i=[],a=e;function u(){return i}return markCycles(a),function e(){if(a instanceof Pair){var t=_evaluate(a.car,{env:r,dynamic_scope:n,error:o});return n&&(t=unpromise(t,(function(e){return is_native_function(e)?e.bind(n):e}))),unpromise(resolve_promises(t),(function(t){return i.push(t),a.haveCycles("cdr")?u():(a=a.cdr,e())}))}if(a===_nil)return u();throw new Error("Syntax Error: improper list found in apply")}()}function evaluate_syntax(e,t,r){return unpromise(resolve_promises(e.invoke(t,r)),(function(e){return e instanceof Pair&&e.markCycles(),quote(e)}))}function evaluate_macro(e,t,r){function n(e){return e instanceof Pair?(e.markCycles(),e):quote(e)}return unpromise(resolve_promises(e.invoke(t,r)),(function(e){return!e||e&&e[__data__]||self_evaluated(e)?e:unpromise(_evaluate(e,r),n)}))}function prepare_fn_args(e,t){if(!is_bound(e)||is_object_bound(e)||lips_context(e)&&!is_port_method(e)||(t=t.map(unbox)),!is_raw_lambda(e)&&t.some(is_lips_function)&&!is_lips_function(e)&&!is_array_method(e)){for(var r=[],n=t.length,o=function(){var e=t[n];is_lips_function(e)?(hidden_prop(i=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return unpromise(e.apply(this,r),unbox)},"__bound__",!0),hidden_prop(i,"__fn__",e),i.prototype=e.prototype,r[n]=i):r[n]=e};n--;){var i;o()}t=r}return t}function apply(e,t){var r=arguments.length>2&&arguments[2]!==undefined$1?arguments[2]:{},n=r.env,o=r.dynamic_scope,i=r.error,a=void 0===i?function(){}:i;return unpromise(t=evaluate_args(t,{env:n,dynamic_scope:o,error:a}),(function(t){is_raw_lambda(e)&&(e=unbind(e));var r=(t=prepare_fn_args(e,t)).slice(),i=(o||n).newFrame(e,r);return unpromise(resolve_promises(e.apply(i,t)),(function(e){return e instanceof Pair?(e.markCycles(),quote(e)):Number.isNaN(e)?e:"number"===typeof e?LNumber(e):"string"===typeof e?LString(e):e}),a)}))}function _evaluate(e){var t=arguments.length>1&&arguments[1]!==undefined$1?arguments[1]:{},r=t.env,n=t.dynamic_scope,o=t.error,i=void 0===o?function(){}:o;try{var a,u={env:r=!0===n?n=r||global_env:!0===r?n=global_env:r||global_env,dynamic_scope:n,error:i};if(is_null(e))return e;if(e instanceof LSymbol)return r.get(e);if(!(e instanceof Pair))return e;var c,s=e.car,l=e.cdr;if(s instanceof Pair){if(is_promise(a=resolve_promises(_evaluate(s,u))))return a.then((function(t){return _evaluate(new Pair(t,e.cdr),u)}));if(!is_function(a))throw new Error(type(a)+" "+r.get("repr")(a)+" is not a function while evaluating "+e.toString())}if(s instanceof LSymbol?a=r.get(s):is_function(s)&&(a=s),a instanceof Syntax)c=evaluate_syntax(a,e,u);else if(a instanceof Macro)c=evaluate_macro(a,l,u);else{if(!is_function(a)){if(e instanceof Pair)throw a=s&&s.toString(),new Error("".concat(type(s)," ").concat(a," is not a function"));if(is_function(a))return e;if(a){var f="".concat(type(a)," `").concat(a,"' is not a function");throw new Error(f)}throw new Error("Unknown function `".concat(s.toString(),"'"))}c=apply(a,l,u)}var _=r.get(Symbol.for("__promise__"),{throwError:!1});return!0===_&&is_promise(c)?new QuotedPromise(c=c.then((function(e){return e instanceof Pair&&!a[__data__]?_evaluate(e,u):e}))):c}catch(p){i&&i.call(r,p,e)}}function exec(e,t,r){return _exec.apply(this,arguments)}function _exec(){return(_exec=_asyncToGenerator(regenerator.mark((function e(t,r,n){var o,i,a,u,c,s,l,f,_;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=!0===n?n=r||user_env:!0===r?n=user_env:r||user_env,o=[],i=Array.isArray(t)?t:parse(t),a=!0,u=!1,e.prev=5,s=_asyncIterator(i);case 7:return e.next=9,s.next();case 9:return l=e.sent,a=l.done,e.next=13,l.value;case 13:if(f=e.sent,a){e.next=29;break}if(is_promise(_=_evaluate(f,{env:r,dynamic_scope:n,error:function(e,t){throw e&&e.message&&(e.message.match(/^Error:/)&&(e.message=e.message.replace(/^(Error:)\s*([^:]+:\s*)/,"$1 $2")),t&&(e.__code__ instanceof Array||(e.__code__=[]),e.__code__.push(t.toString(!0)))),e}}))){e.next=21;break}o.push(_),e.next=26;break;case 21:return e.t0=o,e.next=24,_;case 24:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 26:a=!0,e.next=7;break;case 29:e.next=35;break;case 31:e.prev=31,e.t2=e.catch(5),u=!0,c=e.t2;case 35:if(e.prev=35,e.prev=36,a||null==s.return){e.next=40;break}return e.next=40,s.return();case 40:if(e.prev=40,!u){e.next=43;break}throw c;case 43:return e.finish(40);case 44:return e.finish(35);case 45:return e.abrupt("return",o);case 46:case"end":return e.stop()}}),e,null,[[5,31,35,45],[36,,40,44]])})))).apply(this,arguments)}function balanced(e){var t,r={"[":"]","(":")"};t="string"===typeof e?tokenize(e):e.map((function(e){return e&&e.token?e.token:e}));var n=Object.keys(r),o=Object.values(r).concat(n);t=t.filter((function(e){return o.includes(e)}));var i,a=new Stack,u=_createForOfIteratorHelper(t);try{for(u.s();!(i=u.n()).done;){var c=i.value;if(n.includes(c))a.push(c);else{if(a.is_empty())throw new Error("Syntax error: not matched closing ".concat(c));var s=r[a.top()];if(c!==s)throw new Error("Syntax error: missing closing ".concat(s));a.pop()}}}catch(err){u.e(err)}finally{u.f()}return a.is_empty()}function fworker(e){var t,r="("+e.toString()+")()",n=window.URL||window.webkitURL;try{t=new Blob([r],{type:"application/javascript"})}catch(o){(t=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder)).append(r),t=t.getBlob()}return new root.Worker(n.createObjectURL(t))}function is_dev(){return lips.version.match(/^(\{\{VER\}\}|DEV)$/)}function bootstrap(){var e=arguments.length>0&&arguments[0]!==undefined$1?arguments[0]:"";""===e?e=is_dev()?"https://cdn.jsdelivr.net/gh/jcubic/lips@devel/":"https://cdn.jsdelivr.net/npm/@jcubic/lips@".concat(lips.version,"/"):e.match(/\/$/)||(e+="/");var t=global_env.get("load");return t.call(lips.env,"".concat(e,"dist/std.min.scm"),global_env)}function Worker(e){this.url=e;var t=this.worker=fworker((function(){var e,t;self.addEventListener("message",(function(r){var n=r.data,o=n.id;if("RPC"===n.type&&null!==o)if("eval"===n.method){if(!t)return void u("Worker RPC: LIPS not initilized, call init first");t.then((function(){var t=n.params[0],r=n.params[1];e.exec(t,r).then((function(e){a(e=e.map((function(e){return e&&e.valueOf()})))})).catch((function(e){u(e)}))}))}else if("init"===n.method){var i=n.params[0];"string"!==typeof i?u("Worker RPC: url is not a string"):(importScripts("".concat(i,"/dist/lips.min.js")),e=new lips.Interpreter("worker"),(t=bootstrap(i)).then((function(){a(!0)})))}function a(e){self.postMessage({id:o,type:"RPC",result:e})}function u(e){self.postMessage({id:o,type:"RPC",error:e})}}))}));this.rpc=function(){var e=0;return function(r,n){var o=++e;return new Promise((function(e,i){t.addEventListener("message",(function r(n){var a=n.data;a&&"RPC"===a.type&&a.id===o&&(a.error?i(a.error):e(a.result),t.removeEventListener("message",r))})),t.postMessage({type:"RPC",method:r,id:o,params:n})}))}}(),this.rpc("init",[e]).catch((function(e){console.error(e)})),this.exec=function(e){var t=arguments.length>1&&arguments[1]!==undefined$1&&arguments[1];return this.rpc("eval",[e,t])}}for(var serialization_map={pair:function(e){var t=_slicedToArray(e,2);return Pair(t[0],t[1])},number:function(e){return LString.isString(e)?LNumber([e,10]):LNumber(e)},regex:function(e){var t=_slicedToArray(e,2),r=t[0],n=t[1];return new RegExp(r,n)},nil:function(){return _nil},symbol:function(e){return LString.isString(e)?LSymbol(e):Array.isArray(e)?LSymbol(Symbol.for(e[0])):void 0},string:LString,character:LCharacter},available_class=Object.keys(serialization_map),class_map={},_i5=0,_Object$entries3=Object.entries(available_class);_i5<_Object$entries3.length;_i5++){var _Object$entries3$_i=_slicedToArray(_Object$entries3[_i5],2),i=_Object$entries3$_i[0],cls=_Object$entries3$_i[1];class_map[cls]=+i}function mangle_name(e){return class_map[e]}function resolve_name(e){return available_class[e]}function serialize(e){return JSON.stringify(e,(function(e,t){var r=this[e];if(r){if(r instanceof RegExp)return{"@":mangle_name("regex"),"#":[r.source,r.flags]};var n=mangle_name(r.constructor.__class__);if(!is_undef(n))return{"@":n,"#":r.serialize()}}return t}))}function unserialize(e){return JSON.parse(e,(function(e,t){if(t&&"object"===_typeof(t)&&!is_undef(t["@"])){var r=resolve_name(t["@"]);if(serialization_map[r])return serialization_map[r](t["#"])}return t}))}function execError(e){console.error(e.message||e),e.code&&console.error(e.code.map((function(e,t){return"[".concat(t+1,"]: ").concat(e)})))}function init(){var e,t=["text/x-lips","text/x-scheme"];function r(e){return new Promise((function(t){var r=e.getAttribute("src");return r?fetch(r).then((function(e){return e.text()})).then(exec).then(t).catch((function(e){execError(e),t()})):exec(e.innerHTML).then(t).catch((function(e){execError(e),t()}))}))}function n(){return new Promise((function(n){var o=Array.from(document.querySelectorAll("script"));return function i(){var a=o.shift();if(a){var u=a.getAttribute("type");if(t.includes(u)){var c=a.getAttribute("bootstrap");e||"string"!==typeof c?r(a).then(i):bootstrap(c).then((function(){return r(a)})).then(i)}else u&&u.match(/lips|lisp/)&&console.warn("Expecting "+t.join(" or ")+" found "+u);return i()}n()}()}))}if(!window.document)return Promise.resolve();if(currentScript){var o=currentScript.getAttribute("bootstrap");if("string"===typeof o)return bootstrap(o).then((function(){return e=!0,n()}))}return n()}var currentScript=window.document&&document.currentScript;contentLoaded(window,init);var banner=function(){var e=LString("{{DATE}}").valueOf(),t="{{DATE}}"===e?new Date:new Date(e),r=function(e){return e.toString().padStart(2,"0")},n=t.getFullYear(),o=[n,r(t.getMonth()+1),r(t.getDate())].join("-");return"\n  __ __                          __\n / / \\ \\       _    _  ___  ___  \\ \\\n| |   \\ \\     | |  | || . \\/ __>  | |\n| |    > \\    | |_ | ||  _/\\__ \\  | |\n| |   / ^ \\   |___||_||_|  <___/  | |\n \\_\\ /_/ \\_\\                     /_/\n\nLIPS Interpreter {{VER}} (".concat(o,") <https://lips.js.org>\nCopyright (c) 2018-").concat(n," Jakub T. Jankiewicz\n\nType (env) to see environment with functions macros and variables. You can also\nuse (help name) to display help for specic function or macro, (apropos name)\nto display list of matched names in environment and (dir object) to list\nproperties of an object.\n").replace(/^.*\n/,"")}();Ahead.__class__="ahead",Pair.__class__="pair",Nil.__class__="nil",Pattern.__class__="pattern",Formatter.__class__="formatter",Macro.__class__="macro",Syntax.__class__="syntax",Environment.__class__="environment",InputPort.__class__="input-port",OutputPort.__class__="output-port",OutputStringPort.__class__="output-string-port",InputStringPort.__class__="input-string-port",InputFilePort.__class__="input-file-port",OutputFilePort.__class__="output-file-port",LipsError.__class__="lips-error",[LNumber,LComplex,LRational,LFloat,LBigInteger].forEach((function(e){e.__class__="number"})),LCharacter.__class__="character",LSymbol.__class__="symbol",LString.__class__="string",QuotedPromise.__class__="promise";var lips={version:"{{VER}}",banner:banner,date:"{{DATE}}",exec:exec,parse:compose(uniterate_async,parse),tokenize:tokenize,evaluate:_evaluate,serialize:serialize,unserialize:unserialize,bootstrap:bootstrap,Environment:Environment,env:user_env,Worker:Worker,Interpreter:Interpreter,balanced_parenthesis:balanced,balancedParenthesis:balanced,balanced:balanced,Macro:Macro,Syntax:Syntax,Pair:Pair,Values:Values,QuotedPromise:QuotedPromise,Error:LipsError,quote:quote,InputPort:InputPort,OutputPort:OutputPort,InputFilePort:InputFilePort,OutputFilePort:OutputFilePort,InputStringPort:InputStringPort,OutputStringPort:OutputStringPort,InputByteVectorPort:InputByteVectorPort,OutputByteVectorPort:OutputByteVectorPort,InputBinaryFilePort:InputBinaryFilePort,OutputBinaryFilePort:OutputBinaryFilePort,Formatter:Formatter,Parser:Parser,Lexer:Lexer,specials:specials,repr:repr,nil:_nil,eof:eof,LSymbol:LSymbol,LNumber:LNumber,LFloat:LFloat,LComplex:LComplex,LRational:LRational,LBigInteger:LBigInteger,LCharacter:LCharacter,LString:LString,rationalize:rationalize};return global_env.set("lips",lips),lips},__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(13550)],void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(e){return root.lips=factory(root,e)}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)})()},30220:function(e,t,r){"use strict";r.r(t),r.d(t,{__N_SSG:function(){return _},default:function(){return p}});var n=r(4942);r(47351),r(26470),r(13099),r(34155);function o(e){return r(97514)("./".concat(e)).default}var i=r(93433),a=r(67294),u=(r(15303),r(85893));function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var l=function(e){var t=e.params,r=e.result.type,n=e.run,o=e.example,c=void 0===o?{}:o,l=(0,a.useState)(),f=l[0],_=l[1],p=(0,a.useState)(Object.keys(t).map((function(e){return c[e]}))),d=p[0],m=p[1];(0,a.useEffect)((function(){var e=d.map((function(e,r){return s(s({},t[r]),{},{value:e})}));n.apply(void 0,(0,i.Z)(e)).then(_)}),[d.join("")]);var h="w-full py-2 px-3 border border-gray-400 rounded-md text-xs bg-white font-mono";return(0,u.jsxs)("div",{className:"p-5",children:[(0,u.jsx)("div",{className:"space-y-6",children:Object.values(t).map((function(e,t){return(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{className:"mb-1 text-sm font-semibold opacity-70",children:e.displayName}),(0,u.jsx)("input",{className:h,defaultValue:d[t],onChange:function(r){var n=r.target.value;"number"!==e.type&&"primitive"!==e.type||NaN!==Number(n)&&(n=Number(n)),m([].concat((0,i.Z)(d.slice(0,t)),[n],(0,i.Z)(d.slice(t+1,d.length-t))))}})]})}))}),(0,u.jsx)("hr",{className:"my-8"}),(0,u.jsxs)("div",{className:"",children:[(0,u.jsx)("div",{className:"mb-1 text-xs font-semibold opacity-70",children:"Result"}),"image-uri"===r?(0,u.jsx)("img",{className:"object-contain max-w-lg mx-auto",src:f}):(0,u.jsx)("input",{disabled:!0,className:h,value:null!==f&&void 0!==f?f:""})]})]})};function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var _=!0,p=function(e){var t=e.slug,r=o(t);return(0,u.jsx)(l,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},r),t)}},20509:function(e,t,r){"use strict";r.d(t,{H:function(){return o}});var n=r(29439);function o(e,t){return e+("?"+Object.entries(t).map((function(e){var t=(0,n.Z)(e,2),r=t[0],o=t[1];return"".concat(encodeURIComponent(r),"=").concat(encodeURIComponent(o))})).join("&"))}},97514:function(e,t,r){var n={"./app-icon":81923,"./app-icon.ts":81923,"./barcode":72261,"./barcode.ts":72261,"./doodle":56727,"./doodle.ts":56727,"./fetch":63258,"./fetch.ts":63258,"./glide-brand-image":61747,"./glide-brand-image.ts":61747,"./hell-yes-code":52405,"./hell-yes-code.ts":52405,"./hyperformula":54506,"./hyperformula.ts":54506,"./jq":46471,"./jq.ts":46471,"./lisp":71543,"./lisp.ts":71543,"./qrcode":97977,"./qrcode.ts":97977,"./translate":23269,"./translate.ts":23269,"./youtube-thumbnail":709,"./youtube-thumbnail.ts":709};function o(e){var t=i(e);return r(t)}function i(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}o.keys=function(){return Object.keys(n)},o.resolve=i,e.exports=o,o.id=97514},80950:function(){},46601:function(){},89214:function(){},8623:function(){},7748:function(){},85568:function(){},18908:function(){},56619:function(){},77108:function(){},52361:function(){},94616:function(){},47351:function(){}}]);